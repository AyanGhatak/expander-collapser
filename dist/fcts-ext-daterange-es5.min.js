!function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1);!function(t){t(FusionCharts)}(function(t){FusionCharts.register("extension",["date-range-chooser",function(t){var e=this,n=e.extAPI;window.dr=new r,n(window.dr)}])})},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(2),o=n(4),s=n(5),u=function(){function t(){r(this,t),this.dateRange={startDate:0,endDate:0},this.startText={attr:function(){}},this.endText={attr:function(){}}}return a(t,[{key:"init",value:function(t){var e=this;"function"==typeof t?t("X-Axis","Y-Axis","graphics","chart",function(t,n,r,a){e.x=t,e.y=n,e.paper=r,e.chart=a}):e.chart=new s}},{key:"placeInCanvas",value:function(){this.range={startDate:12,endDate:23}}},{key:"draw",value:function(){var t=this.paper,e=this.range,n=t.text(20,22,"From: ");n.attr("font-family","sans-serif"),n.attr("fill","#000");var r=t.rect(50,10,90,25);r.attr("stroke","#000"),this.startText=t.text(95,22,this.getFormattedDate(e.startDate)),this.startText.attr("font-family","sans-serif"),this.startText.attr("fill","#000");var a=t.text(170,22,"To: ");a.attr("font-family","sans-serif"),a.attr("fill","#000");var i=t.rect(190,10,90,25);i.attr("stroke","#000"),this.endText=t.text(235,22,this.getFormattedDate(e.endDate)),this.endText.attr("font-family","sans-serif"),this.endText.attr("fill","#000")}},{key:"dispose",value:function(){}},{key:"swapDates",value:function(){var t=this.dateRange.startDate;this.dateRange.startDate=this.dateRange.endDate,this.dateRange.endDate=t}},{key:"syncRange",value:function(){}},{key:"getFormattedDate",value:function(t){return this.chart.getFormattedDate(t)}},{key:"getTimestamp",value:function(t){return this.chart.getTimestamp(t)}},{key:"setConfig",value:function(t){}},{key:"getConfig",value:function(){return{calendarVisible:"false"}}},{key:"range",get:function(){return this.dateRange},set:function(t){if(t.startDate<=t.endDate){this.dateRange.startDate=t.startDate;var e=this.getFormattedDate(t.startDate);this.startText.attr("text",e),this.dateRange.endDate=t.endDate;var n=this.getFormattedDate(t.endDate);this.endText.attr("text",n);var r=new i;r.timestamp=this.dateRange.startDate;var a=new o;a.timestamp=this.dateRange.endDate}}}]),t}();t.exports=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(3),u=function(t){function e(){return r(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),o(e,[{key:"validateDate",value:function(t){return!0}}]),e}(s);t.exports=u},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(){n(this,t),this.timestamp=0}return r(t,[{key:"displayDate",value:function(){}},{key:"date",get:function(){return this.timestamp},set:function(t){this.timestamp=t}}]),t}();t.exports=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(3),u=function(t){function e(){return r(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),o(e,[{key:"validateDate",value:function(t){return!0}}]),e}(s);t.exports=u},function(t,e){"use strict";var n=function(){};n.register=function(t,e){var n=e[1];n.bind(this,565)()},n.prototype.getFormattedDate=function(t){return new Date(t).toLocaleDateString()},n.prototype.getTimestamp=function(t){var e=new Date(t);return+new Date(e.toLocaleDateString())},n.getComponent=function(t,e){var n={x:24,y:56,width:100,height:20,index:4};return"api"===t&&"toolbox"===e?n:null},n.extAPI=function(t){t.init(function(){for(var t=[],e=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)if("X-Axis"===arguments[r])t.push(156772);else if("Y-Axis"===arguments[r])t.push(156765);else if("graphics"===arguments[r]){var a=Raphael(10,50,500,500);t.push(a)}else"chart"===arguments[r]&&t.push(new n);e.apply(this,t)}),t.placeInCanvas(),t.draw(),t.dispose()},"undefined"!=typeof t&&"undefined"!=typeof t.exports?t.exports=n:window.FusionCharts=n}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDUyYjNhMDY4ZmJkYjA0MTQ1OTNlIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZmN0cy1leHQtZGF0ZXJhbmdlLmpzIiwid2VicGFjazovLy8uL3NyYy9mY3RzLWV4dC1zdGFydGRhdGVpbnB1dC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZmN0cy1leHQtZGF0ZWlucHV0LmpzIiwid2VicGFjazovLy8uL3NyYy9mY3RzLWV4dC1lbmRkYXRlaW5wdXQuanMiLCJ3ZWJwYWNrOi8vLy4vbGliL2Z1c2lvbmNoYXJ0cy5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJEYXRlUmFuZ2UiLCJmYWN0b3J5IiwiRnVzaW9uQ2hhcnRzIiwiRkMiLCJyZWdpc3RlciIsImdsb2JhbCIsInRoaXMiLCJleHRBUEkiLCJ3aW5kb3ciLCJkciIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiU3RhcnREYXRlSW5wdXQiLCJFbmREYXRlSW5wdXQiLCJkYXRlUmFuZ2UiLCJzdGFydERhdGUiLCJlbmREYXRlIiwic3RhcnRUZXh0IiwiYXR0ciIsImVuZFRleHQiLCJ2YWx1ZSIsInJlcXVpcmUiLCJzZWxmIiwieCIsInkiLCJncmFwaGljcyIsImNoYXJ0IiwicGFwZXIiLCJyYW5nZSIsInN0YXJ0TGFiZWwiLCJ0ZXh0Iiwic3RhcnRSZWN0IiwicmVjdCIsImdldEZvcm1hdHRlZERhdGUiLCJlbmRMYWJlbCIsImVuZFJlY3QiLCJ0ZW1wIiwidGltZXN0YW1wIiwiZGF0ZVN0cmluZyIsImdldFRpbWVzdGFtcCIsImNvbmZpZ09iaiIsImNhbGVuZGFyVmlzaWJsZSIsImdldCIsInNldCIsImZvcm1hdHRlZFN0YXJ0RGF0ZSIsImZvcm1hdHRlZEVuZERhdGUiLCJzZGkiLCJlZGkiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkRhdGVJbnB1dCIsIl9EYXRlSW5wdXQiLCJnZXRQcm90b3R5cGVPZiIsImFwcGx5IiwiYXJndW1lbnRzIiwibXMiLCJleHQiLCJhcnIiLCJmbiIsImJpbmQiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiZGF0ZSIsImR0IiwiZ2V0Q29tcG9uZW50IiwiY29tcG9uZW50VHlwZSIsImNvbXBvbmVudE5hbWUiLCJ0b29sQm94Iiwid2lkdGgiLCJoZWlnaHQiLCJpbmRleCIsIm9iaiIsImluaXQiLCJhcmdzVG9BcHBseSIsImNiIiwicHVzaCIsIlJhcGhhZWwiLCJwbGFjZUluQ2FudmFzIiwiZHJhdyIsImRpc3Bvc2UiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJ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LEtBR2pCRixFQUFJTSxnQkFFSk4sRUFBSU8sT0FFSlAsRUFBSVEsV0FHZ0IsbUJBQVgvRyxJQUFvRCxtQkFBbkJBLEdBQU9ELFFBQ2pEQyxFQUFPRCxRQUFVVSxFQUVqQk0sT0FBT04sYUFBZUEiLCJmaWxlIjoiZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBEYXRlUmFuZ2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0OyhmdW5jdGlvbiAoZmFjdG9yeSkge1xuXHQgIGZhY3RvcnkoRnVzaW9uQ2hhcnRzKTtcblx0fSkoZnVuY3Rpb24gKEZDKSB7XG5cdCAgRnVzaW9uQ2hhcnRzLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ2RhdGUtcmFuZ2UtY2hvb3NlcicsIGZ1bmN0aW9uIChpZCkge1xuXHQgICAgdmFyIGdsb2JhbCA9IHRoaXM7XG5cdCAgICB2YXIgZXh0QVBJID0gZ2xvYmFsLmV4dEFQSTtcblx0XG5cdCAgICAvLyB2YXIgb3RoZXJBUEkgPSBGdXNpb25DaGFydHMuZ2V0RXh0Q29tcG9uZW50KGlkLCAnYXBpJywgJ2xlZ2FjeWV4dGFwaScpO1xuXHQgICAgLy8gdmFyIHRvb2xCb3hBcGkgPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuXHRcblx0ICAgIHdpbmRvdy5kciA9IG5ldyBEYXRlUmFuZ2UoKTtcblx0ICAgIGV4dEFQSSh3aW5kb3cuZHIpO1xuXHQgIH1dKTtcblx0fSk7XG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBTdGFydERhdGVJbnB1dCA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdHZhciBFbmREYXRlSW5wdXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHR2YXIgRnVzaW9uQ2hhcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdC8qKlxuXHQgKiBDbGFzcyByZXByZXNlbnRpbmcgdGhlIERhdGVSYW5nZS5cblx0ICovXG5cdFxuXHR2YXIgRGF0ZVJhbmdlID0gZnVuY3Rpb24gKCkge1xuXHQgIC8qKlxuXHQgICAqIENyZWF0ZSBhIERhdGVSYW5nZS5cblx0ICAgKiBAdHlwZWRlZiAge29iamVjdH0gRGF0ZVJhbmdlLnJhbmdlXG5cdCAgICogQHByb3BlcnR5IHtudW1iZXJ9IHN0YXJ0RGF0ZSAtIFRoZSBzdGFydCBkYXRlIG9mIHRoZSBkYXRlIHJhbmdlLlxuXHQgICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBlbmREYXRlICAgLSBUaGUgZW5kIGRhdGUgb2YgdGhlIGRhdGUgcmFuZ2UuXG5cdCAgICovXG5cdCAgZnVuY3Rpb24gRGF0ZVJhbmdlKCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGVSYW5nZSk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICB0aGlzLmRhdGVSYW5nZSA9IHtcblx0ICAgICAgc3RhcnREYXRlOiAwLFxuXHQgICAgICBlbmREYXRlOiAwXG5cdCAgICB9O1xuXHQgICAgdGhpcy5zdGFydFRleHQgPSB7XG5cdCAgICAgIGF0dHI6IGZ1bmN0aW9uIGF0dHIoKSB7fVxuXHQgICAgfTtcblx0ICAgIHRoaXMuZW5kVGV4dCA9IHtcblx0ICAgICAgYXR0cjogZnVuY3Rpb24gYXR0cigpIHt9XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc3RhcnQgYW5kIGVuZCBkYXRlcy5cblx0ICAgKiBAdHlwZSB7RGF0ZVJhbmdlLnJhbmdlfVxuXHQgICAqL1xuXHRcblx0XG5cdCAgX2NyZWF0ZUNsYXNzKERhdGVSYW5nZSwgW3tcblx0ICAgIGtleTogJ2luaXQnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQocmVxdWlyZSkge1xuXHQgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgIGlmICh0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICAgIHJlcXVpcmUoJ1gtQXhpcycsICdZLUF4aXMnLCAnZ3JhcGhpY3MnLCAnY2hhcnQnLCBmdW5jdGlvbiAoeCwgeSwgZ3JhcGhpY3MsIGNoYXJ0KSB7XG5cdCAgICAgICAgICBzZWxmLnggPSB4O1xuXHQgICAgICAgICAgc2VsZi55ID0geTtcblx0ICAgICAgICAgIHNlbGYucGFwZXIgPSBncmFwaGljcztcblx0ICAgICAgICAgIHNlbGYuY2hhcnQgPSBjaGFydDtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBzZWxmLmNoYXJ0ID0gbmV3IEZ1c2lvbkNoYXJ0cygpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAncGxhY2VJbkNhbnZhcycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcGxhY2VJbkNhbnZhcygpIHtcblx0ICAgICAgdGhpcy5yYW5nZSA9IHtcblx0ICAgICAgICBzdGFydERhdGU6IDEyLFxuXHQgICAgICAgIGVuZERhdGU6IDIzXG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZHJhdycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZHJhdygpIHtcblx0ICAgICAgdmFyIHBhcGVyID0gdGhpcy5wYXBlcjtcblx0ICAgICAgdmFyIHJhbmdlID0gdGhpcy5yYW5nZTtcblx0XG5cdCAgICAgIHZhciBzdGFydExhYmVsID0gcGFwZXIudGV4dCgyMCwgMjIsICdGcm9tOiAnKTtcblx0ICAgICAgc3RhcnRMYWJlbC5hdHRyKCdmb250LWZhbWlseScsICdzYW5zLXNlcmlmJyk7XG5cdCAgICAgIHN0YXJ0TGFiZWwuYXR0cignZmlsbCcsICcjMDAwJyk7XG5cdCAgICAgIHZhciBzdGFydFJlY3QgPSBwYXBlci5yZWN0KDUwLCAxMCwgOTAsIDI1KTtcblx0ICAgICAgc3RhcnRSZWN0LmF0dHIoJ3N0cm9rZScsICcjMDAwJyk7XG5cdCAgICAgIHRoaXMuc3RhcnRUZXh0ID0gcGFwZXIudGV4dCg5NSwgMjIsIHRoaXMuZ2V0Rm9ybWF0dGVkRGF0ZShyYW5nZS5zdGFydERhdGUpKTtcblx0ICAgICAgdGhpcy5zdGFydFRleHQuYXR0cignZm9udC1mYW1pbHknLCAnc2Fucy1zZXJpZicpO1xuXHQgICAgICB0aGlzLnN0YXJ0VGV4dC5hdHRyKCdmaWxsJywgJyMwMDAnKTtcblx0XG5cdCAgICAgIHZhciBlbmRMYWJlbCA9IHBhcGVyLnRleHQoMTcwLCAyMiwgJ1RvOiAnKTtcblx0ICAgICAgZW5kTGFiZWwuYXR0cignZm9udC1mYW1pbHknLCAnc2Fucy1zZXJpZicpO1xuXHQgICAgICBlbmRMYWJlbC5hdHRyKCdmaWxsJywgJyMwMDAnKTtcblx0ICAgICAgdmFyIGVuZFJlY3QgPSBwYXBlci5yZWN0KDE5MCwgMTAsIDkwLCAyNSk7XG5cdCAgICAgIGVuZFJlY3QuYXR0cignc3Ryb2tlJywgJyMwMDAnKTtcblx0ICAgICAgdGhpcy5lbmRUZXh0ID0gcGFwZXIudGV4dCgyMzUsIDIyLCB0aGlzLmdldEZvcm1hdHRlZERhdGUocmFuZ2UuZW5kRGF0ZSkpO1xuXHQgICAgICB0aGlzLmVuZFRleHQuYXR0cignZm9udC1mYW1pbHknLCAnc2Fucy1zZXJpZicpO1xuXHQgICAgICB0aGlzLmVuZFRleHQuYXR0cignZmlsbCcsICcjMDAwJyk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZGlzcG9zZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHt9XG5cdCAgICAvLyBUT0RPOiBkaXNwb3NlIGV4dGVuc2lvblxuXHRcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFN3YXBzIHRoZSBzdGFydCBkYXRlIGFuZCB0aGUgZW5kIGRhdGUgb2YgdGhlIGRhdGUgcmFuZ2Vcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnc3dhcERhdGVzJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzd2FwRGF0ZXMoKSB7XG5cdCAgICAgIHZhciB0ZW1wID0gdGhpcy5kYXRlUmFuZ2Uuc3RhcnREYXRlO1xuXHQgICAgICB0aGlzLmRhdGVSYW5nZS5zdGFydERhdGUgPSB0aGlzLmRhdGVSYW5nZS5lbmREYXRlO1xuXHQgICAgICB0aGlzLmRhdGVSYW5nZS5lbmREYXRlID0gdGVtcDtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFN5bmNzIHRoZSBkYXRlcmFuZ2Ugc2hvd24gYnkgdGhlIEZ1c2lvbkNoYXJ0cyB0aW1lIHNlcmllcyBjaGFydCBhbmQgdGhlIERhdGUgUmFuZ2UgQ2hvb3NlclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdzeW5jUmFuZ2UnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHN5bmNSYW5nZSgpIHt9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm5zIGEgZm9ybWF0dGVkIGRhdGUgc3RyaW5nIGZyb20gRnVzaW9uQ2hhcnRzIHdoZW4gZ2l2ZW4gYSBVTklYIHRpbWVzdGFtcFxuXHQgICAgICogQHBhcmFtICB7bnVtYmVyfSB0aW1lc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIGNvbnZlcnRlZCB0byBhIGRhdGUgc3RyaW5nXG5cdCAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IC0gQSBkYXRlIHN0cmluZyB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiB0aW1lc3RhbXBcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdnZXRGb3JtYXR0ZWREYXRlJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGb3JtYXR0ZWREYXRlKHRpbWVzdGFtcCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5jaGFydC5nZXRGb3JtYXR0ZWREYXRlKHRpbWVzdGFtcCk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm5zIGEgVU5JWCB0aW1lc3RhbXAgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZ1xuXHQgICAgICogQHBhcmFtICB7c3RyaW5nfSBkYXRlU3RyaW5nIC0gQSBkYXRlIHN0cmluZyB0byBiZSBjb252ZXJ0ZWQgdG8gYSBVTklYIHRpbWVzdGFtcFxuXHQgICAgICogQHJldHVybiB7bnVtYmVyfSBBIFVOSVggdGltZXN0YW1wIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIGRhdGUgc3RyaW5nXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZ2V0VGltZXN0YW1wJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoZGF0ZVN0cmluZykge1xuXHQgICAgICByZXR1cm4gdGhpcy5jaGFydC5nZXRUaW1lc3RhbXAoZGF0ZVN0cmluZyk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXRzIHRoZSBjb25maWd1cmFibGUgb3B0aW9ucyBvZiB0aGUgZXh0ZW5zaW9uIChlLmcuIGNvc21ldGljcylcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3NldENvbmZpZycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q29uZmlnKGNvbmZpZ09iaikge31cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuXHQgICAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2dldENvbmZpZycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29uZmlnKCkge1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGNhbGVuZGFyVmlzaWJsZTogJ2ZhbHNlJ1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3JhbmdlJyxcblx0ICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5kYXRlUmFuZ2U7XG5cdCAgICB9LFxuXHQgICAgc2V0OiBmdW5jdGlvbiBzZXQocmFuZ2UpIHtcblx0ICAgICAgaWYgKHJhbmdlLnN0YXJ0RGF0ZSA8PSByYW5nZS5lbmREYXRlKSB7XG5cdCAgICAgICAgdGhpcy5kYXRlUmFuZ2Uuc3RhcnREYXRlID0gcmFuZ2Uuc3RhcnREYXRlO1xuXHQgICAgICAgIHZhciBmb3JtYXR0ZWRTdGFydERhdGUgPSB0aGlzLmdldEZvcm1hdHRlZERhdGUocmFuZ2Uuc3RhcnREYXRlKTtcblx0ICAgICAgICB0aGlzLnN0YXJ0VGV4dC5hdHRyKCd0ZXh0JywgZm9ybWF0dGVkU3RhcnREYXRlKTtcblx0XG5cdCAgICAgICAgdGhpcy5kYXRlUmFuZ2UuZW5kRGF0ZSA9IHJhbmdlLmVuZERhdGU7XG5cdCAgICAgICAgdmFyIGZvcm1hdHRlZEVuZERhdGUgPSB0aGlzLmdldEZvcm1hdHRlZERhdGUocmFuZ2UuZW5kRGF0ZSk7XG5cdCAgICAgICAgdGhpcy5lbmRUZXh0LmF0dHIoJ3RleHQnLCBmb3JtYXR0ZWRFbmREYXRlKTtcblx0XG5cdCAgICAgICAgdmFyIHNkaSA9IG5ldyBTdGFydERhdGVJbnB1dCgpO1xuXHQgICAgICAgIHNkaS50aW1lc3RhbXAgPSB0aGlzLmRhdGVSYW5nZS5zdGFydERhdGU7XG5cdFxuXHQgICAgICAgIHZhciBlZGkgPSBuZXcgRW5kRGF0ZUlucHV0KCk7XG5cdCAgICAgICAgZWRpLnRpbWVzdGFtcCA9IHRoaXMuZGF0ZVJhbmdlLmVuZERhdGU7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XSk7XG5cdFxuXHQgIHJldHVybiBEYXRlUmFuZ2U7XG5cdH0oKTtcblx0XG5cdG1vZHVsZS5leHBvcnRzID0gRGF0ZVJhbmdlO1xuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIERhdGVJbnB1dCA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdFxuXHQvKipcblx0ICogQSBjb25jcmV0ZSByZXByZXNlbnRhdGlvbiBvZiBEYXRlSW5wdXQgZm9yIHRoZSBzdGFydCBkYXRlLlxuXHQgKiBAZXh0ZW5kcyBEYXRlSW5wdXRcblx0ICogQHByaXZhdGVcblx0ICovXG5cdFxuXHR2YXIgU3RhcnREYXRlSW5wdXQgPSBmdW5jdGlvbiAoX0RhdGVJbnB1dCkge1xuXHQgIF9pbmhlcml0cyhTdGFydERhdGVJbnB1dCwgX0RhdGVJbnB1dCk7XG5cdFxuXHQgIGZ1bmN0aW9uIFN0YXJ0RGF0ZUlucHV0KCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0YXJ0RGF0ZUlucHV0KTtcblx0XG5cdCAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFN0YXJ0RGF0ZUlucHV0Ll9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3RhcnREYXRlSW5wdXQpKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcblx0ICB9XG5cdFxuXHQgIF9jcmVhdGVDbGFzcyhTdGFydERhdGVJbnB1dCwgW3tcblx0ICAgIGtleTogJ3ZhbGlkYXRlRGF0ZScsXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBWYWxpZGF0ZSB0aGUgZ2l2ZW4gdGltZXN0YW1wXG5cdCAgICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSBnaXZlbiB0aW1lc3RhbXAgaXMgdmFsaWQgb3Igbm90XG5cdCAgICAgKi9cblx0ICAgIHZhbHVlOiBmdW5jdGlvbiB2YWxpZGF0ZURhdGUodGltZXN0YW1wKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfVxuXHQgIH1dKTtcblx0XG5cdCAgcmV0dXJuIFN0YXJ0RGF0ZUlucHV0O1xuXHR9KERhdGVJbnB1dCk7XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IFN0YXJ0RGF0ZUlucHV0O1xuXG4vKioqLyB9LFxuLyogMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHQvKipcblx0ICogQ2xhc3MgcmVwcmVzZW50aW5nIGEgYWJzdHJhY3QgRGF0ZUlucHV0LlxuXHQgKiBAYWJzdHJhY3Rcblx0ICogQHByaXZhdGVcblx0ICovXG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBEYXRlSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gRGF0ZUlucHV0KCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGVJbnB1dCk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBEYXRlSW5wdXQuaW5wdXRcblx0ICAgICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB0aW1lc3RhbXAgLSBUaGUgY3VycmVudCB0aW1lIHNob3duIG9uIHRoZSBkYXRlIGlucHV0LlxuXHQgICAgICovXG5cdCAgICAvKipcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIHRoaXMudGltZXN0YW1wID0gMDtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJlcHJlc2VudHMgdGhlIG51bWVyaWMgdmFsdWUgb2YgdGhlIGRhdGVcblx0ICAgKiBAdHlwZSBudW1iZXJcblx0ICAgKi9cblx0XG5cdFxuXHQgIF9jcmVhdGVDbGFzcyhEYXRlSW5wdXQsIFt7XG5cdCAgICBrZXk6ICdkaXNwbGF5RGF0ZScsXG5cdFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRGlzcGxheXMgdGhlIGRhdGUgb24gdGhlIGRhdGUgaW5wdXRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwbGF5RGF0ZSgpIHt9XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZGF0ZScsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wO1xuXHQgICAgfSxcblx0ICAgIHNldDogZnVuY3Rpb24gc2V0KG1zKSB7XG5cdCAgICAgIHRoaXMudGltZXN0YW1wID0gbXM7XG5cdCAgICB9XG5cdCAgfV0pO1xuXHRcblx0ICByZXR1cm4gRGF0ZUlucHV0O1xuXHR9KCk7XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IERhdGVJbnB1dDtcblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBEYXRlSW5wdXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHRcblx0LyoqXG5cdCAqIEEgY29uY3JldGUgcmVwcmVzZW50YXRpb24gb2YgRGF0ZUlucHV0IGZvciB0aGUgZW5kIGRhdGUuXG5cdCAqIEBleHRlbmRzIERhdGVJbnB1dFxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0XG5cdHZhciBFbmREYXRlSW5wdXQgPSBmdW5jdGlvbiAoX0RhdGVJbnB1dCkge1xuXHQgIF9pbmhlcml0cyhFbmREYXRlSW5wdXQsIF9EYXRlSW5wdXQpO1xuXHRcblx0ICBmdW5jdGlvbiBFbmREYXRlSW5wdXQoKSB7XG5cdCAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRW5kRGF0ZUlucHV0KTtcblx0XG5cdCAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEVuZERhdGVJbnB1dC5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKEVuZERhdGVJbnB1dCkpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuXHQgIH1cblx0XG5cdCAgX2NyZWF0ZUNsYXNzKEVuZERhdGVJbnB1dCwgW3tcblx0ICAgIGtleTogJ3ZhbGlkYXRlRGF0ZScsXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBWYWxpZGF0ZSB0aGUgZ2l2ZW4gdGltZXN0YW1wXG5cdCAgICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSBnaXZlbiB0aW1lc3RhbXAgaXMgdmFsaWQgb3Igbm90XG5cdCAgICAgKi9cblx0ICAgIHZhbHVlOiBmdW5jdGlvbiB2YWxpZGF0ZURhdGUodGltZXN0YW1wKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfVxuXHQgIH1dKTtcblx0XG5cdCAgcmV0dXJuIEVuZERhdGVJbnB1dDtcblx0fShEYXRlSW5wdXQpO1xuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBFbmREYXRlSW5wdXQ7XG5cbi8qKiovIH0sXG4vKiA1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgRnVzaW9uQ2hhcnRzID0gZnVuY3Rpb24gRnVzaW9uQ2hhcnRzKCkge307XG5cdFxuXHRGdXNpb25DaGFydHMucmVnaXN0ZXIgPSBmdW5jdGlvbiAoZXh0LCBhcnIpIHtcblx0ICAvLyB2YXIgZXh0TmFtZSA9IGFyclswXTtcblx0ICB2YXIgZm4gPSBhcnJbMV07XG5cdCAgZm4uYmluZCh0aGlzLCA1NjUpKCk7XG5cdH07XG5cdFxuXHRGdXNpb25DaGFydHMucHJvdG90eXBlLmdldEZvcm1hdHRlZERhdGUgPSBmdW5jdGlvbiAodGltZXN0YW1wKSB7XG5cdCAgcmV0dXJuIG5ldyBEYXRlKHRpbWVzdGFtcCkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG5cdH07XG5cdFxuXHRGdXNpb25DaGFydHMucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uIChkYXRlKSB7XG5cdCAgdmFyIGR0ID0gbmV3IERhdGUoZGF0ZSk7XG5cdCAgcmV0dXJuICtuZXcgRGF0ZShkdC50b0xvY2FsZURhdGVTdHJpbmcoKSk7XG5cdH07XG5cdFxuXHRGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gKGNvbXBvbmVudFR5cGUsIGNvbXBvbmVudE5hbWUpIHtcblx0ICB2YXIgdG9vbEJveCA9IHtcblx0ICAgIHg6IDI0LFxuXHQgICAgeTogNTYsXG5cdCAgICB3aWR0aDogMTAwLFxuXHQgICAgaGVpZ2h0OiAyMCxcblx0ICAgIGluZGV4OiA0XG5cdCAgfTtcblx0XG5cdCAgaWYgKGNvbXBvbmVudFR5cGUgPT09ICdhcGknICYmIGNvbXBvbmVudE5hbWUgPT09ICd0b29sYm94Jykge1xuXHQgICAgcmV0dXJuIHRvb2xCb3g7XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gbnVsbDtcblx0fTtcblx0XG5cdEZ1c2lvbkNoYXJ0cy5leHRBUEkgPSBmdW5jdGlvbiAob2JqKSB7XG5cdCAgb2JqLmluaXQoZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGFyZ3NUb0FwcGx5ID0gW107XG5cdCAgICB2YXIgY2IgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdO1xuXHRcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aCAtIDE7IGkrKykge1xuXHQgICAgICBpZiAoYXJndW1lbnRzW2ldID09PSAnWC1BeGlzJykge1xuXHQgICAgICAgIGFyZ3NUb0FwcGx5LnB1c2goMTU2NzcyKTtcblx0ICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHNbaV0gPT09ICdZLUF4aXMnKSB7XG5cdCAgICAgICAgYXJnc1RvQXBwbHkucHVzaCgxNTY3NjUpO1xuXHQgICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50c1tpXSA9PT0gJ2dyYXBoaWNzJykge1xuXHQgICAgICAgIHZhciBwYXBlciA9IFJhcGhhZWwoMTAsIDUwLCA1MDAsIDUwMCk7XG5cdCAgICAgICAgYXJnc1RvQXBwbHkucHVzaChwYXBlcik7XG5cdCAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzW2ldID09PSAnY2hhcnQnKSB7XG5cdCAgICAgICAgYXJnc1RvQXBwbHkucHVzaChuZXcgRnVzaW9uQ2hhcnRzKCkpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICBjYi5hcHBseSh0aGlzLCBhcmdzVG9BcHBseSk7XG5cdCAgfSk7XG5cdFxuXHQgIG9iai5wbGFjZUluQ2FudmFzKCk7XG5cdFxuXHQgIG9iai5kcmF3KCk7XG5cdFxuXHQgIG9iai5kaXNwb3NlKCk7XG5cdH07XG5cdFxuXHRpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuXHQgIG1vZHVsZS5leHBvcnRzID0gRnVzaW9uQ2hhcnRzO1xuXHR9IGVsc2Uge1xuXHQgIHdpbmRvdy5GdXNpb25DaGFydHMgPSBGdXNpb25DaGFydHM7XG5cdH1cblxuLyoqKi8gfVxuLyoqKioqKi8gXSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDUyYjNhMDY4ZmJkYjA0MTQ1OTNlXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuY29uc3QgRGF0ZVJhbmdlID0gcmVxdWlyZSgnLi9mY3RzLWV4dC1kYXRlcmFuZ2UnKTtcblxuOyhmdW5jdGlvbiAoZmFjdG9yeSkge1xuICBmYWN0b3J5KEZ1c2lvbkNoYXJ0cyk7XG59KShmdW5jdGlvbiAoRkMpIHtcbiAgRnVzaW9uQ2hhcnRzLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ2RhdGUtcmFuZ2UtY2hvb3NlcicsIGZ1bmN0aW9uIChpZCkge1xuICAgIHZhciBnbG9iYWwgPSB0aGlzO1xuICAgIHZhciBleHRBUEkgPSBnbG9iYWwuZXh0QVBJO1xuXG4gICAgLy8gdmFyIG90aGVyQVBJID0gRnVzaW9uQ2hhcnRzLmdldEV4dENvbXBvbmVudChpZCwgJ2FwaScsICdsZWdhY3lleHRhcGknKTtcbiAgICAvLyB2YXIgdG9vbEJveEFwaSA9IEZ1c2lvbkNoYXJ0cy5nZXRDb21wb25lbnQoJ2FwaScsICd0b29sYm94Jyk7XG5cbiAgICB3aW5kb3cuZHIgPSBuZXcgRGF0ZVJhbmdlKCk7XG4gICAgZXh0QVBJKHdpbmRvdy5kcik7XG4gIH1dKTtcbn0pO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvaW5kZXguanNcbiAqKi8iLCIndXNlIHN0cmljdCc7XG52YXIgU3RhcnREYXRlSW5wdXQgPSByZXF1aXJlKCcuL2ZjdHMtZXh0LXN0YXJ0ZGF0ZWlucHV0Jyk7XG52YXIgRW5kRGF0ZUlucHV0ID0gcmVxdWlyZSgnLi9mY3RzLWV4dC1lbmRkYXRlaW5wdXQnKTtcbnZhciBGdXNpb25DaGFydHMgPSByZXF1aXJlKCcuLi9saWIvZnVzaW9uY2hhcnRzJyk7XG5cbi8qKlxuICogQ2xhc3MgcmVwcmVzZW50aW5nIHRoZSBEYXRlUmFuZ2UuXG4gKi9cbmNsYXNzIERhdGVSYW5nZSB7XG4gIC8qKlxuICAgKiBDcmVhdGUgYSBEYXRlUmFuZ2UuXG4gICAqIEB0eXBlZGVmICB7b2JqZWN0fSBEYXRlUmFuZ2UucmFuZ2VcbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IHN0YXJ0RGF0ZSAtIFRoZSBzdGFydCBkYXRlIG9mIHRoZSBkYXRlIHJhbmdlLlxuICAgKiBAcHJvcGVydHkge251bWJlcn0gZW5kRGF0ZSAgIC0gVGhlIGVuZCBkYXRlIG9mIHRoZSBkYXRlIHJhbmdlLlxuICAgKi9cbiAgY29uc3RydWN0b3IgKCkge1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5kYXRlUmFuZ2UgPSB7XG4gICAgICBzdGFydERhdGU6IDAsXG4gICAgICBlbmREYXRlOiAwXG4gICAgfTtcbiAgICB0aGlzLnN0YXJ0VGV4dCA9IHtcbiAgICAgIGF0dHI6IGZ1bmN0aW9uICgpIHt9XG4gICAgfTtcbiAgICB0aGlzLmVuZFRleHQgPSB7XG4gICAgICBhdHRyOiBmdW5jdGlvbiAoKSB7fVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc3RhcnQgYW5kIGVuZCBkYXRlcy5cbiAgICogQHR5cGUge0RhdGVSYW5nZS5yYW5nZX1cbiAgICovXG4gIGdldCByYW5nZSAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0ZVJhbmdlO1xuICB9XG5cbiAgc2V0IHJhbmdlIChyYW5nZSkge1xuICAgIGlmIChyYW5nZS5zdGFydERhdGUgPD0gcmFuZ2UuZW5kRGF0ZSkge1xuICAgICAgdGhpcy5kYXRlUmFuZ2Uuc3RhcnREYXRlID0gcmFuZ2Uuc3RhcnREYXRlO1xuICAgICAgdmFyIGZvcm1hdHRlZFN0YXJ0RGF0ZSA9IHRoaXMuZ2V0Rm9ybWF0dGVkRGF0ZShyYW5nZS5zdGFydERhdGUpO1xuICAgICAgdGhpcy5zdGFydFRleHQuYXR0cigndGV4dCcsIGZvcm1hdHRlZFN0YXJ0RGF0ZSk7XG5cbiAgICAgIHRoaXMuZGF0ZVJhbmdlLmVuZERhdGUgPSByYW5nZS5lbmREYXRlO1xuICAgICAgdmFyIGZvcm1hdHRlZEVuZERhdGUgPSB0aGlzLmdldEZvcm1hdHRlZERhdGUocmFuZ2UuZW5kRGF0ZSk7XG4gICAgICB0aGlzLmVuZFRleHQuYXR0cigndGV4dCcsIGZvcm1hdHRlZEVuZERhdGUpO1xuXG4gICAgICB2YXIgc2RpID0gbmV3IFN0YXJ0RGF0ZUlucHV0KCk7XG4gICAgICBzZGkudGltZXN0YW1wID0gdGhpcy5kYXRlUmFuZ2Uuc3RhcnREYXRlO1xuXG4gICAgICB2YXIgZWRpID0gbmV3IEVuZERhdGVJbnB1dCgpO1xuICAgICAgZWRpLnRpbWVzdGFtcCA9IHRoaXMuZGF0ZVJhbmdlLmVuZERhdGU7XG4gICAgfVxuICB9XG5cbiAgaW5pdCAocmVxdWlyZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBpZiAodHlwZW9mIHJlcXVpcmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJlcXVpcmUoJ1gtQXhpcycsICdZLUF4aXMnLCAnZ3JhcGhpY3MnLCAnY2hhcnQnLCBmdW5jdGlvbiAoeCwgeSwgZ3JhcGhpY3MsIGNoYXJ0KSB7XG4gICAgICAgIHNlbGYueCA9IHg7XG4gICAgICAgIHNlbGYueSA9IHk7XG4gICAgICAgIHNlbGYucGFwZXIgPSBncmFwaGljcztcbiAgICAgICAgc2VsZi5jaGFydCA9IGNoYXJ0O1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGYuY2hhcnQgPSBuZXcgRnVzaW9uQ2hhcnRzKCk7XG4gICAgfVxuICB9XG5cbiAgcGxhY2VJbkNhbnZhcyAoKSB7XG4gICAgdGhpcy5yYW5nZSA9IHtcbiAgICAgIHN0YXJ0RGF0ZTogMTIsXG4gICAgICBlbmREYXRlOiAyM1xuICAgIH07XG4gIH1cblxuICBkcmF3ICgpIHtcbiAgICB2YXIgcGFwZXIgPSB0aGlzLnBhcGVyO1xuICAgIHZhciByYW5nZSA9IHRoaXMucmFuZ2U7XG5cbiAgICB2YXIgc3RhcnRMYWJlbCA9IHBhcGVyLnRleHQoMjAsIDIyLCAnRnJvbTogJyk7XG4gICAgc3RhcnRMYWJlbC5hdHRyKCdmb250LWZhbWlseScsICdzYW5zLXNlcmlmJyk7XG4gICAgc3RhcnRMYWJlbC5hdHRyKCdmaWxsJywgJyMwMDAnKTtcbiAgICB2YXIgc3RhcnRSZWN0ID0gcGFwZXIucmVjdCg1MCwgMTAsIDkwLCAyNSk7XG4gICAgc3RhcnRSZWN0LmF0dHIoJ3N0cm9rZScsICcjMDAwJyk7XG4gICAgdGhpcy5zdGFydFRleHQgPSBwYXBlci50ZXh0KDk1LCAyMiwgdGhpcy5nZXRGb3JtYXR0ZWREYXRlKHJhbmdlLnN0YXJ0RGF0ZSkpO1xuICAgIHRoaXMuc3RhcnRUZXh0LmF0dHIoJ2ZvbnQtZmFtaWx5JywgJ3NhbnMtc2VyaWYnKTtcbiAgICB0aGlzLnN0YXJ0VGV4dC5hdHRyKCdmaWxsJywgJyMwMDAnKTtcblxuICAgIHZhciBlbmRMYWJlbCA9IHBhcGVyLnRleHQoMTcwLCAyMiwgJ1RvOiAnKTtcbiAgICBlbmRMYWJlbC5hdHRyKCdmb250LWZhbWlseScsICdzYW5zLXNlcmlmJyk7XG4gICAgZW5kTGFiZWwuYXR0cignZmlsbCcsICcjMDAwJyk7XG4gICAgdmFyIGVuZFJlY3QgPSBwYXBlci5yZWN0KDE5MCwgMTAsIDkwLCAyNSk7XG4gICAgZW5kUmVjdC5hdHRyKCdzdHJva2UnLCAnIzAwMCcpO1xuICAgIHRoaXMuZW5kVGV4dCA9IHBhcGVyLnRleHQoMjM1LCAyMiwgdGhpcy5nZXRGb3JtYXR0ZWREYXRlKHJhbmdlLmVuZERhdGUpKTtcbiAgICB0aGlzLmVuZFRleHQuYXR0cignZm9udC1mYW1pbHknLCAnc2Fucy1zZXJpZicpO1xuICAgIHRoaXMuZW5kVGV4dC5hdHRyKCdmaWxsJywgJyMwMDAnKTtcbiAgfVxuXG4gIGRpc3Bvc2UgKCkge1xuICAgIC8vIFRPRE86IGRpc3Bvc2UgZXh0ZW5zaW9uXG4gIH1cblxuICAvKipcbiAgICogU3dhcHMgdGhlIHN0YXJ0IGRhdGUgYW5kIHRoZSBlbmQgZGF0ZSBvZiB0aGUgZGF0ZSByYW5nZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3dhcERhdGVzICgpIHtcbiAgICBsZXQgdGVtcCA9IHRoaXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZTtcbiAgICB0aGlzLmRhdGVSYW5nZS5zdGFydERhdGUgPSB0aGlzLmRhdGVSYW5nZS5lbmREYXRlO1xuICAgIHRoaXMuZGF0ZVJhbmdlLmVuZERhdGUgPSB0ZW1wO1xuICB9XG5cbiAgLyoqXG4gICAqIFN5bmNzIHRoZSBkYXRlcmFuZ2Ugc2hvd24gYnkgdGhlIEZ1c2lvbkNoYXJ0cyB0aW1lIHNlcmllcyBjaGFydCBhbmQgdGhlIERhdGUgUmFuZ2UgQ2hvb3NlclxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3luY1JhbmdlICgpIHt9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBmb3JtYXR0ZWQgZGF0ZSBzdHJpbmcgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIFVOSVggdGltZXN0YW1wXG4gICAqIEBwYXJhbSAge251bWJlcn0gdGltZXN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBjb252ZXJ0ZWQgdG8gYSBkYXRlIHN0cmluZ1xuICAgKiBAcmV0dXJuIHtzdHJpbmd9IC0gQSBkYXRlIHN0cmluZyB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiB0aW1lc3RhbXBcbiAgICovXG4gIGdldEZvcm1hdHRlZERhdGUgKHRpbWVzdGFtcCkge1xuICAgIHJldHVybiB0aGlzLmNoYXJ0LmdldEZvcm1hdHRlZERhdGUodGltZXN0YW1wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgVU5JWCB0aW1lc3RhbXAgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZ1xuICAgKiBAcGFyYW0gIHtzdHJpbmd9IGRhdGVTdHJpbmcgLSBBIGRhdGUgc3RyaW5nIHRvIGJlIGNvbnZlcnRlZCB0byBhIFVOSVggdGltZXN0YW1wXG4gICAqIEByZXR1cm4ge251bWJlcn0gQSBVTklYIHRpbWVzdGFtcCB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBkYXRlIHN0cmluZ1xuICAgKi9cbiAgZ2V0VGltZXN0YW1wIChkYXRlU3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hhcnQuZ2V0VGltZXN0YW1wKGRhdGVTdHJpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnT2JqIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXh0ZW5zaW9uIG9wdGlvbnNcbiAgICovXG4gIHNldENvbmZpZyAoY29uZmlnT2JqKSB7fVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb25maWd1cmFibGUgb3B0aW9ucyBvZiB0aGUgZXh0ZW5zaW9uIChlLmcuIGNvc21ldGljcylcbiAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuICAgKi9cbiAgZ2V0Q29uZmlnICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY2FsZW5kYXJWaXNpYmxlOiAnZmFsc2UnXG4gICAgfTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IERhdGVSYW5nZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2ZjdHMtZXh0LWRhdGVyYW5nZS5qc1xuICoqLyIsIid1c2Ugc3RyaWN0JztcbmNvbnN0IERhdGVJbnB1dCA9IHJlcXVpcmUoJy4vZmN0cy1leHQtZGF0ZWlucHV0Jyk7XG5cbi8qKlxuICogQSBjb25jcmV0ZSByZXByZXNlbnRhdGlvbiBvZiBEYXRlSW5wdXQgZm9yIHRoZSBzdGFydCBkYXRlLlxuICogQGV4dGVuZHMgRGF0ZUlucHV0XG4gKiBAcHJpdmF0ZVxuICovXG5jbGFzcyBTdGFydERhdGVJbnB1dCBleHRlbmRzIERhdGVJbnB1dCB7XG4gIC8qKlxuICAgKiBWYWxpZGF0ZSB0aGUgZ2l2ZW4gdGltZXN0YW1wXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIGdpdmVuIHRpbWVzdGFtcCBpcyB2YWxpZCBvciBub3RcbiAgICovXG4gIHZhbGlkYXRlRGF0ZSAodGltZXN0YW1wKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBTdGFydERhdGVJbnB1dDtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2ZjdHMtZXh0LXN0YXJ0ZGF0ZWlucHV0LmpzXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuLyoqXG4gKiBDbGFzcyByZXByZXNlbnRpbmcgYSBhYnN0cmFjdCBEYXRlSW5wdXQuXG4gKiBAYWJzdHJhY3RcbiAqIEBwcml2YXRlXG4gKi9cbmNsYXNzIERhdGVJbnB1dCB7XG4gIGNvbnN0cnVjdG9yICgpIHtcbiAgICAvKipcbiAgICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBEYXRlSW5wdXQuaW5wdXRcbiAgICAgKiBAcHJvcGVydHkge251bWJlcn0gdGltZXN0YW1wIC0gVGhlIGN1cnJlbnQgdGltZSBzaG93biBvbiB0aGUgZGF0ZSBpbnB1dC5cbiAgICAgKi9cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMudGltZXN0YW1wID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXByZXNlbnRzIHRoZSBudW1lcmljIHZhbHVlIG9mIHRoZSBkYXRlXG4gICAqIEB0eXBlIG51bWJlclxuICAgKi9cbiAgZ2V0IGRhdGUgKCkge1xuICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcDtcbiAgfVxuXG4gIHNldCBkYXRlIChtcykge1xuICAgIHRoaXMudGltZXN0YW1wID0gbXM7XG4gIH1cblxuICAvKipcbiAgICogRGlzcGxheXMgdGhlIGRhdGUgb24gdGhlIGRhdGUgaW5wdXRcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGRpc3BsYXlEYXRlICgpIHt9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gRGF0ZUlucHV0O1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvZmN0cy1leHQtZGF0ZWlucHV0LmpzXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuY29uc3QgRGF0ZUlucHV0ID0gcmVxdWlyZSgnLi9mY3RzLWV4dC1kYXRlaW5wdXQnKTtcblxuLyoqXG4gKiBBIGNvbmNyZXRlIHJlcHJlc2VudGF0aW9uIG9mIERhdGVJbnB1dCBmb3IgdGhlIGVuZCBkYXRlLlxuICogQGV4dGVuZHMgRGF0ZUlucHV0XG4gKiBAcHJpdmF0ZVxuICovXG5jbGFzcyBFbmREYXRlSW5wdXQgZXh0ZW5kcyBEYXRlSW5wdXQge1xuICAvKipcbiAgICogVmFsaWRhdGUgdGhlIGdpdmVuIHRpbWVzdGFtcFxuICAgKiBAcmV0dXJuIHtib29sZWFufSBXaGV0aGVyIHRoZSBnaXZlbiB0aW1lc3RhbXAgaXMgdmFsaWQgb3Igbm90XG4gICAqL1xuICB2YWxpZGF0ZURhdGUgKHRpbWVzdGFtcCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gRW5kRGF0ZUlucHV0O1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvZmN0cy1leHQtZW5kZGF0ZWlucHV0LmpzXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xudmFyIEZ1c2lvbkNoYXJ0cyA9IGZ1bmN0aW9uICgpIHt9O1xuXG5GdXNpb25DaGFydHMucmVnaXN0ZXIgPSBmdW5jdGlvbiAoZXh0LCBhcnIpIHtcbiAgLy8gdmFyIGV4dE5hbWUgPSBhcnJbMF07XG4gIHZhciBmbiA9IGFyclsxXTtcbiAgZm4uYmluZCh0aGlzLCA1NjUpKCk7XG59O1xuXG5GdXNpb25DaGFydHMucHJvdG90eXBlLmdldEZvcm1hdHRlZERhdGUgPSBmdW5jdGlvbiAodGltZXN0YW1wKSB7XG4gIHJldHVybiBuZXcgRGF0ZSh0aW1lc3RhbXApLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xufTtcblxuRnVzaW9uQ2hhcnRzLnByb3RvdHlwZS5nZXRUaW1lc3RhbXAgPSBmdW5jdGlvbiAoZGF0ZSkge1xuICB2YXIgZHQgPSBuZXcgRGF0ZShkYXRlKTtcbiAgcmV0dXJuICtuZXcgRGF0ZShkdC50b0xvY2FsZURhdGVTdHJpbmcoKSk7XG59O1xuXG5GdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gKGNvbXBvbmVudFR5cGUsIGNvbXBvbmVudE5hbWUpIHtcbiAgdmFyIHRvb2xCb3ggPSB7XG4gICAgeDogMjQsXG4gICAgeTogNTYsXG4gICAgd2lkdGg6IDEwMCxcbiAgICBoZWlnaHQ6IDIwLFxuICAgIGluZGV4OiA0XG4gIH07XG5cbiAgaWYgKGNvbXBvbmVudFR5cGUgPT09ICdhcGknICYmIGNvbXBvbmVudE5hbWUgPT09ICd0b29sYm94Jykge1xuICAgIHJldHVybiB0b29sQm94O1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59O1xuXG5GdXNpb25DaGFydHMuZXh0QVBJID0gZnVuY3Rpb24gKG9iaikge1xuICBvYmouaW5pdChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFyZ3NUb0FwcGx5ID0gW107XG4gICAgdmFyIGNiID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgaWYgKGFyZ3VtZW50c1tpXSA9PT0gJ1gtQXhpcycpIHtcbiAgICAgICAgYXJnc1RvQXBwbHkucHVzaCgxNTY3NzIpO1xuICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHNbaV0gPT09ICdZLUF4aXMnKSB7XG4gICAgICAgIGFyZ3NUb0FwcGx5LnB1c2goMTU2NzY1KTtcbiAgICAgIH0gZWxzZSBpZiAoYXJndW1lbnRzW2ldID09PSAnZ3JhcGhpY3MnKSB7XG4gICAgICAgIHZhciBwYXBlciA9IFJhcGhhZWwoMTAsIDUwLCA1MDAsIDUwMCk7XG4gICAgICAgIGFyZ3NUb0FwcGx5LnB1c2gocGFwZXIpO1xuICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHNbaV0gPT09ICdjaGFydCcpIHtcbiAgICAgICAgYXJnc1RvQXBwbHkucHVzaChuZXcgRnVzaW9uQ2hhcnRzKCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBjYi5hcHBseSh0aGlzLCBhcmdzVG9BcHBseSk7XG4gIH0pO1xuXG4gIG9iai5wbGFjZUluQ2FudmFzKCk7XG5cbiAgb2JqLmRyYXcoKTtcblxuICBvYmouZGlzcG9zZSgpO1xufTtcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBGdXNpb25DaGFydHM7XG59IGVsc2Uge1xuICB3aW5kb3cuRnVzaW9uQ2hhcnRzID0gRnVzaW9uQ2hhcnRzO1xufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9saWIvZnVzaW9uY2hhcnRzLmpzXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==
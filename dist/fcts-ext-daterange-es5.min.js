!function(t){function e(o){if(a[o])return a[o].exports;var n=a[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=a(2);window.dr=new o,function(a,o){"object"===e(t)&&t.exports?t.exports=a.document?o(a):function(t){if(!t.document)throw new Error("Window with document not present");return o(t,!0)}:a.DateRangeChooser=o(a,!0)}("undefined"!=typeof window?window:void 0,function(t,e){var a=t.FusionCharts;a.register("extension",["private","DateRangeChooser",function(){a.registerComponent("extensions","DateRangeChooser",o)}])})}).call(e,a(1)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,a,o){return a&&t(e.prototype,a),o&&t(e,o),e}}(),n=function(){function t(){a(this,t),this.startDt=0,this.endDt=0,this.startDataset=0,this.endDataset=0,this.toolbox=FusionCharts.getComponent("api","toolbox"),this.HorizontalToolbar=this.toolbox.HorizontalToolbar,this.ComponentGroup=this.toolbox.ComponentGroup,this.SymbolStore=this.toolbox.SymbolStore,this.startText={attr:function(){}},this.endText={attr:function(){}}}return o(t,[{key:"swapDates",value:function(){var t=this.dateRange.startDate;this.dateRange.startDate=this.dateRange.endDate,this.dateRange.endDate=t}},{key:"syncRange",value:function(){}},{key:"getFormattedDate",value:function(t){return this.chart.getFormattedDate(t)}},{key:"getTimestamp",value:function(t){return this.chart.getTimestamp(t)}},{key:"setConfig",value:function(t){}},{key:"getConfig",value:function(){return{calendarVisible:"false"}}},{key:"init",value:function(t){var e=this;return t(["xAxis","yAxis","graphics","chart","dataset","PlotManager","canvasConfig","MarkerManager","reactiveModel","globalReactiveModel","spaceManagerInstance","smartLabel","chartInstance",function(t,a,o,n,r,i,s,l,h,c,u,d){e.xAxis=t,e.yAxis=a,e.graphics=o,e.chart=n,e.dataset=r,e.plotManager=i,e.markerManager=l,e.canvasConfig=s,e.reactiveModel=h,e.globalReactiveModel=c,e.spaceManagerInstance=u,e.smartLabel=d}]),this.spaceManagerInstance=e.spaceManagerInstance,this.globalReactiveModel=e.globalReactiveModel,this.startDt=e.globalReactiveModel.model["x-axis-visible-range-start"],this.endDt=e.globalReactiveModel.model["x-axis-visible-range-end"],this.startDataset=e.globalReactiveModel.model["x-axis-absolute-range-start"],this.endDataset=e.globalReactiveModel.model["x-axis-absolute-range-end"],this.toolbars=[],this.measurement={},this.toolbars.push(this.createToolbar()),this}},{key:"createToolbar",value:function(){var t,e,a,o,n,r,i=this;return i.fromDate={},i.toDate={},n=new Date(this.startDt).toLocaleDateString(),r=new Date(this.endDt).toLocaleDateString(),t=new this.HorizontalToolbar({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),t.setConfig({fill:"#fff",borderThickness:0}),o=new this.toolbox.ComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),o.setConfig({fill:"#fff",borderThickness:0}),e=new this.toolbox.Label("From:",{smartLabel:this.smartLabel,paper:this.graphics.paper},{text:{style:{"font-size":"15",fontFamily:"MyriadPro"}}}),i.fromDate=new this.toolbox.InputTextBoxSymbol({width:120,height:25},{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},{strokeWidth:1,stroke:"rgba(102,102,102,0.5)",symbolStrokeWidth:0,btnTextStyle:{fontSize:14},label:n}),a=new this.toolbox.Label("To:",{smartLabel:this.smartLabel,paper:this.graphics.paper},{text:{style:{"font-size":"15",fontFamily:"MyriadPro"}}}),i.toDate=new this.toolbox.InputTextBoxSymbol({width:120,height:25},{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},{strokeWidth:1,stroke:"rgba(102,102,102,0.5)",symbolStrokeWidth:0,btnTextStyle:{fontSize:14},label:r}),i.fromDate.attachEventHandlers({click:{fn:i.fromDate.edit},textOnBlur:function(){i.fromDate.blur(),i.startDate=i.fromDate.getText(),console.log(i.fromDate.getText())}}),i.toDate.attachEventHandlers({click:{fn:i.toDate.edit},textOnBlur:function(){i.toDate.blur(),console.log(i.toDate.getText()),i.endDate=i.toDate.getText()}}),this.SymbolStore.register("textBoxIcon",function(t,e,a,o,n,r,i){var s=t-o/2+r/2,l=t+o/2-r/2,h=e-n/2+i/2,c=e+n/2-i/2;return["M",s,h,"L",l,h,"L",l,c,"L",s,c,"Z"]}),o.addSymbol(e),o.addSymbol(i.fromDate),o.addSymbol(a),o.addSymbol(i.toDate),t.addComponent(o),t}},{key:"getLogicalSpace",value:function(t,e){t/=2;var a,o,n,r=0,i=0;for(o=0,n=this.toolbars.length;o<n;o++)a=this.toolbars[o].getLogicalSpace(),r=Math.max(a.width,r),i+=a.height,this.toolbars[o].width=a.width,this.toolbars[o].height=a.height;return i+=this.padding,{width:r>t?0:r,height:i>e?0:i}}},{key:"placeInCanvas",value:function(){var t=this;t.padding=5,t.spaceManagerInstance.add([{name:function(){return"ToolBoxExt"},ref:function(t){return t[0]},self:function(){return t},priority:function(){return 2},layout:function(t){return t.inline},orientation:[{type:function(t){return t.horizontal},position:[{type:function(t){return t.top},alignment:[{type:function(t){return t.left},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(t,e,a,o,n){var r=this.measurement;return r.x=t,r.y=e,r.width=a,r.height=o,this.parentGroup=n,this}},{key:"draw",value:function(t,e,a,o,n){var r,i,s,l=this.measurement,h=this.toolbars,c=this.globalReactiveModel,u=this;if(console.log(c),t=void 0===t?l.x:t,e=void 0===e?l.y:e,a=void 0===a?l.width:a,o=void 0===o?l.height:o,n=void 0===n?this.parentGroup:n,a&&o)for(i=0,r=h.length;i<r;i++)s=h[i],s.draw(t,e);c.onPropsChange(["x-axis-visible-range-start","x-axis-visible-range-end"],function(t,e){u.fromDate.blur(new Date(t[1]).toLocaleDateString()),u.toDate.blur(new Date(e[1]).toLocaleDateString())})}},{key:"startDate",get:function(){return this.startDt},set:function(t){var e=+new Date(t);e<=this.endDt&&(this.startDt=e,this.globalReactiveModel.model["x-axis-visible-range-start"]=this.startDt)}},{key:"endDate",get:function(){return this.endDt},set:function(t){var e=+new Date(t);e>=this.startDt&&(this.endDt=e,this.globalReactiveModel.model["x-axis-visible-range-end"]=this.endDt)}}]),t}();"undefined"!=typeof t&&"undefined"!=typeof t.exports?t.exports=n:window.StandardPeriod=n}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDJiY2U1ZDdjM2Y2YWI1NzFhZmFhIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9mY3RzLWV4dC1kYXRlcmFuZ2UuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJEYXRlUmFuZ2UiLCJ3aW5kb3ciLCJkciIsImVudiIsImZhY3RvcnkiLCJkb2N1bWVudCIsIndpbiIsIkVycm9yIiwiRGF0ZVJhbmdlQ2hvb3NlciIsInVuZGVmaW5lZCIsIl93aW5kb3ciLCJ3aW5kb3dFeGlzdHMiLCJGQyIsIkZ1c2lvbkNoYXJ0cyIsInJlZ2lzdGVyIiwicmVnaXN0ZXJDb21wb25lbnQiLCJ3ZWJwYWNrUG9seWZpbGwiLCJkZXByZWNhdGUiLCJwYXRocyIsImNoaWxkcmVuIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJ0aGlzIiwic3RhcnREdCIsImVuZER0Iiwic3RhcnREYXRhc2V0IiwiZW5kRGF0YXNldCIsInRvb2xib3giLCJnZXRDb21wb25lbnQiLCJIb3Jpem9udGFsVG9vbGJhciIsIkNvbXBvbmVudEdyb3VwIiwiU3ltYm9sU3RvcmUiLCJzdGFydFRleHQiLCJhdHRyIiwiZW5kVGV4dCIsInZhbHVlIiwidGVtcCIsImRhdGVSYW5nZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJ0aW1lc3RhbXAiLCJjaGFydCIsImdldEZvcm1hdHRlZERhdGUiLCJkYXRlU3RyaW5nIiwiZ2V0VGltZXN0YW1wIiwiY29uZmlnT2JqIiwiY2FsZW5kYXJWaXNpYmxlIiwicmVxdWlyZSIsInhBeGlzIiwieUF4aXMiLCJncmFwaGljcyIsImRhdGFzZXQiLCJwbG90TWFuYWdlciIsImNhbnZhc0NvbmZpZyIsIm1hcmtlck1hbmFnZXIiLCJyZWFjdGl2ZU1vZGVsIiwiZ2xvYmFsUmVhY3RpdmVNb2RlbCIsInNwYWNlTWFuYWdlckluc3RhbmNlIiwic21hcnRMYWJlbCIsIm1vZGVsIiwidG9vbGJhcnMiLCJtZWFzdXJlbWVudCIsInB1c2giLCJjcmVhdGVUb29sYmFyIiwidG9vbGJhciIsImZyb21EYXRlTGFiZWwiLCJ0b0RhdGVMYWJlbCIsImdyb3VwIiwiZnJvbUZvcm1hdHRlZERhdGUiLCJ0b0Zvcm1hdHRlZERhdGUiLCJzZWxmIiwiZnJvbURhdGUiLCJ0b0RhdGUiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwicGFwZXIiLCJjaGFydENvbnRhaW5lciIsImNvbnRhaW5lciIsInNldENvbmZpZyIsImZpbGwiLCJib3JkZXJUaGlja25lc3MiLCJMYWJlbCIsInRleHQiLCJzdHlsZSIsImZvbnQtc2l6ZSIsImZvbnRGYW1pbHkiLCJJbnB1dFRleHRCb3hTeW1ib2wiLCJ3aWR0aCIsImhlaWdodCIsInN0cm9rZVdpZHRoIiwic3Ryb2tlIiwic3ltYm9sU3Ryb2tlV2lkdGgiLCJidG5UZXh0U3R5bGUiLCJmb250U2l6ZSIsImxhYmVsIiwiYXR0YWNoRXZlbnRIYW5kbGVycyIsImNsaWNrIiwiZm4iLCJlZGl0IiwidGV4dE9uQmx1ciIsImJsdXIiLCJnZXRUZXh0IiwiY29uc29sZSIsImxvZyIsIngiLCJ5IiwicmFkIiwidyIsImgiLCJwYWRYIiwicGFkWSIsIngxIiwieDIiLCJ5MSIsInkyIiwiYWRkU3ltYm9sIiwiYWRkQ29tcG9uZW50IiwiYXZhaWxhYmxlV2lkdGgiLCJhdmFpbGFibGVIZWlnaHQiLCJsb2dpY2FsU3BhY2UiLCJsbiIsImdldExvZ2ljYWxTcGFjZSIsIk1hdGgiLCJtYXgiLCJwYWRkaW5nIiwiYWRkIiwibmFtZSIsInJlZiIsInByaW9yaXR5IiwibGF5b3V0IiwiaW5saW5lIiwib3JpZW50YXRpb24iLCJ0eXBlIiwiaG9yaXpvbnRhbCIsInBvc2l0aW9uIiwidG9wIiwiYWxpZ25tZW50IiwibGVmdCIsImRpbWVuc2lvbnMiLCJwYXJlbnQiLCJnZXRQYXJlbnRDb21wb25lbnRHcm91cCIsImdldFdpZHRoIiwiZ2V0SGVpZ2h0IiwibWVzIiwicGFyZW50R3JvdXAiLCJkcmF3Iiwib25Qcm9wc0NoYW5nZSIsInN0YXJ0IiwiZW5kIiwiZ2V0Iiwic2V0Iiwic3RhcnRUaW1lc3RhbXAiLCJlbmRUaW1lc3RhbXAiLCJTdGFuZGFyZFBlcmlvZCJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0NJbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFFLE9BR0EsSUFBQUMsR0FBQUYsRUFBQUQsSUFDQUUsV0FDQUUsR0FBQUosRUFDQUssUUFBQSxFQVVBLE9BTkFQLEdBQUFFLEdBQUFNLEtBQUFILEVBQUFELFFBQUFDLElBQUFELFFBQUFILEdBR0FJLEVBQUFFLFFBQUEsRUFHQUYsRUFBQUQsUUF2QkEsR0FBQUQsS0FxQ0EsT0FUQUYsR0FBQVEsRUFBQVQsRUFHQUMsRUFBQVMsRUFBQVAsRUFHQUYsRUFBQVUsRUFBQSxHQUdBVixFQUFBLEtETU0sU0FBU0ksRUFBUUQsRUFBU0gsSUU1Q2hDLFNBQUFJLEdBQUEsWUZnREMsSUFBSU8sR0FBNEIsa0JBQVhDLFNBQW9ELGdCQUFwQkEsUUFBT0MsU0FBd0IsU0FBVUMsR0FBTyxhQUFjQSxJQUFTLFNBQVVBLEdBQU8sTUFBT0EsSUFBeUIsa0JBQVhGLFNBQXlCRSxFQUFJQyxjQUFnQkgsUUFBVUUsSUFBUUYsT0FBT0ksVUFBWSxlQUFrQkYsSUUvQ2pRRyxFQUFZakIsRUFBUSxFQUUxQmtCLFFBQU9DLEdBQUssR0FBSUYsR0FFZixTQUFXRyxFQUFLQyxHQUNPLFdBQWxCVixFQUFPUCxJQUF1QkEsRUFBT0QsUUFDdkNDLEVBQU9ELFFBQVVpQixFQUFJRSxTQUNoQkQsRUFBUUQsR0FBTyxTQUFVRyxHQUN6QixJQUFLQSxFQUFJRCxTQUNQLEtBQU0sSUFBSUUsT0FBTSxtQ0FFbEIsT0FBT0gsR0FBUUUsR0FBSyxJQUd6QkgsRUFBSUssaUJBQW1CSixFQUFRRCxHQUFLLElBRW5CLG1CQUFYRixRQUF5QkEsT0FBaENRLE9BQStDLFNBQVVDLEVBQVNDLEdBQ25FLEdBQUlDLEdBQUtGLEVBQVFHLFlBQ2pCRCxHQUFHRSxTQUFTLGFBQWMsVUFBVyxtQkFBb0IsV0FDdkRGLEVBQUdHLGtCQUFrQixhQUFjLG1CQUFvQmYsVUZtRDdCVixLQUFLSixFQUFTSCxFQUFvQixHQUFHSSxLQUk3RCxTQUFTQSxFQUFRRCxHRzNFdkJDLEVBQUFELFFBQUEsU0FBQUMsR0FRQSxNQVBBQSxHQUFBNkIsa0JBQ0E3QixFQUFBOEIsVUFBQSxhQUNBOUIsRUFBQStCLFNBRUEvQixFQUFBZ0MsWUFDQWhDLEVBQUE2QixnQkFBQSxHQUVBN0IsSUhtRk0sU0FBU0EsRUFBUUQsR0kzRnZCLFlKb0dDLFNBQVNrQyxHQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQUZoSCxHQUFJQyxHQUFlLFdBQWMsUUFBU0MsR0FBaUJDLEVBQVFDLEdBQVMsSUFBSyxHQUFJQyxHQUFJLEVBQUdBLEVBQUlELEVBQU1FLE9BQVFELElBQUssQ0FBRSxHQUFJRSxHQUFhSCxFQUFNQyxFQUFJRSxHQUFXQyxXQUFhRCxFQUFXQyxhQUFjLEVBQU9ELEVBQVdFLGNBQWUsRUFBVSxTQUFXRixLQUFZQSxFQUFXRyxVQUFXLEdBQU1DLE9BQU9DLGVBQWVULEVBQVFJLEVBQVdNLElBQUtOLElBQWlCLE1BQU8sVUFBVVIsRUFBYWUsRUFBWUMsR0FBaUosTUFBOUhELElBQVlaLEVBQWlCSCxFQUFZdkIsVUFBV3NDLEdBQWlCQyxHQUFhYixFQUFpQkgsRUFBYWdCLEdBQXFCaEIsTUk5RjNoQnRCLEVKa0dXLFdJakdmLFFBQUFBLEtBQWVvQixFQUFBbUIsS0FBQXZDLEdBSWJ1QyxLQUFLQyxRQUFVLEVBQ2ZELEtBQUtFLE1BQVEsRUFDYkYsS0FBS0csYUFBZSxFQUNwQkgsS0FBS0ksV0FBYSxFQUNsQkosS0FBS0ssUUFBVS9CLGFBQWFnQyxhQUFhLE1BQU8sV0FDaEROLEtBQUtPLGtCQUFvQlAsS0FBS0ssUUFBUUUsa0JBQ3RDUCxLQUFLUSxlQUFpQlIsS0FBS0ssUUFBUUcsZUFDbkNSLEtBQUtTLFlBQWNULEtBQUtLLFFBQVFJLFlBQ2hDVCxLQUFLVSxXQUNIQyxLQUFNLGNBRVJYLEtBQUtZLFNBQ0hELEtBQU0sY0pzZVQsTUF4WEExQixHQUFheEIsSUFDWG9DLElBQUssWUFPTGdCLE1BQU8sV0lqRlIsR0FBSUMsR0FBT2QsS0FBS2UsVUFBVUMsU0FDMUJoQixNQUFLZSxVQUFVQyxVQUFZaEIsS0FBS2UsVUFBVUUsUUFDMUNqQixLQUFLZSxVQUFVRSxRQUFVSCxLSjJGeEJqQixJQUFLLFlBQ0xnQixNQUFPLGVBU1BoQixJQUFLLG1CQUNMZ0IsTUFBTyxTSXhGUUssR0FDaEIsTUFBT2xCLE1BQUttQixNQUFNQyxpQkFBaUJGLE1Ka0dsQ3JCLElBQUssZUFDTGdCLE1BQU8sU0kzRklRLEdBQ1osTUFBT3JCLE1BQUttQixNQUFNRyxhQUFhRCxNSm9HOUJ4QixJQUFLLFlBQ0xnQixNQUFPLFNJOUZDVSxPSnNHUjFCLElBQUssWUFDTGdCLE1BQU8sV0loR1IsT0FDRVcsZ0JBQWlCLFlKMEdsQjNCLElBQUssT0FDTGdCLE1BQU8sU0lwR0pZLEdBQ0osR0FBSTNDLEdBQVdrQixJQXFEZixPQXBEQXlCLElBQ0UsUUFDQSxRQUNBLFdBQ0EsUUFDQSxVQUNBLGNBQ0EsZUFDQSxnQkFDQSxnQkFDQSxzQkFDQSx1QkFDQSxhQUNBLGdCQUNBLFNBQ01DLEVBQ0FDLEVBQ0FDLEVBQ0FULEVBQ0FVLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBQ0p0RCxFQUFTNEMsTUFBUUEsRUFDakI1QyxFQUFTNkMsTUFBUUEsRUFDakI3QyxFQUFTOEMsU0FBV0EsRUFDcEI5QyxFQUFTcUMsTUFBUUEsRUFDakJyQyxFQUFTK0MsUUFBVUEsRUFDbkIvQyxFQUFTZ0QsWUFBY0EsRUFDdkJoRCxFQUFTa0QsY0FBZ0JBLEVBQ3pCbEQsRUFBU2lELGFBQWVBLEVBQ3hCakQsRUFBU21ELGNBQWdCQSxFQUN6Qm5ELEVBQVNvRCxvQkFBc0JBLEVBQy9CcEQsRUFBU3FELHFCQUF1QkEsRUFDaENyRCxFQUFTc0QsV0FBYUEsS0FHMUJwQyxLQUFLbUMscUJBQXVCckQsRUFBU3FELHFCQUNyQ25DLEtBQUtrQyxvQkFBc0JwRCxFQUFTb0Qsb0JBQ3BDbEMsS0FBS0MsUUFBVW5CLEVBQVNvRCxvQkFBb0JHLE1BQU0sOEJBQ2xEckMsS0FBS0UsTUFBUXBCLEVBQVNvRCxvQkFBb0JHLE1BQU0sNEJBQ2hEckMsS0FBS0csYUFBZXJCLEVBQVNvRCxvQkFBb0JHLE1BQU0sK0JBQ3ZEckMsS0FBS0ksV0FBYXRCLEVBQVNvRCxvQkFBb0JHLE1BQU0sNkJBQ3JEckMsS0FBS3NDLFlBQ0x0QyxLQUFLdUMsZUFDTHZDLEtBQUtzQyxTQUFTRSxLQUFLeEMsS0FBS3lDLGlCQUdqQnpDLFFKNEVOSCxJQUFLLGdCQUNMZ0IsTUFBTyxXSXpFUixHQUFJNkIsR0FFRkMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFMQUMsRUFBT2hELElBc0lULE9BL0hBZ0QsR0FBS0MsWUFDTEQsRUFBS0UsVUFFTEosRUFBb0IsR0FBSUssTUFBS25ELEtBQUtDLFNBQVNtRCxxQkFFM0NMLEVBQWtCLEdBQUlJLE1BQUtuRCxLQUFLRSxPQUFPa0QscUJBRXZDVixFQUFVLEdBQUkxQyxNQUFLTyxtQkFDakI4QyxNQUFPckQsS0FBSzRCLFNBQVN5QixNQUNyQmxDLE1BQU9uQixLQUFLbUIsTUFDWmlCLFdBQVlwQyxLQUFLb0MsV0FDakJrQixlQUFnQnRELEtBQUs0QixTQUFTMkIsWUFHaENiLEVBQVFjLFdBQ05DLEtBQU0sT0FDTkMsZ0JBQWlCLElBR25CYixFQUFRLEdBQUk3QyxNQUFLSyxRQUFRRyxnQkFDdkI2QyxNQUFPckQsS0FBSzRCLFNBQVN5QixNQUNyQmxDLE1BQU9uQixLQUFLbUIsTUFDWmlCLFdBQVlwQyxLQUFLb0MsV0FDakJrQixlQUFnQnRELEtBQUs0QixTQUFTMkIsWUFHaENWLEVBQU1XLFdBQ0pDLEtBQU0sT0FDTkMsZ0JBQWlCLElBR25CZixFQUFnQixHQUFJM0MsTUFBS0ssUUFBUXNELE1BQU0sU0FDckN2QixXQUFZcEMsS0FBS29DLFdBQ2pCaUIsTUFBT3JELEtBQUs0QixTQUFTeUIsUUFFckJPLE1BQ0VDLE9BQ0VDLFlBQWEsS0FDYkMsV0FBYyxnQkFLcEJmLEVBQUtDLFNBQVcsR0FBSWpELE1BQUtLLFFBQVEyRCxvQkFDL0JDLE1BQU8sSUFDUEMsT0FBUSxLQUVSYixNQUFPckQsS0FBSzRCLFNBQVN5QixNQUNyQmxDLE1BQU9uQixLQUFLbUIsTUFDWmlCLFdBQVlwQyxLQUFLb0MsV0FDakJrQixlQUFnQnRELEtBQUs0QixTQUFTMkIsWUFFOUJZLFlBQWEsRUFDYkMsT0FBUSx3QkFDUkMsa0JBQW1CLEVBQ25CQyxjQUNFQyxTQUFVLElBRVpDLE1BQU8xQixJQUdURixFQUFjLEdBQUk1QyxNQUFLSyxRQUFRc0QsTUFBTSxPQUNuQ3ZCLFdBQVlwQyxLQUFLb0MsV0FDakJpQixNQUFPckQsS0FBSzRCLFNBQVN5QixRQUVyQk8sTUFDRUMsT0FDRUMsWUFBYSxLQUNiQyxXQUFjLGdCQUtwQmYsRUFBS0UsT0FBUyxHQUFJbEQsTUFBS0ssUUFBUTJELG9CQUM3QkMsTUFBTyxJQUNQQyxPQUFRLEtBRVJiLE1BQU9yRCxLQUFLNEIsU0FBU3lCLE1BQ3JCbEMsTUFBT25CLEtBQUttQixNQUNaaUIsV0FBWXBDLEtBQUtvQyxXQUNqQmtCLGVBQWdCdEQsS0FBSzRCLFNBQVMyQixZQUU5QlksWUFBYSxFQUNiQyxPQUFRLHdCQUNSQyxrQkFBbUIsRUFDbkJDLGNBQ0VDLFNBQVUsSUFFWkMsTUFBT3pCLElBR1RDLEVBQUtDLFNBQVN3QixxQkFDWkMsT0FDRUMsR0FBSTNCLEVBQUtDLFNBQVMyQixNQUVwQkMsV0FBWSxXQUNWN0IsRUFBS0MsU0FBUzZCLE9BQ2Q5QixFQUFLaEMsVUFBWWdDLEVBQUtDLFNBQVM4QixVQUMvQkMsUUFBUUMsSUFBSWpDLEVBQUtDLFNBQVM4QixjQUk5Qi9CLEVBQUtFLE9BQU91QixxQkFDVkMsT0FDRUMsR0FBSTNCLEVBQUtFLE9BQU8wQixNQUVsQkMsV0FBWSxXQUNWN0IsRUFBS0UsT0FBTzRCLE9BQ1pFLFFBQVFDLElBQUlqQyxFQUFLRSxPQUFPNkIsV0FDeEIvQixFQUFLL0IsUUFBVStCLEVBQUtFLE9BQU82QixhQUkvQi9FLEtBQUtTLFlBQVlsQyxTQUFTLGNBQWUsU0FBVTJHLEVBQUdDLEVBQUdDLEVBQUtDLEVBQUdDLEVBQUdDLEVBQU1DLEdBQ3hFLEdBQUlDLEdBQUtQLEVBQUlHLEVBQUksRUFBSUUsRUFBTyxFQUMxQkcsRUFBS1IsRUFBSUcsRUFBSSxFQUFJRSxFQUFPLEVBQ3hCSSxFQUFLUixFQUFJRyxFQUFJLEVBQUlFLEVBQU8sRUFDeEJJLEVBQUtULEVBQUlHLEVBQUksRUFBSUUsRUFBTyxDQUUxQixRQUFRLElBQUtDLEVBQUlFLEVBQUksSUFBS0QsRUFBSUMsRUFBSSxJQUFLRCxFQUFJRSxFQUFJLElBQUtILEVBQUlHLEVBQUksT0FHOUQvQyxFQUFNZ0QsVUFBVWxELEdBQ2hCRSxFQUFNZ0QsVUFBVTdDLEVBQUtDLFVBQ3JCSixFQUFNZ0QsVUFBVWpELEdBQ2hCQyxFQUFNZ0QsVUFBVTdDLEVBQUtFLFFBQ3JCUixFQUFRb0QsYUFBYWpELEdBQ2RILEtKNkVON0MsSUFBSyxrQkFDTGdCLE1BQU8sU0kzRU9rRixFQUFnQkMsR0FDL0JELEdBQWtCLENBQ2xCLElBQUlFLEdBR0Y1RyxFQUNBNkcsRUFIQWpDLEVBQVEsRUFDUkMsRUFBUyxDQUlYLEtBQUs3RSxFQUFJLEVBQUc2RyxFQUFLbEcsS0FBS3NDLFNBQVNoRCxPQUFRRCxFQUFJNkcsRUFBSTdHLElBQzdDNEcsRUFBZWpHLEtBQUtzQyxTQUFTakQsR0FBRzhHLGtCQUNoQ2xDLEVBQVFtQyxLQUFLQyxJQUFJSixFQUFhaEMsTUFBT0EsR0FDckNDLEdBQVUrQixFQUFhL0IsT0FDdkJsRSxLQUFLc0MsU0FBU2pELEdBQUc0RSxNQUFRZ0MsRUFBYWhDLE1BQ3RDakUsS0FBS3NDLFNBQVNqRCxHQUFHNkUsT0FBUytCLEVBQWEvQixNQUd6QyxPQURBQSxJQUFVbEUsS0FBS3NHLFNBRWJyQyxNQUFPQSxFQUFROEIsRUFBaUIsRUFBSTlCLEVBQ3BDQyxPQUFRQSxFQUFTOEIsRUFBa0IsRUFBSTlCLE1KK0V4Q3JFLElBQUssZ0JBQ0xnQixNQUFPLFdJM0VSLEdBQUltQyxHQUFPaEQsSUFDWGdELEdBQUtzRCxRQUFVLEVBQ2Z0RCxFQUFLYixxQkFBcUJvRSxNQUN4QkMsS0FBTSxXQUNKLE1BQU8sY0FFVEMsSUFBSyxTQUFVbkosR0FDYixNQUFPQSxHQUFJLElBRWIwRixLQUFNLFdBQ0osTUFBT0EsSUFFVDBELFNBQVUsV0FDUixNQUFPLElBRVRDLE9BQVEsU0FBVXJKLEdBQ2hCLE1BQU9BLEdBQUlzSixRQUViQyxjQUNFQyxLQUFNLFNBQVV4SixHQUNkLE1BQU9BLEdBQUl5SixZQUViQyxXQUNFRixLQUFNLFNBQVV4SixHQUNkLE1BQU9BLEdBQUkySixLQUViQyxZQUNFSixLQUFNLFNBQVV4SixHQUNkLE1BQU9BLEdBQUk2SixNQUViQyxZQUFhLFdBQ1gsR0FBSUMsR0FBU3JILEtBQUtzSCx5QkFDbEIsT0FBT3RFLEdBQUttRCxnQkFBZ0JrQixFQUFPRSxXQUFZRixFQUFPRywyQkpvRi9EM0gsSUFBSywwQkFDTGdCLE1BQU8sU0k3RWVxRSxFQUFHQyxFQUFHbEIsRUFBT0MsRUFBUXJCLEdBQzVDLEdBQUk0RSxHQUFNekgsS0FBS3VDLFdBUWYsT0FQQWtGLEdBQUl2QyxFQUFJQSxFQUNSdUMsRUFBSXRDLEVBQUlBLEVBQ1JzQyxFQUFJeEQsTUFBUUEsRUFDWndELEVBQUl2RCxPQUFTQSxFQUVibEUsS0FBSzBILFlBQWM3RSxFQUVaN0MsUUpnRk5ILElBQUssT0FDTGdCLE1BQU8sU0k5RUpxRSxFQUFHQyxFQUFHbEIsRUFBT0MsRUFBUXJCLEdBQ3pCLEdBRUVxRCxHQUNBN0csRUFDQXFELEVBSkVILEVBQWN2QyxLQUFLdUMsWUFDckJELEVBQVd0QyxLQUFLc0MsU0FJaEJELEVBQVFyQyxLQUFLa0Msb0JBQ2JjLEVBQU9oRCxJQU9ULElBTkFnRixRQUFRQyxJQUFJNUMsR0FDWjZDLEVBQVVoSCxTQUFOZ0gsRUFBa0IzQyxFQUFZMkMsRUFBSUEsRUFDdENDLEVBQVVqSCxTQUFOaUgsRUFBa0I1QyxFQUFZNEMsRUFBSUEsRUFDdENsQixFQUFrQi9GLFNBQVYrRixFQUFzQjFCLEVBQVkwQixNQUFRQSxFQUNsREMsRUFBb0JoRyxTQUFYZ0csRUFBdUIzQixFQUFZMkIsT0FBU0EsRUFDckRyQixFQUFrQjNFLFNBQVYyRSxFQUFzQjdDLEtBQUswSCxZQUFjN0UsRUFDN0NvQixHQUFTQyxFQUNYLElBQUs3RSxFQUFJLEVBQUc2RyxFQUFLNUQsRUFBU2hELE9BQVFELEVBQUk2RyxFQUFJN0csSUFDeENxRCxFQUFVSixFQUFTakQsR0FDbkJxRCxFQUFRaUYsS0FBS3pDLEVBQUdDLEVBSXBCOUMsR0FBTXVGLGVBQWUsNkJBQThCLDRCQUE2QixTQUFVQyxFQUFPQyxHQUMvRjlFLEVBQUtDLFNBQVM2QixLQUFLLEdBQUkzQixNQUFLMEUsRUFBTSxJQUFJekUsc0JBQ3RDSixFQUFLRSxPQUFPNEIsS0FBSyxHQUFJM0IsTUFBSzJFLEVBQUksSUFBSTFFLDJCSmtGbkN2RCxJQUFLLFlBQ0xrSSxJQUFLLFdJcmNOLE1BQU8vSCxNQUFLQyxTSndjWCtILElBQUssU0lyY08vSCxHQUNiLEdBQUlnSSxJQUFrQixHQUFJOUUsTUFBS2xELEVBQzNCZ0ksSUFBa0JqSSxLQUFLRSxRQUN6QkYsS0FBS0MsUUFBVWdJLEVBQ2ZqSSxLQUFLa0Msb0JBQW9CRyxNQUFNLDhCQUFnQ3JDLEtBQUtDLFlKeWNyRUosSUFBSyxVQUNMa0ksSUFBSyxXSXJjTixNQUFPL0gsTUFBS0UsT0p3Y1g4SCxJQUFLLFNJcmNLOUgsR0FDWCxHQUFJZ0ksSUFBZ0IsR0FBSS9FLE1BQUtqRCxFQUN6QmdJLElBQWdCbEksS0FBS0MsVUFDdkJELEtBQUtFLE1BQVFnSSxFQUNibEksS0FBS2tDLG9CQUFvQkcsTUFBTSw0QkFBOEJyQyxLQUFLRSxXSjBjOUR6QyxJSXRHWSxvQkFBWGIsSUFBb0QsbUJBQW5CQSxHQUFPRCxRQUNqREMsRUFBT0QsUUFBVWMsRUFFakJDLE9BQU95SyxlQUFpQjFLIiwiZmlsZSI6ImZjdHMtZXh0LWRhdGVyYW5nZS1lczUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24obW9kdWxlKSB7J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXHRcblx0dmFyIERhdGVSYW5nZSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR3aW5kb3cuZHIgPSBuZXcgRGF0ZVJhbmdlKCk7XG5cdFxuXHQ7KGZ1bmN0aW9uIChlbnYsIGZhY3RvcnkpIHtcblx0ICBpZiAoKCBmYWxzZSA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihtb2R1bGUpKSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZW52LmRvY3VtZW50ID8gZmFjdG9yeShlbnYpIDogZnVuY3Rpb24gKHdpbikge1xuXHQgICAgICBpZiAoIXdpbi5kb2N1bWVudCkge1xuXHQgICAgICAgIHRocm93IG5ldyBFcnJvcignV2luZG93IHdpdGggZG9jdW1lbnQgbm90IHByZXNlbnQnKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZmFjdG9yeSh3aW4sIHRydWUpO1xuXHQgICAgfTtcblx0ICB9IGVsc2Uge1xuXHQgICAgZW52LkRhdGVSYW5nZUNob29zZXIgPSBmYWN0b3J5KGVudiwgdHJ1ZSk7XG5cdCAgfVxuXHR9KSh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHVuZGVmaW5lZCwgZnVuY3Rpb24gKF93aW5kb3csIHdpbmRvd0V4aXN0cykge1xuXHQgIHZhciBGQyA9IF93aW5kb3cuRnVzaW9uQ2hhcnRzO1xuXHQgIEZDLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ3ByaXZhdGUnLCAnRGF0ZVJhbmdlQ2hvb3NlcicsIGZ1bmN0aW9uICgpIHtcblx0ICAgIEZDLnJlZ2lzdGVyQ29tcG9uZW50KCdleHRlbnNpb25zJywgJ0RhdGVSYW5nZUNob29zZXInLCBEYXRlUmFuZ2UpO1xuXHQgIH1dKTtcblx0fSk7XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpKG1vZHVsZSkpKVxuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHtcblx0XHRpZighbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xuXHRcdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XG5cdFx0XHRtb2R1bGUucGF0aHMgPSBbXTtcblx0XHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxuXHRcdFx0bW9kdWxlLmNoaWxkcmVuID0gW107XG5cdFx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcblx0XHR9XG5cdFx0cmV0dXJuIG1vZHVsZTtcblx0fVxuXG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdC8qKlxuXHQgKiBDbGFzcyByZXByZXNlbnRpbmcgdGhlIERhdGVSYW5nZS5cblx0ICovXG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBEYXRlUmFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gRGF0ZVJhbmdlKCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGVSYW5nZSk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICB0aGlzLnN0YXJ0RHQgPSAwO1xuXHQgICAgdGhpcy5lbmREdCA9IDA7XG5cdCAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IDA7XG5cdCAgICB0aGlzLmVuZERhdGFzZXQgPSAwO1xuXHQgICAgdGhpcy50b29sYm94ID0gRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCgnYXBpJywgJ3Rvb2xib3gnKTtcblx0ICAgIHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIgPSB0aGlzLnRvb2xib3guSG9yaXpvbnRhbFRvb2xiYXI7XG5cdCAgICB0aGlzLkNvbXBvbmVudEdyb3VwID0gdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwO1xuXHQgICAgdGhpcy5TeW1ib2xTdG9yZSA9IHRoaXMudG9vbGJveC5TeW1ib2xTdG9yZTtcblx0ICAgIHRoaXMuc3RhcnRUZXh0ID0ge1xuXHQgICAgICBhdHRyOiBmdW5jdGlvbiBhdHRyKCkge31cblx0ICAgIH07XG5cdCAgICB0aGlzLmVuZFRleHQgPSB7XG5cdCAgICAgIGF0dHI6IGZ1bmN0aW9uIGF0dHIoKSB7fVxuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIEFuIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHN0YXJ0IGFuZCBlbmQgZGF0ZXMuXG5cdCAgICogQHR5cGUge0RhdGVSYW5nZS5yYW5nZX1cblx0ICAgKi9cblx0XG5cdFxuXHQgIF9jcmVhdGVDbGFzcyhEYXRlUmFuZ2UsIFt7XG5cdCAgICBrZXk6ICdzd2FwRGF0ZXMnLFxuXHRcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFN3YXBzIHRoZSBzdGFydCBkYXRlIGFuZCB0aGUgZW5kIGRhdGUgb2YgdGhlIGRhdGUgcmFuZ2Vcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzd2FwRGF0ZXMoKSB7XG5cdCAgICAgIHZhciB0ZW1wID0gdGhpcy5kYXRlUmFuZ2Uuc3RhcnREYXRlO1xuXHQgICAgICB0aGlzLmRhdGVSYW5nZS5zdGFydERhdGUgPSB0aGlzLmRhdGVSYW5nZS5lbmREYXRlO1xuXHQgICAgICB0aGlzLmRhdGVSYW5nZS5lbmREYXRlID0gdGVtcDtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFN5bmNzIHRoZSBkYXRlcmFuZ2Ugc2hvd24gYnkgdGhlIEZ1c2lvbkNoYXJ0cyB0aW1lIHNlcmllcyBjaGFydCBhbmQgdGhlIERhdGUgUmFuZ2UgQ2hvb3NlclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdzeW5jUmFuZ2UnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHN5bmNSYW5nZSgpIHt9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm5zIGEgZm9ybWF0dGVkIGRhdGUgc3RyaW5nIGZyb20gRnVzaW9uQ2hhcnRzIHdoZW4gZ2l2ZW4gYSBVTklYIHRpbWVzdGFtcFxuXHQgICAgICogQHBhcmFtICB7bnVtYmVyfSB0aW1lc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIGNvbnZlcnRlZCB0byBhIGRhdGUgc3RyaW5nXG5cdCAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IC0gQSBkYXRlIHN0cmluZyB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiB0aW1lc3RhbXBcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdnZXRGb3JtYXR0ZWREYXRlJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGb3JtYXR0ZWREYXRlKHRpbWVzdGFtcCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5jaGFydC5nZXRGb3JtYXR0ZWREYXRlKHRpbWVzdGFtcCk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm5zIGEgVU5JWCB0aW1lc3RhbXAgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZ1xuXHQgICAgICogQHBhcmFtICB7c3RyaW5nfSBkYXRlU3RyaW5nIC0gQSBkYXRlIHN0cmluZyB0byBiZSBjb252ZXJ0ZWQgdG8gYSBVTklYIHRpbWVzdGFtcFxuXHQgICAgICogQHJldHVybiB7bnVtYmVyfSBBIFVOSVggdGltZXN0YW1wIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIGRhdGUgc3RyaW5nXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZ2V0VGltZXN0YW1wJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoZGF0ZVN0cmluZykge1xuXHQgICAgICByZXR1cm4gdGhpcy5jaGFydC5nZXRUaW1lc3RhbXAoZGF0ZVN0cmluZyk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXRzIHRoZSBjb25maWd1cmFibGUgb3B0aW9ucyBvZiB0aGUgZXh0ZW5zaW9uIChlLmcuIGNvc21ldGljcylcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3NldENvbmZpZycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q29uZmlnKGNvbmZpZ09iaikge31cblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuXHQgICAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2dldENvbmZpZycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29uZmlnKCkge1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGNhbGVuZGFyVmlzaWJsZTogJ2ZhbHNlJ1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRnVzaW9uY2hhcnRzIGxpZmUgY3ljbGUgbWV0aG9kIGZvciBleHRlbnNpb25cblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdpbml0Jyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KHJlcXVpcmUpIHtcblx0ICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcblx0ICAgICAgcmVxdWlyZShbJ3hBeGlzJywgJ3lBeGlzJywgJ2dyYXBoaWNzJywgJ2NoYXJ0JywgJ2RhdGFzZXQnLCAnUGxvdE1hbmFnZXInLCAnY2FudmFzQ29uZmlnJywgJ01hcmtlck1hbmFnZXInLCAncmVhY3RpdmVNb2RlbCcsICdnbG9iYWxSZWFjdGl2ZU1vZGVsJywgJ3NwYWNlTWFuYWdlckluc3RhbmNlJywgJ3NtYXJ0TGFiZWwnLCAnY2hhcnRJbnN0YW5jZScsIGZ1bmN0aW9uICh4QXhpcywgeUF4aXMsIGdyYXBoaWNzLCBjaGFydCwgZGF0YXNldCwgcGxvdE1hbmFnZXIsIGNhbnZhc0NvbmZpZywgbWFya2VyTWFuYWdlciwgcmVhY3RpdmVNb2RlbCwgZ2xvYmFsUmVhY3RpdmVNb2RlbCwgc3BhY2VNYW5hZ2VySW5zdGFuY2UsIHNtYXJ0TGFiZWwpIHtcblx0ICAgICAgICBpbnN0YW5jZS54QXhpcyA9IHhBeGlzO1xuXHQgICAgICAgIGluc3RhbmNlLnlBeGlzID0geUF4aXM7XG5cdCAgICAgICAgaW5zdGFuY2UuZ3JhcGhpY3MgPSBncmFwaGljcztcblx0ICAgICAgICBpbnN0YW5jZS5jaGFydCA9IGNoYXJ0O1xuXHQgICAgICAgIGluc3RhbmNlLmRhdGFzZXQgPSBkYXRhc2V0O1xuXHQgICAgICAgIGluc3RhbmNlLnBsb3RNYW5hZ2VyID0gcGxvdE1hbmFnZXI7XG5cdCAgICAgICAgaW5zdGFuY2UubWFya2VyTWFuYWdlciA9IG1hcmtlck1hbmFnZXI7XG5cdCAgICAgICAgaW5zdGFuY2UuY2FudmFzQ29uZmlnID0gY2FudmFzQ29uZmlnO1xuXHQgICAgICAgIGluc3RhbmNlLnJlYWN0aXZlTW9kZWwgPSByZWFjdGl2ZU1vZGVsO1xuXHQgICAgICAgIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBnbG9iYWxSZWFjdGl2ZU1vZGVsO1xuXHQgICAgICAgIGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlID0gc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG5cdCAgICAgICAgaW5zdGFuY2Uuc21hcnRMYWJlbCA9IHNtYXJ0TGFiZWw7XG5cdCAgICAgIH1dKTtcblx0ICAgICAgdGhpcy5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlO1xuXHQgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuXHQgICAgICB0aGlzLnN0YXJ0RHQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddO1xuXHQgICAgICB0aGlzLmVuZER0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLXN0YXJ0J107XG5cdCAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcblx0ICAgICAgdGhpcy50b29sYmFycyA9IFtdO1xuXHQgICAgICB0aGlzLm1lYXN1cmVtZW50ID0ge307XG5cdCAgICAgIHRoaXMudG9vbGJhcnMucHVzaCh0aGlzLmNyZWF0ZVRvb2xiYXIoKSk7XG5cdCAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcblx0ICAgICAgLy8gY29uc29sZS5sb2codGhpcy5kYXRlU3RhcnQsIHRoaXMuZGF0ZUVuZCk7XG5cdCAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2NyZWF0ZVRvb2xiYXInLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVRvb2xiYXIoKSB7XG5cdCAgICAgIHZhciB0b29sYmFyLFxuXHQgICAgICAgICAgc2VsZiA9IHRoaXMsXG5cdCAgICAgICAgICBmcm9tRGF0ZUxhYmVsLFxuXHQgICAgICAgICAgdG9EYXRlTGFiZWwsXG5cdCAgICAgICAgICBncm91cCxcblx0ICAgICAgICAgIGZyb21Gb3JtYXR0ZWREYXRlLFxuXHQgICAgICAgICAgdG9Gb3JtYXR0ZWREYXRlO1xuXHRcblx0ICAgICAgc2VsZi5mcm9tRGF0ZSA9IHt9O1xuXHQgICAgICBzZWxmLnRvRGF0ZSA9IHt9O1xuXHRcblx0ICAgICAgZnJvbUZvcm1hdHRlZERhdGUgPSBuZXcgRGF0ZSh0aGlzLnN0YXJ0RHQpLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xuXHRcblx0ICAgICAgdG9Gb3JtYXR0ZWREYXRlID0gbmV3IERhdGUodGhpcy5lbmREdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG5cdFxuXHQgICAgICB0b29sYmFyID0gbmV3IHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIoe1xuXHQgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHQgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICB0b29sYmFyLnNldENvbmZpZyh7XG5cdCAgICAgICAgZmlsbDogJyNmZmYnLFxuXHQgICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGdyb3VwID0gbmV3IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cCh7XG5cdCAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG5cdCAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGdyb3VwLnNldENvbmZpZyh7XG5cdCAgICAgICAgZmlsbDogJyNmZmYnLFxuXHQgICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGZyb21EYXRlTGFiZWwgPSBuZXcgdGhpcy50b29sYm94LkxhYmVsKCdGcm9tOicsIHtcblx0ICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXJcblx0ICAgICAgfSwge1xuXHQgICAgICAgIHRleHQ6IHtcblx0ICAgICAgICAgIHN0eWxlOiB7XG5cdCAgICAgICAgICAgICdmb250LXNpemUnOiAnMTUnLFxuXHQgICAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHNlbGYuZnJvbURhdGUgPSBuZXcgdGhpcy50b29sYm94LklucHV0VGV4dEJveFN5bWJvbCh7XG5cdCAgICAgICAgd2lkdGg6IDEyMCxcblx0ICAgICAgICBoZWlnaHQ6IDI1XG5cdCAgICAgIH0sIHtcblx0ICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcblx0ICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcblx0ICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG5cdCAgICAgIH0sIHtcblx0ICAgICAgICBzdHJva2VXaWR0aDogMSxcblx0ICAgICAgICBzdHJva2U6ICdyZ2JhKDEwMiwxMDIsMTAyLDAuNSknLFxuXHQgICAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAwLFxuXHQgICAgICAgIGJ0blRleHRTdHlsZToge1xuXHQgICAgICAgICAgZm9udFNpemU6IDE0XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBsYWJlbDogZnJvbUZvcm1hdHRlZERhdGVcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICB0b0RhdGVMYWJlbCA9IG5ldyB0aGlzLnRvb2xib3guTGFiZWwoJ1RvOicsIHtcblx0ICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXJcblx0ICAgICAgfSwge1xuXHQgICAgICAgIHRleHQ6IHtcblx0ICAgICAgICAgIHN0eWxlOiB7XG5cdCAgICAgICAgICAgICdmb250LXNpemUnOiAnMTUnLFxuXHQgICAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHNlbGYudG9EYXRlID0gbmV3IHRoaXMudG9vbGJveC5JbnB1dFRleHRCb3hTeW1ib2woe1xuXHQgICAgICAgIHdpZHRoOiAxMjAsXG5cdCAgICAgICAgaGVpZ2h0OiAyNVxuXHQgICAgICB9LCB7XG5cdCAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG5cdCAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICB9LCB7XG5cdCAgICAgICAgc3Ryb2tlV2lkdGg6IDEsXG5cdCAgICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcblx0ICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogMCxcblx0ICAgICAgICBidG5UZXh0U3R5bGU6IHtcblx0ICAgICAgICAgIGZvbnRTaXplOiAxNFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgbGFiZWw6IHRvRm9ybWF0dGVkRGF0ZVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHNlbGYuZnJvbURhdGUuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG5cdCAgICAgICAgY2xpY2s6IHtcblx0ICAgICAgICAgIGZuOiBzZWxmLmZyb21EYXRlLmVkaXRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHRleHRPbkJsdXI6IGZ1bmN0aW9uIHRleHRPbkJsdXIoKSB7XG5cdCAgICAgICAgICBzZWxmLmZyb21EYXRlLmJsdXIoKTtcblx0ICAgICAgICAgIHNlbGYuc3RhcnREYXRlID0gc2VsZi5mcm9tRGF0ZS5nZXRUZXh0KCk7XG5cdCAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmZyb21EYXRlLmdldFRleHQoKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHNlbGYudG9EYXRlLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuXHQgICAgICAgIGNsaWNrOiB7XG5cdCAgICAgICAgICBmbjogc2VsZi50b0RhdGUuZWRpdFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgdGV4dE9uQmx1cjogZnVuY3Rpb24gdGV4dE9uQmx1cigpIHtcblx0ICAgICAgICAgIHNlbGYudG9EYXRlLmJsdXIoKTtcblx0ICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYudG9EYXRlLmdldFRleHQoKSk7XG5cdCAgICAgICAgICBzZWxmLmVuZERhdGUgPSBzZWxmLnRvRGF0ZS5nZXRUZXh0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHRoaXMuU3ltYm9sU3RvcmUucmVnaXN0ZXIoJ3RleHRCb3hJY29uJywgZnVuY3Rpb24gKHgsIHksIHJhZCwgdywgaCwgcGFkWCwgcGFkWSkge1xuXHQgICAgICAgIHZhciB4MSA9IHggLSB3IC8gMiArIHBhZFggLyAyLFxuXHQgICAgICAgICAgICB4MiA9IHggKyB3IC8gMiAtIHBhZFggLyAyLFxuXHQgICAgICAgICAgICB5MSA9IHkgLSBoIC8gMiArIHBhZFkgLyAyLFxuXHQgICAgICAgICAgICB5MiA9IHkgKyBoIC8gMiAtIHBhZFkgLyAyO1xuXHRcblx0ICAgICAgICByZXR1cm4gWydNJywgeDEsIHkxLCAnTCcsIHgyLCB5MSwgJ0wnLCB4MiwgeTIsICdMJywgeDEsIHkyLCAnWiddO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGdyb3VwLmFkZFN5bWJvbChmcm9tRGF0ZUxhYmVsKTtcblx0ICAgICAgZ3JvdXAuYWRkU3ltYm9sKHNlbGYuZnJvbURhdGUpO1xuXHQgICAgICBncm91cC5hZGRTeW1ib2wodG9EYXRlTGFiZWwpO1xuXHQgICAgICBncm91cC5hZGRTeW1ib2woc2VsZi50b0RhdGUpO1xuXHQgICAgICB0b29sYmFyLmFkZENvbXBvbmVudChncm91cCk7XG5cdCAgICAgIHJldHVybiB0b29sYmFyO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2dldExvZ2ljYWxTcGFjZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TG9naWNhbFNwYWNlKGF2YWlsYWJsZVdpZHRoLCBhdmFpbGFibGVIZWlnaHQpIHtcblx0ICAgICAgYXZhaWxhYmxlV2lkdGggLz0gMjtcblx0ICAgICAgdmFyIGxvZ2ljYWxTcGFjZSxcblx0ICAgICAgICAgIHdpZHRoID0gMCxcblx0ICAgICAgICAgIGhlaWdodCA9IDAsXG5cdCAgICAgICAgICBpLFxuXHQgICAgICAgICAgbG47XG5cdFxuXHQgICAgICBmb3IgKGkgPSAwLCBsbiA9IHRoaXMudG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuXHQgICAgICAgIGxvZ2ljYWxTcGFjZSA9IHRoaXMudG9vbGJhcnNbaV0uZ2V0TG9naWNhbFNwYWNlKCk7XG5cdCAgICAgICAgd2lkdGggPSBNYXRoLm1heChsb2dpY2FsU3BhY2Uud2lkdGgsIHdpZHRoKTtcblx0ICAgICAgICBoZWlnaHQgKz0gbG9naWNhbFNwYWNlLmhlaWdodDtcblx0ICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLndpZHRoID0gbG9naWNhbFNwYWNlLndpZHRoO1xuXHQgICAgICAgIHRoaXMudG9vbGJhcnNbaV0uaGVpZ2h0ID0gbG9naWNhbFNwYWNlLmhlaWdodDtcblx0ICAgICAgfVxuXHQgICAgICBoZWlnaHQgKz0gdGhpcy5wYWRkaW5nO1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIHdpZHRoOiB3aWR0aCA+IGF2YWlsYWJsZVdpZHRoID8gMCA6IHdpZHRoLFxuXHQgICAgICAgIGhlaWdodDogaGVpZ2h0ID4gYXZhaWxhYmxlSGVpZ2h0ID8gMCA6IGhlaWdodFxuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3BsYWNlSW5DYW52YXMnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYWNlSW5DYW52YXMoKSB7XG5cdCAgICAgIHZhciBfc2VsZiA9IHRoaXM7XG5cdCAgICAgIF9zZWxmLnBhZGRpbmcgPSA1O1xuXHQgICAgICBfc2VsZi5zcGFjZU1hbmFnZXJJbnN0YW5jZS5hZGQoW3tcblx0ICAgICAgICBuYW1lOiBmdW5jdGlvbiBuYW1lKCkge1xuXHQgICAgICAgICAgcmV0dXJuICdUb29sQm94RXh0Jztcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHJlZjogZnVuY3Rpb24gcmVmKG9iaikge1xuXHQgICAgICAgICAgcmV0dXJuIG9ialsnMCddO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgc2VsZjogZnVuY3Rpb24gc2VsZigpIHtcblx0ICAgICAgICAgIHJldHVybiBfc2VsZjtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHByaW9yaXR5OiBmdW5jdGlvbiBwcmlvcml0eSgpIHtcblx0ICAgICAgICAgIHJldHVybiAyO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgbGF5b3V0OiBmdW5jdGlvbiBsYXlvdXQob2JqKSB7XG5cdCAgICAgICAgICByZXR1cm4gb2JqLmlubGluZTtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIG9yaWVudGF0aW9uOiBbe1xuXHQgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG9iai5ob3Jpem9udGFsO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIHBvc2l0aW9uOiBbe1xuXHQgICAgICAgICAgICB0eXBlOiBmdW5jdGlvbiB0eXBlKG9iaikge1xuXHQgICAgICAgICAgICAgIHJldHVybiBvYmoudG9wO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBhbGlnbm1lbnQ6IFt7XG5cdCAgICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiBvYmoubGVmdDtcblx0ICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgIGRpbWVuc2lvbnM6IFtmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnRDb21wb25lbnRHcm91cCgpO1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIF9zZWxmLmdldExvZ2ljYWxTcGFjZShwYXJlbnQuZ2V0V2lkdGgoKSwgcGFyZW50LmdldEhlaWdodCgpKTtcblx0ICAgICAgICAgICAgICB9XVxuXHQgICAgICAgICAgICB9XVxuXHQgICAgICAgICAgfV1cblx0ICAgICAgICB9XVxuXHQgICAgICB9XSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAnc2V0RHJhd2luZ0NvbmZpZ3VyYXRpb24nLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHNldERyYXdpbmdDb25maWd1cmF0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG5cdCAgICAgIHZhciBtZXMgPSB0aGlzLm1lYXN1cmVtZW50O1xuXHQgICAgICBtZXMueCA9IHg7XG5cdCAgICAgIG1lcy55ID0geTtcblx0ICAgICAgbWVzLndpZHRoID0gd2lkdGg7XG5cdCAgICAgIG1lcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdFxuXHQgICAgICB0aGlzLnBhcmVudEdyb3VwID0gZ3JvdXA7XG5cdFxuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6ICdkcmF3Jyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3KHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG5cdCAgICAgIHZhciBtZWFzdXJlbWVudCA9IHRoaXMubWVhc3VyZW1lbnQsXG5cdCAgICAgICAgICB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMsXG5cdCAgICAgICAgICBsbixcblx0ICAgICAgICAgIGksXG5cdCAgICAgICAgICB0b29sYmFyLFxuXHQgICAgICAgICAgbW9kZWwgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwsXG5cdCAgICAgICAgICBzZWxmID0gdGhpcztcblx0ICAgICAgY29uc29sZS5sb2cobW9kZWwpO1xuXHQgICAgICB4ID0geCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQueCA6IHg7XG5cdCAgICAgIHkgPSB5ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC55IDogeTtcblx0ICAgICAgd2lkdGggPSB3aWR0aCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQud2lkdGggOiB3aWR0aDtcblx0ICAgICAgaGVpZ2h0ID0gaGVpZ2h0ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC5oZWlnaHQgOiBoZWlnaHQ7XG5cdCAgICAgIGdyb3VwID0gZ3JvdXAgPT09IHVuZGVmaW5lZCA/IHRoaXMucGFyZW50R3JvdXAgOiBncm91cDtcblx0ICAgICAgaWYgKHdpZHRoICYmIGhlaWdodCkge1xuXHQgICAgICAgIGZvciAoaSA9IDAsIGxuID0gdG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuXHQgICAgICAgICAgdG9vbGJhciA9IHRvb2xiYXJzW2ldO1xuXHQgICAgICAgICAgdG9vbGJhci5kcmF3KHgsIHkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHRcblx0ICAgICAgbW9kZWwub25Qcm9wc0NoYW5nZShbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0JywgJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddLCBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuXHQgICAgICAgIHNlbGYuZnJvbURhdGUuYmx1cihuZXcgRGF0ZShzdGFydFsxXSkudG9Mb2NhbGVEYXRlU3RyaW5nKCkpO1xuXHQgICAgICAgIHNlbGYudG9EYXRlLmJsdXIobmV3IERhdGUoZW5kWzFdKS50b0xvY2FsZURhdGVTdHJpbmcoKSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3N0YXJ0RGF0ZScsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc3RhcnREdDtcblx0ICAgIH0sXG5cdCAgICBzZXQ6IGZ1bmN0aW9uIHNldChzdGFydER0KSB7XG5cdCAgICAgIHZhciBzdGFydFRpbWVzdGFtcCA9ICtuZXcgRGF0ZShzdGFydER0KTtcblx0ICAgICAgaWYgKHN0YXJ0VGltZXN0YW1wIDw9IHRoaXMuZW5kRHQpIHtcblx0ICAgICAgICB0aGlzLnN0YXJ0RHQgPSBzdGFydFRpbWVzdGFtcDtcblx0ICAgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gPSB0aGlzLnN0YXJ0RHQ7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6ICdlbmREYXRlJyxcblx0ICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5lbmREdDtcblx0ICAgIH0sXG5cdCAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmREdCkge1xuXHQgICAgICB2YXIgZW5kVGltZXN0YW1wID0gK25ldyBEYXRlKGVuZER0KTtcblx0ICAgICAgaWYgKGVuZFRpbWVzdGFtcCA+PSB0aGlzLnN0YXJ0RHQpIHtcblx0ICAgICAgICB0aGlzLmVuZER0ID0gZW5kVGltZXN0YW1wO1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZER0O1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfV0pO1xuXHRcblx0ICByZXR1cm4gRGF0ZVJhbmdlO1xuXHR9KCk7XG5cdFxuXHRpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuXHQgIG1vZHVsZS5leHBvcnRzID0gRGF0ZVJhbmdlO1xuXHR9IGVsc2Uge1xuXHQgIHdpbmRvdy5TdGFuZGFyZFBlcmlvZCA9IERhdGVSYW5nZTtcblx0fVxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAyYmNlNWQ3YzNmNmFiNTcxYWZhYSIsIid1c2Ugc3RyaWN0JztcbmNvbnN0IERhdGVSYW5nZSA9IHJlcXVpcmUoJy4vZmN0cy1leHQtZGF0ZXJhbmdlJyk7XG5cbndpbmRvdy5kciA9IG5ldyBEYXRlUmFuZ2UoKTtcblxuOyhmdW5jdGlvbiAoZW52LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZW52LmRvY3VtZW50XG4gICAgICAgPyBmYWN0b3J5KGVudikgOiBmdW5jdGlvbiAod2luKSB7XG4gICAgICAgICBpZiAoIXdpbi5kb2N1bWVudCkge1xuICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dpbmRvdyB3aXRoIGRvY3VtZW50IG5vdCBwcmVzZW50Jyk7XG4gICAgICAgICB9XG4gICAgICAgICByZXR1cm4gZmFjdG9yeSh3aW4sIHRydWUpO1xuICAgICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZW52LkRhdGVSYW5nZUNob29zZXIgPSBmYWN0b3J5KGVudiwgdHJ1ZSk7XG4gIH1cbn0pKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24gKF93aW5kb3csIHdpbmRvd0V4aXN0cykge1xuICB2YXIgRkMgPSBfd2luZG93LkZ1c2lvbkNoYXJ0cztcbiAgRkMucmVnaXN0ZXIoJ2V4dGVuc2lvbicsIFsncHJpdmF0ZScsICdEYXRlUmFuZ2VDaG9vc2VyJywgZnVuY3Rpb24gKCkge1xuICAgIEZDLnJlZ2lzdGVyQ29tcG9uZW50KCdleHRlbnNpb25zJywgJ0RhdGVSYW5nZUNob29zZXInLCBEYXRlUmFuZ2UpO1xuICB9XSk7XG59KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC5qcyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XG5cdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XG5cdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XG5cdFx0bW9kdWxlLnBhdGhzID0gW107XG5cdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XG5cdFx0bW9kdWxlLmNoaWxkcmVuID0gW107XG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XG5cdH1cblx0cmV0dXJuIG1vZHVsZTtcbn1cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vICh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIndXNlIHN0cmljdCc7XG4vKipcbiAqIENsYXNzIHJlcHJlc2VudGluZyB0aGUgRGF0ZVJhbmdlLlxuICovXG5jbGFzcyBEYXRlUmFuZ2Uge1xuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICB0aGlzLnN0YXJ0RHQgPSAwO1xuICAgIHRoaXMuZW5kRHQgPSAwO1xuICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcbiAgICB0aGlzLmVuZERhdGFzZXQgPSAwO1xuICAgIHRoaXMudG9vbGJveCA9IEZ1c2lvbkNoYXJ0cy5nZXRDb21wb25lbnQoJ2FwaScsICd0b29sYm94Jyk7XG4gICAgdGhpcy5Ib3Jpem9udGFsVG9vbGJhciA9IHRoaXMudG9vbGJveC5Ib3Jpem9udGFsVG9vbGJhcjtcbiAgICB0aGlzLkNvbXBvbmVudEdyb3VwID0gdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwO1xuICAgIHRoaXMuU3ltYm9sU3RvcmUgPSB0aGlzLnRvb2xib3guU3ltYm9sU3RvcmU7XG4gICAgdGhpcy5zdGFydFRleHQgPSB7XG4gICAgICBhdHRyOiBmdW5jdGlvbiAoKSB7fVxuICAgIH07XG4gICAgdGhpcy5lbmRUZXh0ID0ge1xuICAgICAgYXR0cjogZnVuY3Rpb24gKCkge31cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEFuIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHN0YXJ0IGFuZCBlbmQgZGF0ZXMuXG4gICAqIEB0eXBlIHtEYXRlUmFuZ2UucmFuZ2V9XG4gICAqL1xuICBnZXQgc3RhcnREYXRlICgpIHtcbiAgICByZXR1cm4gdGhpcy5zdGFydER0O1xuICB9XG5cbiAgc2V0IHN0YXJ0RGF0ZSAoc3RhcnREdCkge1xuICAgIGxldCBzdGFydFRpbWVzdGFtcCA9ICtuZXcgRGF0ZShzdGFydER0KTtcbiAgICBpZiAoc3RhcnRUaW1lc3RhbXAgPD0gdGhpcy5lbmREdCkge1xuICAgICAgdGhpcy5zdGFydER0ID0gc3RhcnRUaW1lc3RhbXA7XG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gPSB0aGlzLnN0YXJ0RHQ7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGVuZERhdGUgKCkge1xuICAgIHJldHVybiB0aGlzLmVuZER0O1xuICB9XG5cbiAgc2V0IGVuZERhdGUgKGVuZER0KSB7XG4gICAgbGV0IGVuZFRpbWVzdGFtcCA9ICtuZXcgRGF0ZShlbmREdCk7XG4gICAgaWYgKGVuZFRpbWVzdGFtcCA+PSB0aGlzLnN0YXJ0RHQpIHtcbiAgICAgIHRoaXMuZW5kRHQgPSBlbmRUaW1lc3RhbXA7XG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddID0gdGhpcy5lbmREdDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3dhcHMgdGhlIHN0YXJ0IGRhdGUgYW5kIHRoZSBlbmQgZGF0ZSBvZiB0aGUgZGF0ZSByYW5nZVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3dhcERhdGVzICgpIHtcbiAgICBsZXQgdGVtcCA9IHRoaXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZTtcbiAgICB0aGlzLmRhdGVSYW5nZS5zdGFydERhdGUgPSB0aGlzLmRhdGVSYW5nZS5lbmREYXRlO1xuICAgIHRoaXMuZGF0ZVJhbmdlLmVuZERhdGUgPSB0ZW1wO1xuICB9XG5cbiAgLyoqXG4gICAqIFN5bmNzIHRoZSBkYXRlcmFuZ2Ugc2hvd24gYnkgdGhlIEZ1c2lvbkNoYXJ0cyB0aW1lIHNlcmllcyBjaGFydCBhbmQgdGhlIERhdGUgUmFuZ2UgQ2hvb3NlclxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgc3luY1JhbmdlICgpIHt9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBmb3JtYXR0ZWQgZGF0ZSBzdHJpbmcgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIFVOSVggdGltZXN0YW1wXG4gICAqIEBwYXJhbSAge251bWJlcn0gdGltZXN0YW1wIC0gQSBVTklYIHRpbWVzdGFtcCB0byBiZSBjb252ZXJ0ZWQgdG8gYSBkYXRlIHN0cmluZ1xuICAgKiBAcmV0dXJuIHtzdHJpbmd9IC0gQSBkYXRlIHN0cmluZyB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiB0aW1lc3RhbXBcbiAgICovXG4gIGdldEZvcm1hdHRlZERhdGUgKHRpbWVzdGFtcCkge1xuICAgIHJldHVybiB0aGlzLmNoYXJ0LmdldEZvcm1hdHRlZERhdGUodGltZXN0YW1wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgVU5JWCB0aW1lc3RhbXAgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZ1xuICAgKiBAcGFyYW0gIHtzdHJpbmd9IGRhdGVTdHJpbmcgLSBBIGRhdGUgc3RyaW5nIHRvIGJlIGNvbnZlcnRlZCB0byBhIFVOSVggdGltZXN0YW1wXG4gICAqIEByZXR1cm4ge251bWJlcn0gQSBVTklYIHRpbWVzdGFtcCB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBkYXRlIHN0cmluZ1xuICAgKi9cbiAgZ2V0VGltZXN0YW1wIChkYXRlU3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hhcnQuZ2V0VGltZXN0YW1wKGRhdGVTdHJpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnT2JqIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXh0ZW5zaW9uIG9wdGlvbnNcbiAgICovXG4gIHNldENvbmZpZyAoY29uZmlnT2JqKSB7fVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb25maWd1cmFibGUgb3B0aW9ucyBvZiB0aGUgZXh0ZW5zaW9uIChlLmcuIGNvc21ldGljcylcbiAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuICAgKi9cbiAgZ2V0Q29uZmlnICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY2FsZW5kYXJWaXNpYmxlOiAnZmFsc2UnXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuICAgKi9cbiAgaW5pdCAocmVxdWlyZSkge1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gICAgcmVxdWlyZShbXG4gICAgICAneEF4aXMnLFxuICAgICAgJ3lBeGlzJyxcbiAgICAgICdncmFwaGljcycsXG4gICAgICAnY2hhcnQnLFxuICAgICAgJ2RhdGFzZXQnLFxuICAgICAgJ1Bsb3RNYW5hZ2VyJyxcbiAgICAgICdjYW52YXNDb25maWcnLFxuICAgICAgJ01hcmtlck1hbmFnZXInLFxuICAgICAgJ3JlYWN0aXZlTW9kZWwnLFxuICAgICAgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLFxuICAgICAgJ3NwYWNlTWFuYWdlckluc3RhbmNlJyxcbiAgICAgICdzbWFydExhYmVsJyxcbiAgICAgICdjaGFydEluc3RhbmNlJyxcbiAgICAgIGZ1bmN0aW9uIChcbiAgICAgICAgICAgIHhBeGlzLFxuICAgICAgICAgICAgeUF4aXMsXG4gICAgICAgICAgICBncmFwaGljcyxcbiAgICAgICAgICAgIGNoYXJ0LFxuICAgICAgICAgICAgZGF0YXNldCxcbiAgICAgICAgICAgIHBsb3RNYW5hZ2VyLFxuICAgICAgICAgICAgY2FudmFzQ29uZmlnLFxuICAgICAgICAgICAgbWFya2VyTWFuYWdlcixcbiAgICAgICAgICAgIHJlYWN0aXZlTW9kZWwsXG4gICAgICAgICAgICBnbG9iYWxSZWFjdGl2ZU1vZGVsLFxuICAgICAgICAgICAgc3BhY2VNYW5hZ2VySW5zdGFuY2UsXG4gICAgICAgICAgICBzbWFydExhYmVsKSB7XG4gICAgICAgIGluc3RhbmNlLnhBeGlzID0geEF4aXM7XG4gICAgICAgIGluc3RhbmNlLnlBeGlzID0geUF4aXM7XG4gICAgICAgIGluc3RhbmNlLmdyYXBoaWNzID0gZ3JhcGhpY3M7XG4gICAgICAgIGluc3RhbmNlLmNoYXJ0ID0gY2hhcnQ7XG4gICAgICAgIGluc3RhbmNlLmRhdGFzZXQgPSBkYXRhc2V0O1xuICAgICAgICBpbnN0YW5jZS5wbG90TWFuYWdlciA9IHBsb3RNYW5hZ2VyO1xuICAgICAgICBpbnN0YW5jZS5tYXJrZXJNYW5hZ2VyID0gbWFya2VyTWFuYWdlcjtcbiAgICAgICAgaW5zdGFuY2UuY2FudmFzQ29uZmlnID0gY2FudmFzQ29uZmlnO1xuICAgICAgICBpbnN0YW5jZS5yZWFjdGl2ZU1vZGVsID0gcmVhY3RpdmVNb2RlbDtcbiAgICAgICAgaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgICAgIGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlID0gc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG4gICAgICAgIGluc3RhbmNlLnNtYXJ0TGFiZWwgPSBzbWFydExhYmVsO1xuICAgICAgfVxuICAgIF0pO1xuICAgIHRoaXMuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBpbnN0YW5jZS5zcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuICAgIHRoaXMuc3RhcnREdCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J107XG4gICAgdGhpcy5lbmREdCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddO1xuICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLXN0YXJ0J107XG4gICAgdGhpcy5lbmREYXRhc2V0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddO1xuICAgIHRoaXMudG9vbGJhcnMgPSBbXTtcbiAgICB0aGlzLm1lYXN1cmVtZW50ID0ge307XG4gICAgdGhpcy50b29sYmFycy5wdXNoKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmNyZWF0ZVRvb2xiYXIoKSk7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5kYXRlU3RhcnQsIHRoaXMuZGF0ZUVuZCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgY3JlYXRlVG9vbGJhciAoKSB7XG4gICAgdmFyIHRvb2xiYXIsXG4gICAgICBzZWxmID0gdGhpcyxcbiAgICAgIGZyb21EYXRlTGFiZWwsXG4gICAgICB0b0RhdGVMYWJlbCxcbiAgICAgIGdyb3VwLFxuICAgICAgZnJvbUZvcm1hdHRlZERhdGUsXG4gICAgICB0b0Zvcm1hdHRlZERhdGU7XG5cbiAgICBzZWxmLmZyb21EYXRlID0ge307XG4gICAgc2VsZi50b0RhdGUgPSB7fTtcblxuICAgIGZyb21Gb3JtYXR0ZWREYXRlID0gbmV3IERhdGUodGhpcy5zdGFydER0KS50b0xvY2FsZURhdGVTdHJpbmcoKTtcblxuICAgIHRvRm9ybWF0dGVkRGF0ZSA9IG5ldyBEYXRlKHRoaXMuZW5kRHQpLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xuXG4gICAgdG9vbGJhciA9IG5ldyB0aGlzLkhvcml6b250YWxUb29sYmFyKHtcbiAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICB9KTtcblxuICAgIHRvb2xiYXIuc2V0Q29uZmlnKHtcbiAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuICAgIH0pO1xuXG4gICAgZ3JvdXAgPSBuZXcgdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwKHtcbiAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICB9KTtcblxuICAgIGdyb3VwLnNldENvbmZpZyh7XG4gICAgICBmaWxsOiAnI2ZmZicsXG4gICAgICBib3JkZXJUaGlja25lc3M6IDBcbiAgICB9KTtcblxuICAgIGZyb21EYXRlTGFiZWwgPSBuZXcgdGhpcy50b29sYm94LkxhYmVsKCdGcm9tOicsIHtcbiAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyXG4gICAgfSwge1xuICAgICAgdGV4dDoge1xuICAgICAgICBzdHlsZToge1xuICAgICAgICAgICdmb250LXNpemUnOiAnMTUnLFxuICAgICAgICAgICdmb250RmFtaWx5JzogJ015cmlhZFBybydcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2VsZi5mcm9tRGF0ZSA9IG5ldyB0aGlzLnRvb2xib3guSW5wdXRUZXh0Qm94U3ltYm9sKHtcbiAgICAgIHdpZHRoOiAxMjAsXG4gICAgICBoZWlnaHQ6IDI1XG4gICAgfSwge1xuICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgIH0sIHtcbiAgICAgIHN0cm9rZVdpZHRoOiAxLFxuICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcbiAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAwLFxuICAgICAgYnRuVGV4dFN0eWxlOiB7XG4gICAgICAgIGZvbnRTaXplOiAxNFxuICAgICAgfSxcbiAgICAgIGxhYmVsOiBmcm9tRm9ybWF0dGVkRGF0ZVxuICAgIH0pO1xuXG4gICAgdG9EYXRlTGFiZWwgPSBuZXcgdGhpcy50b29sYm94LkxhYmVsKCdUbzonLCB7XG4gICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlclxuICAgIH0sIHtcbiAgICAgIHRleHQ6IHtcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAnZm9udC1zaXplJzogJzE1JyxcbiAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHNlbGYudG9EYXRlID0gbmV3IHRoaXMudG9vbGJveC5JbnB1dFRleHRCb3hTeW1ib2woe1xuICAgICAgd2lkdGg6IDEyMCxcbiAgICAgIGhlaWdodDogMjVcbiAgICB9LCB7XG4gICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgfSwge1xuICAgICAgc3Ryb2tlV2lkdGg6IDEsXG4gICAgICBzdHJva2U6ICdyZ2JhKDEwMiwxMDIsMTAyLDAuNSknLFxuICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6IDAsXG4gICAgICBidG5UZXh0U3R5bGU6IHtcbiAgICAgICAgZm9udFNpemU6IDE0XG4gICAgICB9LFxuICAgICAgbGFiZWw6IHRvRm9ybWF0dGVkRGF0ZVxuICAgIH0pO1xuXG4gICAgc2VsZi5mcm9tRGF0ZS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcbiAgICAgIGNsaWNrOiB7XG4gICAgICAgIGZuOiBzZWxmLmZyb21EYXRlLmVkaXRcbiAgICAgIH0sXG4gICAgICB0ZXh0T25CbHVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYuZnJvbURhdGUuYmx1cigpO1xuICAgICAgICBzZWxmLnN0YXJ0RGF0ZSA9IHNlbGYuZnJvbURhdGUuZ2V0VGV4dCgpO1xuICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmZyb21EYXRlLmdldFRleHQoKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzZWxmLnRvRGF0ZS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcbiAgICAgIGNsaWNrOiB7XG4gICAgICAgIGZuOiBzZWxmLnRvRGF0ZS5lZGl0XG4gICAgICB9LFxuICAgICAgdGV4dE9uQmx1cjogZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnRvRGF0ZS5ibHVyKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHNlbGYudG9EYXRlLmdldFRleHQoKSk7XG4gICAgICAgIHNlbGYuZW5kRGF0ZSA9IHNlbGYudG9EYXRlLmdldFRleHQoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuU3ltYm9sU3RvcmUucmVnaXN0ZXIoJ3RleHRCb3hJY29uJywgZnVuY3Rpb24gKHgsIHksIHJhZCwgdywgaCwgcGFkWCwgcGFkWSkge1xuICAgICAgdmFyIHgxID0geCAtIHcgLyAyICsgcGFkWCAvIDIsXG4gICAgICAgIHgyID0geCArIHcgLyAyIC0gcGFkWCAvIDIsXG4gICAgICAgIHkxID0geSAtIGggLyAyICsgcGFkWSAvIDIsXG4gICAgICAgIHkyID0geSArIGggLyAyIC0gcGFkWSAvIDI7XG5cbiAgICAgIHJldHVybiBbJ00nLCB4MSwgeTEsICdMJywgeDIsIHkxLCAnTCcsIHgyLCB5MiwgJ0wnLCB4MSwgeTIsICdaJ107XG4gICAgfSk7XG5cbiAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGVMYWJlbCk7XG4gICAgZ3JvdXAuYWRkU3ltYm9sKHNlbGYuZnJvbURhdGUpO1xuICAgIGdyb3VwLmFkZFN5bWJvbCh0b0RhdGVMYWJlbCk7XG4gICAgZ3JvdXAuYWRkU3ltYm9sKHNlbGYudG9EYXRlKTtcbiAgICB0b29sYmFyLmFkZENvbXBvbmVudChncm91cCk7XG4gICAgcmV0dXJuIHRvb2xiYXI7XG4gIH07XG5cbiAgZ2V0TG9naWNhbFNwYWNlIChhdmFpbGFibGVXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0KSB7XG4gICAgYXZhaWxhYmxlV2lkdGggLz0gMjtcbiAgICB2YXIgbG9naWNhbFNwYWNlLFxuICAgICAgd2lkdGggPSAwLFxuICAgICAgaGVpZ2h0ID0gMCxcbiAgICAgIGksXG4gICAgICBsbjtcblxuICAgIGZvciAoaSA9IDAsIGxuID0gdGhpcy50b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICBsb2dpY2FsU3BhY2UgPSB0aGlzLnRvb2xiYXJzW2ldLmdldExvZ2ljYWxTcGFjZSgpO1xuICAgICAgd2lkdGggPSBNYXRoLm1heChsb2dpY2FsU3BhY2Uud2lkdGgsIHdpZHRoKTtcbiAgICAgIGhlaWdodCArPSBsb2dpY2FsU3BhY2UuaGVpZ2h0O1xuICAgICAgdGhpcy50b29sYmFyc1tpXS53aWR0aCA9IGxvZ2ljYWxTcGFjZS53aWR0aDtcbiAgICAgIHRoaXMudG9vbGJhcnNbaV0uaGVpZ2h0ID0gbG9naWNhbFNwYWNlLmhlaWdodDtcbiAgICB9XG4gICAgaGVpZ2h0ICs9IHRoaXMucGFkZGluZztcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHdpZHRoID4gYXZhaWxhYmxlV2lkdGggPyAwIDogd2lkdGgsXG4gICAgICBoZWlnaHQ6IGhlaWdodCA+IGF2YWlsYWJsZUhlaWdodCA/IDAgOiBoZWlnaHRcbiAgICB9O1xuICB9O1xuXG4gIHBsYWNlSW5DYW52YXMgKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLnBhZGRpbmcgPSA1O1xuICAgIHNlbGYuc3BhY2VNYW5hZ2VySW5zdGFuY2UuYWRkKFt7XG4gICAgICBuYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAnVG9vbEJveEV4dCc7XG4gICAgICB9LFxuICAgICAgcmVmOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIHJldHVybiBvYmpbJzAnXTtcbiAgICAgIH0sXG4gICAgICBzZWxmOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBzZWxmO1xuICAgICAgfSxcbiAgICAgIHByaW9yaXR5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAyO1xuICAgICAgfSxcbiAgICAgIGxheW91dDogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqLmlubGluZTtcbiAgICAgIH0sXG4gICAgICBvcmllbnRhdGlvbjogW3tcbiAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgIHJldHVybiBvYmouaG9yaXpvbnRhbDtcbiAgICAgICAgfSxcbiAgICAgICAgcG9zaXRpb246IFt7XG4gICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIG9iai50b3A7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBhbGlnbm1lbnQ6IFt7XG4gICAgICAgICAgICB0eXBlOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgIHJldHVybiBvYmoubGVmdDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkaW1lbnNpb25zOiBbZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnRDb21wb25lbnRHcm91cCgpO1xuICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRMb2dpY2FsU3BhY2UocGFyZW50LmdldFdpZHRoKCksIHBhcmVudC5nZXRIZWlnaHQoKSk7XG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1dXG4gICAgICAgIH1dXG4gICAgICB9XVxuICAgIH1dKTtcbiAgfTtcblxuICBzZXREcmF3aW5nQ29uZmlndXJhdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcbiAgICB2YXIgbWVzID0gdGhpcy5tZWFzdXJlbWVudDtcbiAgICBtZXMueCA9IHg7XG4gICAgbWVzLnkgPSB5O1xuICAgIG1lcy53aWR0aCA9IHdpZHRoO1xuICAgIG1lcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICB0aGlzLnBhcmVudEdyb3VwID0gZ3JvdXA7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBkcmF3ICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuICAgIHZhciBtZWFzdXJlbWVudCA9IHRoaXMubWVhc3VyZW1lbnQsXG4gICAgICB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMsXG4gICAgICBsbixcbiAgICAgIGksXG4gICAgICB0b29sYmFyLFxuICAgICAgbW9kZWwgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwsXG4gICAgICBzZWxmID0gdGhpcztcbiAgICBjb25zb2xlLmxvZyhtb2RlbCk7XG4gICAgeCA9IHggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnggOiB4O1xuICAgIHkgPSB5ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC55IDogeTtcbiAgICB3aWR0aCA9IHdpZHRoID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC53aWR0aCA6IHdpZHRoO1xuICAgIGhlaWdodCA9IGhlaWdodCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQuaGVpZ2h0IDogaGVpZ2h0O1xuICAgIGdyb3VwID0gZ3JvdXAgPT09IHVuZGVmaW5lZCA/IHRoaXMucGFyZW50R3JvdXAgOiBncm91cDtcbiAgICBpZiAod2lkdGggJiYgaGVpZ2h0KSB7XG4gICAgICBmb3IgKGkgPSAwLCBsbiA9IHRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcbiAgICAgICAgdG9vbGJhciA9IHRvb2xiYXJzW2ldO1xuICAgICAgICB0b29sYmFyLmRyYXcoeCwgeSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbW9kZWwub25Qcm9wc0NoYW5nZShbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0JywgJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddLCBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgICAgc2VsZi5mcm9tRGF0ZS5ibHVyKG5ldyBEYXRlKHN0YXJ0WzFdKS50b0xvY2FsZURhdGVTdHJpbmcoKSk7XG4gICAgICBzZWxmLnRvRGF0ZS5ibHVyKG5ldyBEYXRlKGVuZFsxXSkudG9Mb2NhbGVEYXRlU3RyaW5nKCkpO1xuICAgIH0pO1xuICB9O1xufVxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cyA9IERhdGVSYW5nZTtcbn0gZWxzZSB7XG4gIHdpbmRvdy5TdGFuZGFyZFBlcmlvZCA9IERhdGVSYW5nZTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9mY3RzLWV4dC1kYXRlcmFuZ2UuanMiXSwic291cmNlUm9vdCI6IiJ9
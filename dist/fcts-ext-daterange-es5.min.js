!function(t){function e(n){if(a[n])return a[n].exports;var o=a[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=a(2);window.dr=new n,function(a,n){"object"===e(t)&&t.exports?t.exports=a.document?n(a):function(t){if(!t.document)throw new Error("Window with document not present");return n(t,!0)}:a.DateRangeChooser=n(a,!0)}("undefined"!=typeof window?window:void 0,function(t,e){var a=t.FusionCharts;a.register("extension",["private","DateRangeChooser",function(){a.registerComponent("extensions","DateRangeChooser",n)}])})}).call(e,a(1)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),o=function(){function t(){a(this,t),this.startDt=0,this.endDt=0,this.startDataset=0,this.endDataset=0,this.toolbox=FusionCharts.getComponent("api","toolbox"),this.HorizontalToolbar=this.toolbox.HorizontalToolbar,this.ComponentGroup=this.toolbox.ComponentGroup,this.SymbolStore=this.toolbox.SymbolStore,this.startText={attr:function(){}},this.endText={attr:function(){}}}return n(t,[{key:"swapDates",value:function(){var t=this.dateRange.startDate;this.dateRange.startDate=this.dateRange.endDate,this.dateRange.endDate=t}},{key:"syncRange",value:function(){}},{key:"getFormattedDate",value:function(t){return this.chart.getFormattedDate(t)}},{key:"getTimestamp",value:function(t){return this.chart.getTimestamp(t)}},{key:"setConfig",value:function(t){}},{key:"getConfig",value:function(){return{calendarVisible:"false"}}},{key:"init",value:function(t){var e=this;return t(["xAxis","yAxis","graphics","chart","dataset","PlotManager","canvasConfig","MarkerManager","reactiveModel","globalReactiveModel","spaceManagerInstance","smartLabel",function(t,a,n,o,i,r,s,l,h,c,u,d){e.xAxis=t,e.yAxis=a,e.graphics=n,e.chart=o,e.dataset=i,e.plotManager=r,e.markerManager=l,e.canvasConfig=s,e.reactiveModel=h,e.globalReactiveModel=c,e.spaceManagerInstance=u,e.smartLabel=d}]),this.spaceManagerInstance=e.spaceManagerInstance,this.globalReactiveModel=e.globalReactiveModel,this.startDt=e.globalReactiveModel.model["x-axis-visible-range-start"],this.endDt=e.globalReactiveModel.model["x-axis-visible-range-end"],this.startDataset=e.globalReactiveModel.model["x-axis-absolute-range-start"],this.endDataset=e.globalReactiveModel.model["x-axis-absolute-range-end"],this.toolbars=[],this.measurement={},this.toolbars.push(this.createToolbar()),console.log(this.createToolbar()),console.log(this.dateStart,this.dateEnd),this}},{key:"createToolbar",value:function(){var t,e,a,n,o,i,r,s,l=this;return r=new Date(this.startDt).getUTCMonth()+1+"-"+new Date(this.startDt).getUTCDate()+"-"+new Date(this.startDt).getUTCFullYear(),s=new Date(this.endDt).getUTCMonth()+"-"+(new Date(this.endDt).getUTCDate()+1)+"-"+new Date(this.endDt).getUTCFullYear(),t=new this.HorizontalToolbar({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),t.setConfig({fill:"#fff",borderThickness:0}),i=new this.toolbox.ComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),i.setConfig({fill:"#fff",borderThickness:0}),n=new this.toolbox.Label("From:",{smartLabel:this.smartLabel,paper:this.graphics.paper},{text:{style:{"font-size":"15",fontFamily:"MyriadPro"}}}),e=new this.toolbox.InputTextBoxSymbol({width:120,height:25},{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},{strokeWidth:1,stroke:"rgba(102,102,102,0.5)",symbolStrokeWidth:0,btnTextStyle:{fontSize:14},label:r}),o=new this.toolbox.Label("To:",{smartLabel:this.smartLabel,paper:this.graphics.paper},{text:{style:{"font-size":"15",fontFamily:"MyriadPro"}}}),a=new this.toolbox.InputTextBoxSymbol({width:120,height:25},{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},{strokeWidth:1,stroke:"rgba(102,102,102,0.5)",symbolStrokeWidth:0,btnTextStyle:{fontSize:14},label:s}),e.attachEventHandlers({click:{fn:e.edit},textOnBlur:function(){e.blur(),l.startDate=e.getText(),console.log(e.getText())}}),a.attachEventHandlers({click:{fn:a.edit},textOnBlur:function(){a.blur(),console.log(a.getText()),l.endDate=a.getText()}}),this.SymbolStore.register("textBoxIcon",function(t,e,a,n,o,i,r){var s=t-n/2+i/2,l=t+n/2-i/2,h=e-o/2+r/2,c=e+o/2-r/2;return["M",s,h,"L",l,h,"L",l,c,"L",s,c,"Z"]}),i.addSymbol(n),i.addSymbol(e),i.addSymbol(o),i.addSymbol(a),t.addComponent(i),t}},{key:"getLogicalSpace",value:function(t,e){t/=2;var a,n,o,i=0,r=0;for(n=0,o=this.toolbars.length;n<o;n++)a=this.toolbars[n].getLogicalSpace(),i=Math.max(a.width,i),r+=a.height,this.toolbars[n].width=a.width,this.toolbars[n].height=a.height;return r+=this.padding,{width:i>t?0:i,height:r>e?0:r}}},{key:"placeInCanvas",value:function(){var t=this;t.padding=5,t.spaceManagerInstance.add([{name:function(){return"ToolBoxExt"},ref:function(t){return t[0]},self:function(){return t},priority:function(){return 2},layout:function(t){return t.inline},orientation:[{type:function(t){return t.horizontal},position:[{type:function(t){return t.top},alignment:[{type:function(t){return t.left},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(t,e,a,n,o){var i=this.measurement;return i.x=t,i.y=e,i.width=a,i.height=n,this.parentGroup=o,this}},{key:"draw",value:function(t,e,a,n,o){var i,r,s,l=this.measurement,h=this.toolbars;if(t=void 0===t?l.x:t,e=void 0===e?l.y:e,a=void 0===a?l.width:a,n=void 0===n?l.height:n,o=void 0===o?this.parentGroup:o,a&&n)for(r=0,i=h.length;r<i;r++)s=h[r],s.draw(t,e)}},{key:"startDate",get:function(){return this.startDt},set:function(t){var e=+new Date(t);e<=this.endDt&&(this.startDt=e,this.globalReactiveModel.model["x-axis-visible-range-start"]=this.startDt)}},{key:"endDate",get:function(){return this.endDt},set:function(t){var e=+new Date(t);console.log(t),e>=this.startDt&&(this.endDt=e,this.globalReactiveModel.model["x-axis-visible-range-end"]=this.endDt)}}]),t}();"undefined"!=typeof t&&"undefined"!=typeof t.exports?t.exports=o:window.StandardPeriod=o}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDM2NTU0ZTRmNDAxODA2OTdhNThlIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9mY3RzLWV4dC1kYXRlcmFuZ2UuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJEYXRlUmFuZ2UiLCJ3aW5kb3ciLCJkciIsImVudiIsImZhY3RvcnkiLCJkb2N1bWVudCIsIndpbiIsIkVycm9yIiwiRGF0ZVJhbmdlQ2hvb3NlciIsInVuZGVmaW5lZCIsIl93aW5kb3ciLCJ3aW5kb3dFeGlzdHMiLCJGQyIsIkZ1c2lvbkNoYXJ0cyIsInJlZ2lzdGVyIiwicmVnaXN0ZXJDb21wb25lbnQiLCJ3ZWJwYWNrUG9seWZpbGwiLCJkZXByZWNhdGUiLCJwYXRocyIsImNoaWxkcmVuIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJ0aGlzIiwic3RhcnREdCIsImVuZER0Iiwic3RhcnREYXRhc2V0IiwiZW5kRGF0YXNldCIsInRvb2xib3giLCJnZXRDb21wb25lbnQiLCJIb3Jpem9udGFsVG9vbGJhciIsIkNvbXBvbmVudEdyb3VwIiwiU3ltYm9sU3RvcmUiLCJzdGFydFRleHQiLCJhdHRyIiwiZW5kVGV4dCIsInZhbHVlIiwidGVtcCIsImRhdGVSYW5nZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJ0aW1lc3RhbXAiLCJjaGFydCIsImdldEZvcm1hdHRlZERhdGUiLCJkYXRlU3RyaW5nIiwiZ2V0VGltZXN0YW1wIiwiY29uZmlnT2JqIiwiY2FsZW5kYXJWaXNpYmxlIiwicmVxdWlyZSIsInhBeGlzIiwieUF4aXMiLCJncmFwaGljcyIsImRhdGFzZXQiLCJwbG90TWFuYWdlciIsImNhbnZhc0NvbmZpZyIsIm1hcmtlck1hbmFnZXIiLCJyZWFjdGl2ZU1vZGVsIiwiZ2xvYmFsUmVhY3RpdmVNb2RlbCIsInNwYWNlTWFuYWdlckluc3RhbmNlIiwic21hcnRMYWJlbCIsIm1vZGVsIiwidG9vbGJhcnMiLCJtZWFzdXJlbWVudCIsInB1c2giLCJjcmVhdGVUb29sYmFyIiwiY29uc29sZSIsImxvZyIsImRhdGVTdGFydCIsImRhdGVFbmQiLCJ0b29sYmFyIiwiZnJvbURhdGUiLCJ0b0RhdGUiLCJmcm9tRGF0ZUxhYmVsIiwidG9EYXRlTGFiZWwiLCJncm91cCIsImZyb21Gb3JtYXR0ZWREYXRlIiwidG9Gb3JtYXR0ZWREYXRlIiwic2VsZiIsIkRhdGUiLCJnZXRVVENNb250aCIsImdldFVUQ0RhdGUiLCJnZXRVVENGdWxsWWVhciIsInBhcGVyIiwiY2hhcnRDb250YWluZXIiLCJjb250YWluZXIiLCJzZXRDb25maWciLCJmaWxsIiwiYm9yZGVyVGhpY2tuZXNzIiwiTGFiZWwiLCJ0ZXh0Iiwic3R5bGUiLCJmb250LXNpemUiLCJmb250RmFtaWx5IiwiSW5wdXRUZXh0Qm94U3ltYm9sIiwid2lkdGgiLCJoZWlnaHQiLCJzdHJva2VXaWR0aCIsInN0cm9rZSIsInN5bWJvbFN0cm9rZVdpZHRoIiwiYnRuVGV4dFN0eWxlIiwiZm9udFNpemUiLCJsYWJlbCIsImF0dGFjaEV2ZW50SGFuZGxlcnMiLCJjbGljayIsImZuIiwiZWRpdCIsInRleHRPbkJsdXIiLCJibHVyIiwiZ2V0VGV4dCIsIngiLCJ5IiwicmFkIiwidyIsImgiLCJwYWRYIiwicGFkWSIsIngxIiwieDIiLCJ5MSIsInkyIiwiYWRkU3ltYm9sIiwiYWRkQ29tcG9uZW50IiwiYXZhaWxhYmxlV2lkdGgiLCJhdmFpbGFibGVIZWlnaHQiLCJsb2dpY2FsU3BhY2UiLCJsbiIsImdldExvZ2ljYWxTcGFjZSIsIk1hdGgiLCJtYXgiLCJwYWRkaW5nIiwiYWRkIiwibmFtZSIsInJlZiIsInByaW9yaXR5IiwibGF5b3V0IiwiaW5saW5lIiwib3JpZW50YXRpb24iLCJ0eXBlIiwiaG9yaXpvbnRhbCIsInBvc2l0aW9uIiwidG9wIiwiYWxpZ25tZW50IiwibGVmdCIsImRpbWVuc2lvbnMiLCJwYXJlbnQiLCJnZXRQYXJlbnRDb21wb25lbnRHcm91cCIsImdldFdpZHRoIiwiZ2V0SGVpZ2h0IiwibWVzIiwicGFyZW50R3JvdXAiLCJkcmF3IiwiZ2V0Iiwic2V0Iiwic3RhcnRUaW1lc3RhbXAiLCJlbmRUaW1lc3RhbXAiLCJTdGFuZGFyZFBlcmlvZCJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0NJbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFFLE9BR0EsSUFBQUMsR0FBQUYsRUFBQUQsSUFDQUUsV0FDQUUsR0FBQUosRUFDQUssUUFBQSxFQVVBLE9BTkFQLEdBQUFFLEdBQUFNLEtBQUFILEVBQUFELFFBQUFDLElBQUFELFFBQUFILEdBR0FJLEVBQUFFLFFBQUEsRUFHQUYsRUFBQUQsUUF2QkEsR0FBQUQsS0FxQ0EsT0FUQUYsR0FBQVEsRUFBQVQsRUFHQUMsRUFBQVMsRUFBQVAsRUFHQUYsRUFBQVUsRUFBQSxHQUdBVixFQUFBLEtETU0sU0FBU0ksRUFBUUQsRUFBU0gsSUU1Q2hDLFNBQUFJLEdBQUEs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LEVBQzNCaUksSUFBa0JsSSxLQUFLRSxRQUN6QkYsS0FBS0MsUUFBVWlJLEVBRWZsSSxLQUFLa0Msb0JBQW9CRyxNQUFNLDhCQUFnQ3JDLEtBQUtDLFlKa2NyRUosSUFBSyxVQUNMbUksSUFBSyxXSTdiTixNQUFPaEksTUFBS0UsT0pnY1grSCxJQUFLLFNJN2JLL0gsR0FDWCxHQUFJaUksSUFBZ0IsR0FBSTVFLE1BQUtyRCxFQUM3QndDLFNBQVFDLElBQUl6QyxHQUNSaUksR0FBZ0JuSSxLQUFLQyxVQUN2QkQsS0FBS0UsTUFBUWlJLEVBRWJuSSxLQUFLa0Msb0JBQW9CRyxNQUFNLDRCQUE4QnJDLEtBQUtFLFdKbWM5RHpDLElJckdZLG9CQUFYYixJQUFvRCxtQkFBbkJBLEdBQU9ELFFBQ2pEQyxFQUFPRCxRQUFVYyxFQUVqQkMsT0FBTzBLLGVBQWlCM0siLCJmaWxlIjoiZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihtb2R1bGUpIHsndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cdFxuXHR2YXIgRGF0ZVJhbmdlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdHdpbmRvdy5kciA9IG5ldyBEYXRlUmFuZ2UoKTtcblx0XG5cdDsoZnVuY3Rpb24gKGVudiwgZmFjdG9yeSkge1xuXHQgIGlmICgoIGZhbHNlID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKG1vZHVsZSkpID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBlbnYuZG9jdW1lbnQgPyBmYWN0b3J5KGVudikgOiBmdW5jdGlvbiAod2luKSB7XG5cdCAgICAgIGlmICghd2luLmRvY3VtZW50KSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXaW5kb3cgd2l0aCBkb2N1bWVudCBub3QgcHJlc2VudCcpO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBmYWN0b3J5KHdpbiwgdHJ1ZSk7XG5cdCAgICB9O1xuXHQgIH0gZWxzZSB7XG5cdCAgICBlbnYuRGF0ZVJhbmdlQ2hvb3NlciA9IGZhY3RvcnkoZW52LCB0cnVlKTtcblx0ICB9XG5cdH0pKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdW5kZWZpbmVkLCBmdW5jdGlvbiAoX3dpbmRvdywgd2luZG93RXhpc3RzKSB7XG5cdCAgdmFyIEZDID0gX3dpbmRvdy5GdXNpb25DaGFydHM7XG5cdCAgRkMucmVnaXN0ZXIoJ2V4dGVuc2lvbicsIFsncHJpdmF0ZScsICdEYXRlUmFuZ2VDaG9vc2VyJywgZnVuY3Rpb24gKCkge1xuXHQgICAgRkMucmVnaXN0ZXJDb21wb25lbnQoJ2V4dGVuc2lvbnMnLCAnRGF0ZVJhbmdlQ2hvb3NlcicsIERhdGVSYW5nZSk7XG5cdCAgfV0pO1xuXHR9KTtcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMSkobW9kdWxlKSkpXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRcdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XG5cdFx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcblx0XHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XG5cdFx0XHRtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0XHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHRcdH1cblx0XHRyZXR1cm4gbW9kdWxlO1xuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0LyoqXG5cdCAqIENsYXNzIHJlcHJlc2VudGluZyB0aGUgRGF0ZVJhbmdlLlxuXHQgKi9cblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIERhdGVSYW5nZSA9IGZ1bmN0aW9uICgpIHtcblx0ICBmdW5jdGlvbiBEYXRlUmFuZ2UoKSB7XG5cdCAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0ZVJhbmdlKTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuc3RhcnREdCA9IDA7XG5cdCAgICB0aGlzLmVuZER0ID0gMDtcblx0ICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcblx0ICAgIHRoaXMuZW5kRGF0YXNldCA9IDA7XG5cdCAgICB0aGlzLnRvb2xib3ggPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuXHQgICAgdGhpcy5Ib3Jpem9udGFsVG9vbGJhciA9IHRoaXMudG9vbGJveC5Ib3Jpem9udGFsVG9vbGJhcjtcblx0ICAgIHRoaXMuQ29tcG9uZW50R3JvdXAgPSB0aGlzLnRvb2xib3guQ29tcG9uZW50R3JvdXA7XG5cdCAgICB0aGlzLlN5bWJvbFN0b3JlID0gdGhpcy50b29sYm94LlN5bWJvbFN0b3JlO1xuXHQgICAgdGhpcy5zdGFydFRleHQgPSB7XG5cdCAgICAgIGF0dHI6IGZ1bmN0aW9uIGF0dHIoKSB7fVxuXHQgICAgfTtcblx0ICAgIHRoaXMuZW5kVGV4dCA9IHtcblx0ICAgICAgYXR0cjogZnVuY3Rpb24gYXR0cigpIHt9XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc3RhcnQgYW5kIGVuZCBkYXRlcy5cblx0ICAgKiBAdHlwZSB7RGF0ZVJhbmdlLnJhbmdlfVxuXHQgICAqL1xuXHRcblx0XG5cdCAgX2NyZWF0ZUNsYXNzKERhdGVSYW5nZSwgW3tcblx0ICAgIGtleTogJ3N3YXBEYXRlcycsXG5cdFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU3dhcHMgdGhlIHN0YXJ0IGRhdGUgYW5kIHRoZSBlbmQgZGF0ZSBvZiB0aGUgZGF0ZSByYW5nZVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHN3YXBEYXRlcygpIHtcblx0ICAgICAgdmFyIHRlbXAgPSB0aGlzLmRhdGVSYW5nZS5zdGFydERhdGU7XG5cdCAgICAgIHRoaXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZSA9IHRoaXMuZGF0ZVJhbmdlLmVuZERhdGU7XG5cdCAgICAgIHRoaXMuZGF0ZVJhbmdlLmVuZERhdGUgPSB0ZW1wO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU3luY3MgdGhlIGRhdGVyYW5nZSBzaG93biBieSB0aGUgRnVzaW9uQ2hhcnRzIHRpbWUgc2VyaWVzIGNoYXJ0IGFuZCB0aGUgRGF0ZSBSYW5nZSBDaG9vc2VyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3N5bmNSYW5nZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc3luY1JhbmdlKCkge31cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybnMgYSBmb3JtYXR0ZWQgZGF0ZSBzdHJpbmcgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIFVOSVggdGltZXN0YW1wXG5cdCAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHRpbWVzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgY29udmVydGVkIHRvIGEgZGF0ZSBzdHJpbmdcblx0ICAgICAqIEByZXR1cm4ge3N0cmluZ30gLSBBIGRhdGUgc3RyaW5nIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIHRpbWVzdGFtcFxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2dldEZvcm1hdHRlZERhdGUnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZvcm1hdHRlZERhdGUodGltZXN0YW1wKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLmNoYXJ0LmdldEZvcm1hdHRlZERhdGUodGltZXN0YW1wKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybnMgYSBVTklYIHRpbWVzdGFtcCBmcm9tIEZ1c2lvbkNoYXJ0cyB3aGVuIGdpdmVuIGEgZm9ybWF0dGVkIGRhdGUgc3RyaW5nXG5cdCAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGRhdGVTdHJpbmcgLSBBIGRhdGUgc3RyaW5nIHRvIGJlIGNvbnZlcnRlZCB0byBhIFVOSVggdGltZXN0YW1wXG5cdCAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IEEgVU5JWCB0aW1lc3RhbXAgd2hpY2ggaXMgZXF1aXZhbGVudCB0byB0aGUgZ2l2ZW4gZGF0ZSBzdHJpbmdcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdnZXRUaW1lc3RhbXAnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRpbWVzdGFtcChkYXRlU3RyaW5nKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLmNoYXJ0LmdldFRpbWVzdGFtcChkYXRlU3RyaW5nKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ09iaiBUaGUgY29uZmlndXJhdGlvbiBvYmplY3QgY29udGFpbmluZyB2YXJpb3VzIGV4dGVuc2lvbiBvcHRpb25zXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnc2V0Q29uZmlnJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRDb25maWcoY29uZmlnT2JqKSB7fVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0cyB0aGUgY29uZmlndXJhYmxlIG9wdGlvbnMgb2YgdGhlIGV4dGVuc2lvbiAoZS5nLiBjb3NtZXRpY3MpXG5cdCAgICAgKiBAcmV0dXJuIHtvYmplY3R9IGNvbmZpZ09iaiBUaGUgY29uZmlndXJhdGlvbiBvYmplY3QgY29udGFpbmluZyB2YXJpb3VzIGV4dGVuc2lvbiBvcHRpb25zXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnZ2V0Q29uZmlnJyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb25maWcoKSB7XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgY2FsZW5kYXJWaXNpYmxlOiAnZmFsc2UnXG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2luaXQnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQocmVxdWlyZSkge1xuXHQgICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuXHQgICAgICByZXF1aXJlKFsneEF4aXMnLCAneUF4aXMnLCAnZ3JhcGhpY3MnLCAnY2hhcnQnLCAnZGF0YXNldCcsICdQbG90TWFuYWdlcicsICdjYW52YXNDb25maWcnLCAnTWFya2VyTWFuYWdlcicsICdyZWFjdGl2ZU1vZGVsJywgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLCAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLCAnc21hcnRMYWJlbCcsIGZ1bmN0aW9uICh4QXhpcywgeUF4aXMsIGdyYXBoaWNzLCBjaGFydCwgZGF0YXNldCwgcGxvdE1hbmFnZXIsIGNhbnZhc0NvbmZpZywgbWFya2VyTWFuYWdlciwgcmVhY3RpdmVNb2RlbCwgZ2xvYmFsUmVhY3RpdmVNb2RlbCwgc3BhY2VNYW5hZ2VySW5zdGFuY2UsIHNtYXJ0TGFiZWwpIHtcblx0ICAgICAgICBpbnN0YW5jZS54QXhpcyA9IHhBeGlzO1xuXHQgICAgICAgIGluc3RhbmNlLnlBeGlzID0geUF4aXM7XG5cdCAgICAgICAgaW5zdGFuY2UuZ3JhcGhpY3MgPSBncmFwaGljcztcblx0ICAgICAgICBpbnN0YW5jZS5jaGFydCA9IGNoYXJ0O1xuXHQgICAgICAgIGluc3RhbmNlLmRhdGFzZXQgPSBkYXRhc2V0O1xuXHQgICAgICAgIGluc3RhbmNlLnBsb3RNYW5hZ2VyID0gcGxvdE1hbmFnZXI7XG5cdCAgICAgICAgaW5zdGFuY2UubWFya2VyTWFuYWdlciA9IG1hcmtlck1hbmFnZXI7XG5cdCAgICAgICAgaW5zdGFuY2UuY2FudmFzQ29uZmlnID0gY2FudmFzQ29uZmlnO1xuXHQgICAgICAgIGluc3RhbmNlLnJlYWN0aXZlTW9kZWwgPSByZWFjdGl2ZU1vZGVsO1xuXHQgICAgICAgIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBnbG9iYWxSZWFjdGl2ZU1vZGVsO1xuXHQgICAgICAgIGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlID0gc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG5cdCAgICAgICAgaW5zdGFuY2Uuc21hcnRMYWJlbCA9IHNtYXJ0TGFiZWw7XG5cdCAgICAgIH1dKTtcblx0ICAgICAgdGhpcy5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlO1xuXHQgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsO1xuXHQgICAgICB0aGlzLnN0YXJ0RHQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddO1xuXHQgICAgICB0aGlzLmVuZER0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLXN0YXJ0J107XG5cdCAgICAgIHRoaXMuZW5kRGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1lbmQnXTtcblx0ICAgICAgdGhpcy50b29sYmFycyA9IFtdO1xuXHQgICAgICB0aGlzLm1lYXN1cmVtZW50ID0ge307XG5cdCAgICAgIHRoaXMudG9vbGJhcnMucHVzaCh0aGlzLmNyZWF0ZVRvb2xiYXIoKSk7XG5cdCAgICAgIGNvbnNvbGUubG9nKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcblx0ICAgICAgY29uc29sZS5sb2codGhpcy5kYXRlU3RhcnQsIHRoaXMuZGF0ZUVuZCk7XG5cdCAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2NyZWF0ZVRvb2xiYXInLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVRvb2xiYXIoKSB7XG5cdCAgICAgIHZhciB0b29sYmFyLFxuXHQgICAgICAgICAgZnJvbURhdGUsXG5cdCAgICAgICAgICB0b0RhdGUsXG5cdCAgICAgICAgICBzZWxmID0gdGhpcyxcblx0ICAgICAgICAgIGZyb21EYXRlTGFiZWwsXG5cdCAgICAgICAgICB0b0RhdGVMYWJlbCxcblx0ICAgICAgICAgIGdyb3VwLFxuXHQgICAgICAgICAgZnJvbUZvcm1hdHRlZERhdGUsXG5cdCAgICAgICAgICB0b0Zvcm1hdHRlZERhdGU7XG5cdFxuXHQgICAgICBmcm9tRm9ybWF0dGVkRGF0ZSA9IG5ldyBEYXRlKHRoaXMuc3RhcnREdCkuZ2V0VVRDTW9udGgoKSArIDEgKyAnLScgKyBuZXcgRGF0ZSh0aGlzLnN0YXJ0RHQpLmdldFVUQ0RhdGUoKSArICctJyArIG5ldyBEYXRlKHRoaXMuc3RhcnREdCkuZ2V0VVRDRnVsbFllYXIoKTtcblx0XG5cdCAgICAgIHRvRm9ybWF0dGVkRGF0ZSA9IG5ldyBEYXRlKHRoaXMuZW5kRHQpLmdldFVUQ01vbnRoKCkgKyAnLScgKyAobmV3IERhdGUodGhpcy5lbmREdCkuZ2V0VVRDRGF0ZSgpICsgMSkgKyAnLScgKyBuZXcgRGF0ZSh0aGlzLmVuZER0KS5nZXRVVENGdWxsWWVhcigpO1xuXHRcblx0ICAgICAgdG9vbGJhciA9IG5ldyB0aGlzLkhvcml6b250YWxUb29sYmFyKHtcblx0ICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcblx0ICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcblx0ICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgdG9vbGJhci5zZXRDb25maWcoe1xuXHQgICAgICAgIGZpbGw6ICcjZmZmJyxcblx0ICAgICAgICBib3JkZXJUaGlja25lc3M6IDBcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBncm91cCA9IG5ldyB0aGlzLnRvb2xib3guQ29tcG9uZW50R3JvdXAoe1xuXHQgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHQgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBncm91cC5zZXRDb25maWcoe1xuXHQgICAgICAgIGZpbGw6ICcjZmZmJyxcblx0ICAgICAgICBib3JkZXJUaGlja25lc3M6IDBcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBmcm9tRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnRnJvbTonLCB7XG5cdCAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyXG5cdCAgICAgIH0sIHtcblx0ICAgICAgICB0ZXh0OiB7XG5cdCAgICAgICAgICBzdHlsZToge1xuXHQgICAgICAgICAgICAnZm9udC1zaXplJzogJzE1Jyxcblx0ICAgICAgICAgICAgJ2ZvbnRGYW1pbHknOiAnTXlyaWFkUHJvJ1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBmcm9tRGF0ZSA9IG5ldyB0aGlzLnRvb2xib3guSW5wdXRUZXh0Qm94U3ltYm9sKHtcblx0ICAgICAgICB3aWR0aDogMTIwLFxuXHQgICAgICAgIGhlaWdodDogMjVcblx0ICAgICAgfSwge1xuXHQgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuXHQgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgfSwge1xuXHQgICAgICAgIHN0cm9rZVdpZHRoOiAxLFxuXHQgICAgICAgIHN0cm9rZTogJ3JnYmEoMTAyLDEwMiwxMDIsMC41KScsXG5cdCAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6IDAsXG5cdCAgICAgICAgYnRuVGV4dFN0eWxlOiB7XG5cdCAgICAgICAgICBmb250U2l6ZTogMTRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGxhYmVsOiBmcm9tRm9ybWF0dGVkRGF0ZVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHRvRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnVG86Jywge1xuXHQgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlclxuXHQgICAgICB9LCB7XG5cdCAgICAgICAgdGV4dDoge1xuXHQgICAgICAgICAgc3R5bGU6IHtcblx0ICAgICAgICAgICAgJ2ZvbnQtc2l6ZSc6ICcxNScsXG5cdCAgICAgICAgICAgICdmb250RmFtaWx5JzogJ015cmlhZFBybydcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgdG9EYXRlID0gbmV3IHRoaXMudG9vbGJveC5JbnB1dFRleHRCb3hTeW1ib2woe1xuXHQgICAgICAgIHdpZHRoOiAxMjAsXG5cdCAgICAgICAgaGVpZ2h0OiAyNVxuXHQgICAgICB9LCB7XG5cdCAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG5cdCAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuXHQgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICB9LCB7XG5cdCAgICAgICAgc3Ryb2tlV2lkdGg6IDEsXG5cdCAgICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcblx0ICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogMCxcblx0ICAgICAgICBidG5UZXh0U3R5bGU6IHtcblx0ICAgICAgICAgIGZvbnRTaXplOiAxNFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgbGFiZWw6IHRvRm9ybWF0dGVkRGF0ZVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGZyb21EYXRlLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuXHQgICAgICAgIGNsaWNrOiB7XG5cdCAgICAgICAgICBmbjogZnJvbURhdGUuZWRpdFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgdGV4dE9uQmx1cjogZnVuY3Rpb24gdGV4dE9uQmx1cigpIHtcblx0ICAgICAgICAgIGZyb21EYXRlLmJsdXIoKTtcblx0ICAgICAgICAgIHNlbGYuc3RhcnREYXRlID0gZnJvbURhdGUuZ2V0VGV4dCgpO1xuXHQgICAgICAgICAgY29uc29sZS5sb2coZnJvbURhdGUuZ2V0VGV4dCgpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgdG9EYXRlLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuXHQgICAgICAgIGNsaWNrOiB7XG5cdCAgICAgICAgICBmbjogdG9EYXRlLmVkaXRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHRleHRPbkJsdXI6IGZ1bmN0aW9uIHRleHRPbkJsdXIoKSB7XG5cdCAgICAgICAgICB0b0RhdGUuYmx1cigpO1xuXHQgICAgICAgICAgY29uc29sZS5sb2codG9EYXRlLmdldFRleHQoKSk7XG5cdCAgICAgICAgICBzZWxmLmVuZERhdGUgPSB0b0RhdGUuZ2V0VGV4dCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICB0aGlzLlN5bWJvbFN0b3JlLnJlZ2lzdGVyKCd0ZXh0Qm94SWNvbicsIGZ1bmN0aW9uICh4LCB5LCByYWQsIHcsIGgsIHBhZFgsIHBhZFkpIHtcblx0ICAgICAgICB2YXIgeDEgPSB4IC0gdyAvIDIgKyBwYWRYIC8gMixcblx0ICAgICAgICAgICAgeDIgPSB4ICsgdyAvIDIgLSBwYWRYIC8gMixcblx0ICAgICAgICAgICAgeTEgPSB5IC0gaCAvIDIgKyBwYWRZIC8gMixcblx0ICAgICAgICAgICAgeTIgPSB5ICsgaCAvIDIgLSBwYWRZIC8gMjtcblx0XG5cdCAgICAgICAgcmV0dXJuIFsnTScsIHgxLCB5MSwgJ0wnLCB4MiwgeTEsICdMJywgeDIsIHkyLCAnTCcsIHgxLCB5MiwgJ1onXTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGVMYWJlbCk7XG5cdCAgICAgIGdyb3VwLmFkZFN5bWJvbChmcm9tRGF0ZSk7XG5cdCAgICAgIGdyb3VwLmFkZFN5bWJvbCh0b0RhdGVMYWJlbCk7XG5cdCAgICAgIGdyb3VwLmFkZFN5bWJvbCh0b0RhdGUpO1xuXHQgICAgICB0b29sYmFyLmFkZENvbXBvbmVudChncm91cCk7XG5cdCAgICAgIHJldHVybiB0b29sYmFyO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2dldExvZ2ljYWxTcGFjZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TG9naWNhbFNwYWNlKGF2YWlsYWJsZVdpZHRoLCBhdmFpbGFibGVIZWlnaHQpIHtcblx0ICAgICAgYXZhaWxhYmxlV2lkdGggLz0gMjtcblx0ICAgICAgdmFyIGxvZ2ljYWxTcGFjZSxcblx0ICAgICAgICAgIHdpZHRoID0gMCxcblx0ICAgICAgICAgIGhlaWdodCA9IDAsXG5cdCAgICAgICAgICBpLFxuXHQgICAgICAgICAgbG47XG5cdFxuXHQgICAgICBmb3IgKGkgPSAwLCBsbiA9IHRoaXMudG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuXHQgICAgICAgIGxvZ2ljYWxTcGFjZSA9IHRoaXMudG9vbGJhcnNbaV0uZ2V0TG9naWNhbFNwYWNlKCk7XG5cdCAgICAgICAgd2lkdGggPSBNYXRoLm1heChsb2dpY2FsU3BhY2Uud2lkdGgsIHdpZHRoKTtcblx0ICAgICAgICBoZWlnaHQgKz0gbG9naWNhbFNwYWNlLmhlaWdodDtcblx0ICAgICAgICB0aGlzLnRvb2xiYXJzW2ldLndpZHRoID0gbG9naWNhbFNwYWNlLndpZHRoO1xuXHQgICAgICAgIHRoaXMudG9vbGJhcnNbaV0uaGVpZ2h0ID0gbG9naWNhbFNwYWNlLmhlaWdodDtcblx0ICAgICAgfVxuXHQgICAgICBoZWlnaHQgKz0gdGhpcy5wYWRkaW5nO1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIHdpZHRoOiB3aWR0aCA+IGF2YWlsYWJsZVdpZHRoID8gMCA6IHdpZHRoLFxuXHQgICAgICAgIGhlaWdodDogaGVpZ2h0ID4gYXZhaWxhYmxlSGVpZ2h0ID8gMCA6IGhlaWdodFxuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3BsYWNlSW5DYW52YXMnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYWNlSW5DYW52YXMoKSB7XG5cdCAgICAgIHZhciBfc2VsZiA9IHRoaXM7XG5cdCAgICAgIF9zZWxmLnBhZGRpbmcgPSA1O1xuXHQgICAgICBfc2VsZi5zcGFjZU1hbmFnZXJJbnN0YW5jZS5hZGQoW3tcblx0ICAgICAgICBuYW1lOiBmdW5jdGlvbiBuYW1lKCkge1xuXHQgICAgICAgICAgcmV0dXJuICdUb29sQm94RXh0Jztcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHJlZjogZnVuY3Rpb24gcmVmKG9iaikge1xuXHQgICAgICAgICAgcmV0dXJuIG9ialsnMCddO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgc2VsZjogZnVuY3Rpb24gc2VsZigpIHtcblx0ICAgICAgICAgIHJldHVybiBfc2VsZjtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHByaW9yaXR5OiBmdW5jdGlvbiBwcmlvcml0eSgpIHtcblx0ICAgICAgICAgIHJldHVybiAyO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgbGF5b3V0OiBmdW5jdGlvbiBsYXlvdXQob2JqKSB7XG5cdCAgICAgICAgICByZXR1cm4gb2JqLmlubGluZTtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIG9yaWVudGF0aW9uOiBbe1xuXHQgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG9iai5ob3Jpem9udGFsO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIHBvc2l0aW9uOiBbe1xuXHQgICAgICAgICAgICB0eXBlOiBmdW5jdGlvbiB0eXBlKG9iaikge1xuXHQgICAgICAgICAgICAgIHJldHVybiBvYmoudG9wO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBhbGlnbm1lbnQ6IFt7XG5cdCAgICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiBvYmoubGVmdDtcblx0ICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgIGRpbWVuc2lvbnM6IFtmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnRDb21wb25lbnRHcm91cCgpO1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIF9zZWxmLmdldExvZ2ljYWxTcGFjZShwYXJlbnQuZ2V0V2lkdGgoKSwgcGFyZW50LmdldEhlaWdodCgpKTtcblx0ICAgICAgICAgICAgICB9XVxuXHQgICAgICAgICAgICB9XVxuXHQgICAgICAgICAgfV1cblx0ICAgICAgICB9XVxuXHQgICAgICB9XSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAnc2V0RHJhd2luZ0NvbmZpZ3VyYXRpb24nLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHNldERyYXdpbmdDb25maWd1cmF0aW9uKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG5cdCAgICAgIHZhciBtZXMgPSB0aGlzLm1lYXN1cmVtZW50O1xuXHQgICAgICBtZXMueCA9IHg7XG5cdCAgICAgIG1lcy55ID0geTtcblx0ICAgICAgbWVzLndpZHRoID0gd2lkdGg7XG5cdCAgICAgIG1lcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdFxuXHQgICAgICB0aGlzLnBhcmVudEdyb3VwID0gZ3JvdXA7XG5cdFxuXHQgICAgICByZXR1cm4gdGhpcztcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6ICdkcmF3Jyxcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3KHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG5cdCAgICAgIHZhciBtZWFzdXJlbWVudCA9IHRoaXMubWVhc3VyZW1lbnQsXG5cdCAgICAgICAgICB0b29sYmFycyA9IHRoaXMudG9vbGJhcnMsXG5cdCAgICAgICAgICBsbixcblx0ICAgICAgICAgIGksXG5cdCAgICAgICAgICB0b29sYmFyO1xuXHRcblx0ICAgICAgeCA9IHggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnggOiB4O1xuXHQgICAgICB5ID0geSA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQueSA6IHk7XG5cdCAgICAgIHdpZHRoID0gd2lkdGggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LndpZHRoIDogd2lkdGg7XG5cdCAgICAgIGhlaWdodCA9IGhlaWdodCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQuaGVpZ2h0IDogaGVpZ2h0O1xuXHQgICAgICBncm91cCA9IGdyb3VwID09PSB1bmRlZmluZWQgPyB0aGlzLnBhcmVudEdyb3VwIDogZ3JvdXA7XG5cdCAgICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcblx0ICAgICAgICBmb3IgKGkgPSAwLCBsbiA9IHRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcblx0ICAgICAgICAgIHRvb2xiYXIgPSB0b29sYmFyc1tpXTtcblx0ICAgICAgICAgIHRvb2xiYXIuZHJhdyh4LCB5KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6ICdzdGFydERhdGUnLFxuXHQgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnN0YXJ0RHQ7XG5cdCAgICB9LFxuXHQgICAgc2V0OiBmdW5jdGlvbiBzZXQoc3RhcnREdCkge1xuXHQgICAgICB2YXIgc3RhcnRUaW1lc3RhbXAgPSArbmV3IERhdGUoc3RhcnREdCk7XG5cdCAgICAgIGlmIChzdGFydFRpbWVzdGFtcCA8PSB0aGlzLmVuZER0KSB7XG5cdCAgICAgICAgdGhpcy5zdGFydER0ID0gc3RhcnRUaW1lc3RhbXA7XG5cdCAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddKTtcblx0ICAgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gPSB0aGlzLnN0YXJ0RHQ7XG5cdCAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2VuZERhdGUnLFxuXHQgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLmVuZER0O1xuXHQgICAgfSxcblx0ICAgIHNldDogZnVuY3Rpb24gc2V0KGVuZER0KSB7XG5cdCAgICAgIHZhciBlbmRUaW1lc3RhbXAgPSArbmV3IERhdGUoZW5kRHQpO1xuXHQgICAgICBjb25zb2xlLmxvZyhlbmREdCk7XG5cdCAgICAgIGlmIChlbmRUaW1lc3RhbXAgPj0gdGhpcy5zdGFydER0KSB7XG5cdCAgICAgICAgdGhpcy5lbmREdCA9IGVuZFRpbWVzdGFtcDtcblx0ICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddKTtcblx0ICAgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddID0gdGhpcy5lbmREdDtcblx0ICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1dKTtcblx0XG5cdCAgcmV0dXJuIERhdGVSYW5nZTtcblx0fSgpO1xuXHRcblx0aWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICBtb2R1bGUuZXhwb3J0cyA9IERhdGVSYW5nZTtcblx0fSBlbHNlIHtcblx0ICB3aW5kb3cuU3RhbmRhcmRQZXJpb2QgPSBEYXRlUmFuZ2U7XG5cdH1cblxuLyoqKi8gfVxuLyoqKioqKi8gXSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGZjdHMtZXh0LWRhdGVyYW5nZS1lczUubWluLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMzY1NTRlNGY0MDE4MDY5N2E1OGUiLCIndXNlIHN0cmljdCc7XG5jb25zdCBEYXRlUmFuZ2UgPSByZXF1aXJlKCcuL2ZjdHMtZXh0LWRhdGVyYW5nZScpO1xuXG53aW5kb3cuZHIgPSBuZXcgRGF0ZVJhbmdlKCk7XG5cbjsoZnVuY3Rpb24gKGVudiwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGVudi5kb2N1bWVudFxuICAgICAgID8gZmFjdG9yeShlbnYpIDogZnVuY3Rpb24gKHdpbikge1xuICAgICAgICAgaWYgKCF3aW4uZG9jdW1lbnQpIHtcbiAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXaW5kb3cgd2l0aCBkb2N1bWVudCBub3QgcHJlc2VudCcpO1xuICAgICAgICAgfVxuICAgICAgICAgcmV0dXJuIGZhY3Rvcnkod2luLCB0cnVlKTtcbiAgICAgICB9O1xuICB9IGVsc2Uge1xuICAgIGVudi5EYXRlUmFuZ2VDaG9vc2VyID0gZmFjdG9yeShlbnYsIHRydWUpO1xuICB9XG59KSh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHRoaXMsIGZ1bmN0aW9uIChfd2luZG93LCB3aW5kb3dFeGlzdHMpIHtcbiAgdmFyIEZDID0gX3dpbmRvdy5GdXNpb25DaGFydHM7XG4gIEZDLnJlZ2lzdGVyKCdleHRlbnNpb24nLCBbJ3ByaXZhdGUnLCAnRGF0ZVJhbmdlQ2hvb3NlcicsIGZ1bmN0aW9uICgpIHtcbiAgICBGQy5yZWdpc3RlckNvbXBvbmVudCgnZXh0ZW5zaW9ucycsICdEYXRlUmFuZ2VDaG9vc2VyJywgRGF0ZVJhbmdlKTtcbiAgfV0pO1xufSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvaW5kZXguanMiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRpZighbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xuXHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxuXHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xuXHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHR9XG5cdHJldHVybiBtb2R1bGU7XG59XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAod2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuLyoqXG4gKiBDbGFzcyByZXByZXNlbnRpbmcgdGhlIERhdGVSYW5nZS5cbiAqL1xuY2xhc3MgRGF0ZVJhbmdlIHtcbiAgY29uc3RydWN0b3IgKCkge1xuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdGhpcy5zdGFydER0ID0gMDtcbiAgICB0aGlzLmVuZER0ID0gMDtcbiAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IDA7XG4gICAgdGhpcy5lbmREYXRhc2V0ID0gMDtcbiAgICB0aGlzLnRvb2xib3ggPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuICAgIHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIgPSB0aGlzLnRvb2xib3guSG9yaXpvbnRhbFRvb2xiYXI7XG4gICAgdGhpcy5Db21wb25lbnRHcm91cCA9IHRoaXMudG9vbGJveC5Db21wb25lbnRHcm91cDtcbiAgICB0aGlzLlN5bWJvbFN0b3JlID0gdGhpcy50b29sYm94LlN5bWJvbFN0b3JlO1xuICAgIHRoaXMuc3RhcnRUZXh0ID0ge1xuICAgICAgYXR0cjogZnVuY3Rpb24gKCkge31cbiAgICB9O1xuICAgIHRoaXMuZW5kVGV4dCA9IHtcbiAgICAgIGF0dHI6IGZ1bmN0aW9uICgpIHt9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzdGFydCBhbmQgZW5kIGRhdGVzLlxuICAgKiBAdHlwZSB7RGF0ZVJhbmdlLnJhbmdlfVxuICAgKi9cbiAgZ2V0IHN0YXJ0RGF0ZSAoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhcnREdDtcbiAgfVxuXG4gIHNldCBzdGFydERhdGUgKHN0YXJ0RHQpIHtcbiAgICBsZXQgc3RhcnRUaW1lc3RhbXAgPSArbmV3IERhdGUoc3RhcnREdCk7XG4gICAgaWYgKHN0YXJ0VGltZXN0YW1wIDw9IHRoaXMuZW5kRHQpIHtcbiAgICAgIHRoaXMuc3RhcnREdCA9IHN0YXJ0VGltZXN0YW1wO1xuICAgICAgLy8gY29uc29sZS5sb2codGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1zdGFydCddKTtcbiAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXSA9IHRoaXMuc3RhcnREdDtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGVuZERhdGUgKCkge1xuICAgIHJldHVybiB0aGlzLmVuZER0O1xuICB9XG5cbiAgc2V0IGVuZERhdGUgKGVuZER0KSB7XG4gICAgbGV0IGVuZFRpbWVzdGFtcCA9ICtuZXcgRGF0ZShlbmREdCk7XG4gICAgY29uc29sZS5sb2coZW5kRHQpO1xuICAgIGlmIChlbmRUaW1lc3RhbXAgPj0gdGhpcy5zdGFydER0KSB7XG4gICAgICB0aGlzLmVuZER0ID0gZW5kVGltZXN0YW1wO1xuICAgICAgLy8gY29uc29sZS5sb2codGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtdmlzaWJsZS1yYW5nZS1lbmQnXSk7XG4gICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLWVuZCddID0gdGhpcy5lbmREdDtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTd2FwcyB0aGUgc3RhcnQgZGF0ZSBhbmQgdGhlIGVuZCBkYXRlIG9mIHRoZSBkYXRlIHJhbmdlXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzd2FwRGF0ZXMgKCkge1xuICAgIGxldCB0ZW1wID0gdGhpcy5kYXRlUmFuZ2Uuc3RhcnREYXRlO1xuICAgIHRoaXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZSA9IHRoaXMuZGF0ZVJhbmdlLmVuZERhdGU7XG4gICAgdGhpcy5kYXRlUmFuZ2UuZW5kRGF0ZSA9IHRlbXA7XG4gIH1cblxuICAvKipcbiAgICogU3luY3MgdGhlIGRhdGVyYW5nZSBzaG93biBieSB0aGUgRnVzaW9uQ2hhcnRzIHRpbWUgc2VyaWVzIGNoYXJ0IGFuZCB0aGUgRGF0ZSBSYW5nZSBDaG9vc2VyXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBzeW5jUmFuZ2UgKCkge31cblxuICAvKipcbiAgICogUmV0dXJucyBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZyBmcm9tIEZ1c2lvbkNoYXJ0cyB3aGVuIGdpdmVuIGEgVU5JWCB0aW1lc3RhbXBcbiAgICogQHBhcmFtICB7bnVtYmVyfSB0aW1lc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIGNvbnZlcnRlZCB0byBhIGRhdGUgc3RyaW5nXG4gICAqIEByZXR1cm4ge3N0cmluZ30gLSBBIGRhdGUgc3RyaW5nIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIHRpbWVzdGFtcFxuICAgKi9cbiAgZ2V0Rm9ybWF0dGVkRGF0ZSAodGltZXN0YW1wKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hhcnQuZ2V0Rm9ybWF0dGVkRGF0ZSh0aW1lc3RhbXApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBVTklYIHRpbWVzdGFtcCBmcm9tIEZ1c2lvbkNoYXJ0cyB3aGVuIGdpdmVuIGEgZm9ybWF0dGVkIGRhdGUgc3RyaW5nXG4gICAqIEBwYXJhbSAge3N0cmluZ30gZGF0ZVN0cmluZyAtIEEgZGF0ZSBzdHJpbmcgdG8gYmUgY29udmVydGVkIHRvIGEgVU5JWCB0aW1lc3RhbXBcbiAgICogQHJldHVybiB7bnVtYmVyfSBBIFVOSVggdGltZXN0YW1wIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIGRhdGUgc3RyaW5nXG4gICAqL1xuICBnZXRUaW1lc3RhbXAgKGRhdGVTdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5jaGFydC5nZXRUaW1lc3RhbXAoZGF0ZVN0cmluZyk7XG4gIH1cblxuICAvKipcbiAgICogU2V0cyB0aGUgY29uZmlndXJhYmxlIG9wdGlvbnMgb2YgdGhlIGV4dGVuc2lvbiAoZS5nLiBjb3NtZXRpY3MpXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuICAgKi9cbiAgc2V0Q29uZmlnIChjb25maWdPYmopIHt9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuICAgKiBAcmV0dXJuIHtvYmplY3R9IGNvbmZpZ09iaiBUaGUgY29uZmlndXJhdGlvbiBvYmplY3QgY29udGFpbmluZyB2YXJpb3VzIGV4dGVuc2lvbiBvcHRpb25zXG4gICAqL1xuICBnZXRDb25maWcgKCkge1xuICAgIHJldHVybiB7XG4gICAgICBjYWxlbmRhclZpc2libGU6ICdmYWxzZSdcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAqL1xuICBpbml0IChyZXF1aXJlKSB7XG4gICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICByZXF1aXJlKFtcbiAgICAgICd4QXhpcycsXG4gICAgICAneUF4aXMnLFxuICAgICAgJ2dyYXBoaWNzJyxcbiAgICAgICdjaGFydCcsXG4gICAgICAnZGF0YXNldCcsXG4gICAgICAnUGxvdE1hbmFnZXInLFxuICAgICAgJ2NhbnZhc0NvbmZpZycsXG4gICAgICAnTWFya2VyTWFuYWdlcicsXG4gICAgICAncmVhY3RpdmVNb2RlbCcsXG4gICAgICAnZ2xvYmFsUmVhY3RpdmVNb2RlbCcsXG4gICAgICAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLFxuICAgICAgJ3NtYXJ0TGFiZWwnLFxuICAgICAgZnVuY3Rpb24gKFxuICAgICAgICAgICAgeEF4aXMsXG4gICAgICAgICAgICB5QXhpcyxcbiAgICAgICAgICAgIGdyYXBoaWNzLFxuICAgICAgICAgICAgY2hhcnQsXG4gICAgICAgICAgICBkYXRhc2V0LFxuICAgICAgICAgICAgcGxvdE1hbmFnZXIsXG4gICAgICAgICAgICBjYW52YXNDb25maWcsXG4gICAgICAgICAgICBtYXJrZXJNYW5hZ2VyLFxuICAgICAgICAgICAgcmVhY3RpdmVNb2RlbCxcbiAgICAgICAgICAgIGdsb2JhbFJlYWN0aXZlTW9kZWwsXG4gICAgICAgICAgICBzcGFjZU1hbmFnZXJJbnN0YW5jZSxcbiAgICAgICAgICAgIHNtYXJ0TGFiZWwpIHtcbiAgICAgICAgaW5zdGFuY2UueEF4aXMgPSB4QXhpcztcbiAgICAgICAgaW5zdGFuY2UueUF4aXMgPSB5QXhpcztcbiAgICAgICAgaW5zdGFuY2UuZ3JhcGhpY3MgPSBncmFwaGljcztcbiAgICAgICAgaW5zdGFuY2UuY2hhcnQgPSBjaGFydDtcbiAgICAgICAgaW5zdGFuY2UuZGF0YXNldCA9IGRhdGFzZXQ7XG4gICAgICAgIGluc3RhbmNlLnBsb3RNYW5hZ2VyID0gcGxvdE1hbmFnZXI7XG4gICAgICAgIGluc3RhbmNlLm1hcmtlck1hbmFnZXIgPSBtYXJrZXJNYW5hZ2VyO1xuICAgICAgICBpbnN0YW5jZS5jYW52YXNDb25maWcgPSBjYW52YXNDb25maWc7XG4gICAgICAgIGluc3RhbmNlLnJlYWN0aXZlTW9kZWwgPSByZWFjdGl2ZU1vZGVsO1xuICAgICAgICBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsID0gZ2xvYmFsUmVhY3RpdmVNb2RlbDtcbiAgICAgICAgaW5zdGFuY2Uuc3BhY2VNYW5hZ2VySW5zdGFuY2UgPSBzcGFjZU1hbmFnZXJJbnN0YW5jZTtcbiAgICAgICAgaW5zdGFuY2Uuc21hcnRMYWJlbCA9IHNtYXJ0TGFiZWw7XG4gICAgICB9XG4gICAgXSk7XG4gICAgdGhpcy5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlO1xuICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWw7XG4gICAgdGhpcy5zdGFydER0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXTtcbiAgICB0aGlzLmVuZER0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG4gICAgdGhpcy5zdGFydERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2Utc3RhcnQnXTtcbiAgICB0aGlzLmVuZERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ107XG4gICAgdGhpcy50b29sYmFycyA9IFtdO1xuICAgIHRoaXMubWVhc3VyZW1lbnQgPSB7fTtcbiAgICB0aGlzLnRvb2xiYXJzLnB1c2godGhpcy5jcmVhdGVUb29sYmFyKCkpO1xuICAgIGNvbnNvbGUubG9nKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLmRhdGVTdGFydCwgdGhpcy5kYXRlRW5kKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBjcmVhdGVUb29sYmFyICgpIHtcbiAgICB2YXIgdG9vbGJhcixcbiAgICAgIGZyb21EYXRlLFxuICAgICAgdG9EYXRlLFxuICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICBmcm9tRGF0ZUxhYmVsLFxuICAgICAgdG9EYXRlTGFiZWwsXG4gICAgICBncm91cCxcbiAgICAgIGZyb21Gb3JtYXR0ZWREYXRlLFxuICAgICAgdG9Gb3JtYXR0ZWREYXRlO1xuXG4gICAgZnJvbUZvcm1hdHRlZERhdGUgPSAobmV3IERhdGUodGhpcy5zdGFydER0KS5nZXRVVENNb250aCgpICsgMSkgKyAnLScgK1xuICAgICAgbmV3IERhdGUodGhpcy5zdGFydER0KS5nZXRVVENEYXRlKCkgKyAnLScgKyBuZXcgRGF0ZSh0aGlzLnN0YXJ0RHQpLmdldFVUQ0Z1bGxZZWFyKCk7XG5cbiAgICB0b0Zvcm1hdHRlZERhdGUgPSBuZXcgRGF0ZSh0aGlzLmVuZER0KS5nZXRVVENNb250aCgpICsgJy0nICtcbiAgICAgIChuZXcgRGF0ZSh0aGlzLmVuZER0KS5nZXRVVENEYXRlKCkgKyAxKSArICctJyArIG5ldyBEYXRlKHRoaXMuZW5kRHQpLmdldFVUQ0Z1bGxZZWFyKCk7XG5cbiAgICB0b29sYmFyID0gbmV3IHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIoe1xuICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgIH0pO1xuXG4gICAgdG9vbGJhci5zZXRDb25maWcoe1xuICAgICAgZmlsbDogJyNmZmYnLFxuICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgfSk7XG5cbiAgICBncm91cCA9IG5ldyB0aGlzLnRvb2xib3guQ29tcG9uZW50R3JvdXAoe1xuICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgIH0pO1xuXG4gICAgZ3JvdXAuc2V0Q29uZmlnKHtcbiAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuICAgIH0pO1xuXG4gICAgZnJvbURhdGVMYWJlbCA9IG5ldyB0aGlzLnRvb2xib3guTGFiZWwoJ0Zyb206Jywge1xuICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXJcbiAgICB9LCB7XG4gICAgICB0ZXh0OiB7XG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgJ2ZvbnQtc2l6ZSc6ICcxNScsXG4gICAgICAgICAgJ2ZvbnRGYW1pbHknOiAnTXlyaWFkUHJvJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBmcm9tRGF0ZSA9IG5ldyB0aGlzLnRvb2xib3guSW5wdXRUZXh0Qm94U3ltYm9sKHtcbiAgICAgIHdpZHRoOiAxMjAsXG4gICAgICBoZWlnaHQ6IDI1XG4gICAgfSwge1xuICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgIH0sIHtcbiAgICAgIHN0cm9rZVdpZHRoOiAxLFxuICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcbiAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAwLFxuICAgICAgYnRuVGV4dFN0eWxlOiB7XG4gICAgICAgIGZvbnRTaXplOiAxNFxuICAgICAgfSxcbiAgICAgIGxhYmVsOiBmcm9tRm9ybWF0dGVkRGF0ZVxuICAgIH0pO1xuXG4gICAgdG9EYXRlTGFiZWwgPSBuZXcgdGhpcy50b29sYm94LkxhYmVsKCdUbzonLCB7XG4gICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlclxuICAgIH0sIHtcbiAgICAgIHRleHQ6IHtcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAnZm9udC1zaXplJzogJzE1JyxcbiAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRvRGF0ZSA9IG5ldyB0aGlzLnRvb2xib3guSW5wdXRUZXh0Qm94U3ltYm9sKHtcbiAgICAgIHdpZHRoOiAxMjAsXG4gICAgICBoZWlnaHQ6IDI1XG4gICAgfSwge1xuICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgIH0sIHtcbiAgICAgIHN0cm9rZVdpZHRoOiAxLFxuICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcbiAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAwLFxuICAgICAgYnRuVGV4dFN0eWxlOiB7XG4gICAgICAgIGZvbnRTaXplOiAxNFxuICAgICAgfSxcbiAgICAgIGxhYmVsOiB0b0Zvcm1hdHRlZERhdGVcbiAgICB9KTtcblxuICAgIGZyb21EYXRlLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgY2xpY2s6IHtcbiAgICAgICAgZm46IGZyb21EYXRlLmVkaXRcbiAgICAgIH0sXG4gICAgICB0ZXh0T25CbHVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZyb21EYXRlLmJsdXIoKTtcbiAgICAgICAgc2VsZi5zdGFydERhdGUgPSBmcm9tRGF0ZS5nZXRUZXh0KCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGZyb21EYXRlLmdldFRleHQoKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0b0RhdGUuYXR0YWNoRXZlbnRIYW5kbGVycyh7XG4gICAgICBjbGljazoge1xuICAgICAgICBmbjogdG9EYXRlLmVkaXRcbiAgICAgIH0sXG4gICAgICB0ZXh0T25CbHVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRvRGF0ZS5ibHVyKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRvRGF0ZS5nZXRUZXh0KCkpO1xuICAgICAgICBzZWxmLmVuZERhdGUgPSB0b0RhdGUuZ2V0VGV4dCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5TeW1ib2xTdG9yZS5yZWdpc3RlcigndGV4dEJveEljb24nLCBmdW5jdGlvbiAoeCwgeSwgcmFkLCB3LCBoLCBwYWRYLCBwYWRZKSB7XG4gICAgICB2YXIgeDEgPSB4IC0gdyAvIDIgKyBwYWRYIC8gMixcbiAgICAgICAgeDIgPSB4ICsgdyAvIDIgLSBwYWRYIC8gMixcbiAgICAgICAgeTEgPSB5IC0gaCAvIDIgKyBwYWRZIC8gMixcbiAgICAgICAgeTIgPSB5ICsgaCAvIDIgLSBwYWRZIC8gMjtcblxuICAgICAgcmV0dXJuIFsnTScsIHgxLCB5MSwgJ0wnLCB4MiwgeTEsICdMJywgeDIsIHkyLCAnTCcsIHgxLCB5MiwgJ1onXTtcbiAgICB9KTtcblxuICAgIGdyb3VwLmFkZFN5bWJvbChmcm9tRGF0ZUxhYmVsKTtcbiAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGUpO1xuICAgIGdyb3VwLmFkZFN5bWJvbCh0b0RhdGVMYWJlbCk7XG4gICAgZ3JvdXAuYWRkU3ltYm9sKHRvRGF0ZSk7XG4gICAgdG9vbGJhci5hZGRDb21wb25lbnQoZ3JvdXApO1xuICAgIHJldHVybiB0b29sYmFyO1xuICB9O1xuXG4gIGdldExvZ2ljYWxTcGFjZSAoYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCkge1xuICAgIGF2YWlsYWJsZVdpZHRoIC89IDI7XG4gICAgdmFyIGxvZ2ljYWxTcGFjZSxcbiAgICAgIHdpZHRoID0gMCxcbiAgICAgIGhlaWdodCA9IDAsXG4gICAgICBpLFxuICAgICAgbG47XG5cbiAgICBmb3IgKGkgPSAwLCBsbiA9IHRoaXMudG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuICAgICAgbG9naWNhbFNwYWNlID0gdGhpcy50b29sYmFyc1tpXS5nZXRMb2dpY2FsU3BhY2UoKTtcbiAgICAgIHdpZHRoID0gTWF0aC5tYXgobG9naWNhbFNwYWNlLndpZHRoLCB3aWR0aCk7XG4gICAgICBoZWlnaHQgKz0gbG9naWNhbFNwYWNlLmhlaWdodDtcbiAgICAgIHRoaXMudG9vbGJhcnNbaV0ud2lkdGggPSBsb2dpY2FsU3BhY2Uud2lkdGg7XG4gICAgICB0aGlzLnRvb2xiYXJzW2ldLmhlaWdodCA9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG4gICAgfVxuICAgIGhlaWdodCArPSB0aGlzLnBhZGRpbmc7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB3aWR0aCA+IGF2YWlsYWJsZVdpZHRoID8gMCA6IHdpZHRoLFxuICAgICAgaGVpZ2h0OiBoZWlnaHQgPiBhdmFpbGFibGVIZWlnaHQgPyAwIDogaGVpZ2h0XG4gICAgfTtcbiAgfTtcblxuICBwbGFjZUluQ2FudmFzICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5wYWRkaW5nID0gNTtcbiAgICBzZWxmLnNwYWNlTWFuYWdlckluc3RhbmNlLmFkZChbe1xuICAgICAgbmFtZTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gJ1Rvb2xCb3hFeHQnO1xuICAgICAgfSxcbiAgICAgIHJlZjogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqWycwJ107XG4gICAgICB9LFxuICAgICAgc2VsZjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZjtcbiAgICAgIH0sXG4gICAgICBwcmlvcml0eTogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMjtcbiAgICAgIH0sXG4gICAgICBsYXlvdXQ6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iai5pbmxpbmU7XG4gICAgICB9LFxuICAgICAgb3JpZW50YXRpb246IFt7XG4gICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICByZXR1cm4gb2JqLmhvcml6b250YWw7XG4gICAgICAgIH0sXG4gICAgICAgIHBvc2l0aW9uOiBbe1xuICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBvYmoudG9wO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYWxpZ25tZW50OiBbe1xuICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICByZXR1cm4gb2JqLmxlZnQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGltZW5zaW9uczogW2Z1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuZ2V0UGFyZW50Q29tcG9uZW50R3JvdXAoKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0TG9naWNhbFNwYWNlKHBhcmVudC5nZXRXaWR0aCgpLCBwYXJlbnQuZ2V0SGVpZ2h0KCkpO1xuICAgICAgICAgICAgfV1cbiAgICAgICAgICB9XVxuICAgICAgICB9XVxuICAgICAgfV1cbiAgICB9XSk7XG4gIH07XG5cbiAgc2V0RHJhd2luZ0NvbmZpZ3VyYXRpb24gKHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG4gICAgdmFyIG1lcyA9IHRoaXMubWVhc3VyZW1lbnQ7XG4gICAgbWVzLnggPSB4O1xuICAgIG1lcy55ID0geTtcbiAgICBtZXMud2lkdGggPSB3aWR0aDtcbiAgICBtZXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgdGhpcy5wYXJlbnRHcm91cCA9IGdyb3VwO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgZHJhdyAoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcbiAgICB2YXIgbWVhc3VyZW1lbnQgPSB0aGlzLm1lYXN1cmVtZW50LFxuICAgICAgdG9vbGJhcnMgPSB0aGlzLnRvb2xiYXJzLFxuICAgICAgbG4sXG4gICAgICBpLFxuICAgICAgdG9vbGJhcjtcblxuICAgIHggPSB4ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC54IDogeDtcbiAgICB5ID0geSA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQueSA6IHk7XG4gICAgd2lkdGggPSB3aWR0aCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQud2lkdGggOiB3aWR0aDtcbiAgICBoZWlnaHQgPSBoZWlnaHQgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LmhlaWdodCA6IGhlaWdodDtcbiAgICBncm91cCA9IGdyb3VwID09PSB1bmRlZmluZWQgPyB0aGlzLnBhcmVudEdyb3VwIDogZ3JvdXA7XG4gICAgaWYgKHdpZHRoICYmIGhlaWdodCkge1xuICAgICAgZm9yIChpID0gMCwgbG4gPSB0b29sYmFycy5sZW5ndGg7IGkgPCBsbjsgaSsrKSB7XG4gICAgICAgIHRvb2xiYXIgPSB0b29sYmFyc1tpXTtcbiAgICAgICAgdG9vbGJhci5kcmF3KHgsIHkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBEYXRlUmFuZ2U7XG59IGVsc2Uge1xuICB3aW5kb3cuU3RhbmRhcmRQZXJpb2QgPSBEYXRlUmFuZ2U7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvZmN0cy1leHQtZGF0ZXJhbmdlLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==
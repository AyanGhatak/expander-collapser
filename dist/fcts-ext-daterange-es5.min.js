!function(t){function e(o){if(a[o])return a[o].exports;var n=a[o]={exports:{},id:o,loaded:!1};return t[o].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=a(2);window.dr=new o,function(a,o){"object"===e(t)&&t.exports?t.exports=a.document?o(a):function(t){if(!t.document)throw new Error("Window with document not present");return o(t,!0)}:a.DateRangeChooser=o(a,!0)}("undefined"!=typeof window?window:void 0,function(t,e){var a=t.FusionCharts;a.register("extension",["private","DateRangeChooser",function(){a.registerComponent("extensions","DateRangeChooser",o({FusionCharts:a}))}])})}).call(e,a(1)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,a,o){return a&&t(e.prototype,a),o&&t(e,o),e}}();t.exports=function(t){var e=function(){function t(){a(this,t),this.startDt=0,this.endDt=0,this.startDataset=0,this.endDataset=0,this.toolbox=FusionCharts.getComponent("api","toolbox"),this.HorizontalToolbar=this.toolbox.HorizontalToolbar,this.ComponentGroup=this.toolbox.ComponentGroup,this.SymbolStore=this.toolbox.SymbolStore,this.startText={attr:function(){}},this.endText={attr:function(){}}}return o(t,[{key:"swapDates",value:function(){var t=this.dateRange.startDate;this.dateRange.startDate=this.dateRange.endDate,this.dateRange.endDate=t}},{key:"syncRange",value:function(){}},{key:"getFormattedDate",value:function(t){return this.chart.getFormattedDate(t)}},{key:"getTimestamp",value:function(t){return this.chart.getTimestamp(t)}},{key:"setConfig",value:function(t){}},{key:"getConfig",value:function(){return{calendarVisible:"false"}}},{key:"init",value:function(t){var e=this;return t(["xAxis","yAxis","graphics","chart","dataset","PlotManager","canvasConfig","MarkerManager","reactiveModel","globalReactiveModel","spaceManagerInstance","smartLabel","chartInstance",function(t,a,o,n,r,i,s,l,h,c,u,f){e.xAxis=t,e.yAxis=a,e.graphics=o,e.chart=n,e.dataset=r,e.plotManager=i,e.markerManager=l,e.canvasConfig=s,e.reactiveModel=h,e.globalReactiveModel=c,e.spaceManagerInstance=u,e.smartLabel=f}]),this.spaceManagerInstance=e.spaceManagerInstance,this.globalReactiveModel=e.globalReactiveModel,this.startDt=e.globalReactiveModel.model["x-axis-visible-range-start"],this.endDt=e.globalReactiveModel.model["x-axis-visible-range-end"],this.startDataset=e.globalReactiveModel.model["x-axis-absolute-range-start"],this.endDataset=e.globalReactiveModel.model["x-axis-absolute-range-end"],this.toolbars=[],this.measurement={},this.toolbars.push(this.createToolbar()),this}},{key:"createToolbar",value:function(){var t,e,a,o,n,r,i=this;return i.fromDate={},i.toDate={},n=new Date(this.startDt).toLocaleDateString(),r=new Date(this.endDt).toLocaleDateString(),t=new this.HorizontalToolbar({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),t.setConfig({fill:"#fff",borderThickness:0}),o=new this.toolbox.ComponentGroup({paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container}),o.setConfig({fill:"#fff",borderThickness:0}),e=new this.toolbox.Label("From:",{smartLabel:this.smartLabel,paper:this.graphics.paper},{text:{style:{"font-size":"15",fontFamily:"MyriadPro"}}}),i.fromDate=new this.toolbox.InputTextBoxSymbol({width:120,height:25},{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},{strokeWidth:1,stroke:"rgba(102,102,102,0.5)",symbolStrokeWidth:0,btnTextStyle:{fontSize:14},label:n}),a=new this.toolbox.Label("To:",{smartLabel:this.smartLabel,paper:this.graphics.paper},{text:{style:{"font-size":"15",fontFamily:"MyriadPro"}}}),i.toDate=new this.toolbox.InputTextBoxSymbol({width:120,height:25},{paper:this.graphics.paper,chart:this.chart,smartLabel:this.smartLabel,chartContainer:this.graphics.container},{strokeWidth:1,stroke:"rgba(102,102,102,0.5)",symbolStrokeWidth:0,btnTextStyle:{fontSize:14},label:r}),i.fromDate.attachEventHandlers({click:{fn:i.fromDate.edit},textOnBlur:function(){i.fromDate.blur(),i.startDate=i.fromDate.getText(),console.log(i.fromDate.getText())}}),i.toDate.attachEventHandlers({click:{fn:i.toDate.edit},textOnBlur:function(){i.toDate.blur(),console.log(i.toDate.getText()),i.endDate=i.toDate.getText()}}),this.SymbolStore.register("textBoxIcon",function(t,e,a,o,n,r,i){var s=t-o/2+r/2,l=t+o/2-r/2,h=e-n/2+i/2,c=e+n/2-i/2;return["M",s,h,"L",l,h,"L",l,c,"L",s,c,"Z"]}),o.addSymbol(e),o.addSymbol(i.fromDate),o.addSymbol(a),o.addSymbol(i.toDate),t.addComponent(o),t}},{key:"getLogicalSpace",value:function(t,e){t/=2;var a,o,n,r=0,i=0;for(o=0,n=this.toolbars.length;o<n;o++)a=this.toolbars[o].getLogicalSpace(t,e),r=Math.max(a.width,r),i+=a.height,this.toolbars[o].width=a.width,this.toolbars[o].height=a.height;return i+=this.padding,{width:r,height:i}}},{key:"placeInCanvas",value:function(){var t=this;t.padding=5,t.spaceManagerInstance.add([{name:function(){return"ToolBoxExt"},ref:function(t){return t[0]},self:function(){return t},priority:function(){return 2},layout:function(t){return t.inline},orientation:[{type:function(t){return t.horizontal},position:[{type:function(t){return t.top},alignment:[{type:function(t){return t.left},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(t,e,a,o,n){var r=this.measurement;return r.x=t,r.y=e,r.width=a,r.height=o,this.parentGroup=n,this}},{key:"draw",value:function(t,e,a,o,n){var r,i,s,l=this.measurement,h=this.toolbars,c=this.globalReactiveModel,u=this;if(console.log(c),t=void 0===t?l.x:t,e=void 0===e?l.y:e,a=void 0===a?l.width:a,o=void 0===o?l.height:o,n=void 0===n?this.parentGroup:n,a&&o)for(i=0,r=h.length;i<r;i++)s=h[i],s.draw(t,e,n);c.onPropsChange(["x-axis-visible-range-start","x-axis-visible-range-end"],function(t,e){u.fromDate.blur(new Date(t[1]).toLocaleDateString()),u.toDate.blur(new Date(e[1]).toLocaleDateString())})}},{key:"startDate",get:function(){return this.startDt},set:function(t){var e=+new Date(t);e<=this.endDt&&(this.startDt=e,this.globalReactiveModel.model["x-axis-visible-range-start"]=this.startDt)}},{key:"endDate",get:function(){return this.endDt},set:function(t){var e=+new Date(t);e>=this.startDt&&(this.endDt=e,this.globalReactiveModel.model["x-axis-visible-range-end"]=this.endDt)}}]),t}();return e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGExYjNjYjQ4ZTJkNjE1YmI1NWNiIiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy8uL3NyYy9mY3RzLWV4dC1kYXRlcmFuZ2UuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX3R5cGVvZiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwib2JqIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJEYXRlUmFuZ2UiLCJ3aW5kb3ciLCJkciIsImVudiIsImZhY3RvcnkiLCJkb2N1bWVudCIsIndpbiIsIkVycm9yIiwiRGF0ZVJhbmdlQ2hvb3NlciIsInVuZGVmaW5lZCIsIl93aW5kb3ciLCJ3aW5kb3dFeGlzdHMiLCJGQyIsIkZ1c2lvbkNoYXJ0cyIsInJlZ2lzdGVyIiwicmVnaXN0ZXJDb21wb25lbnQiLCJ3ZWJwYWNrUG9seWZpbGwiLCJkZXByZWNhdGUiLCJwYXRocyIsImNoaWxkcmVuIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJkZXAiLCJ0aGlzIiwic3RhcnREdCIsImVuZER0Iiwic3RhcnREYXRhc2V0IiwiZW5kRGF0YXNldCIsInRvb2xib3giLCJnZXRDb21wb25lbnQiLCJIb3Jpem9udGFsVG9vbGJhciIsIkNvbXBvbmVudEdyb3VwIiwiU3ltYm9sU3RvcmUiLCJzdGFydFRleHQiLCJhdHRyIiwiZW5kVGV4dCIsInZhbHVlIiwidGVtcCIsImRhdGVSYW5nZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJ0aW1lc3RhbXAiLCJjaGFydCIsImdldEZvcm1hdHRlZERhdGUiLCJkYXRlU3RyaW5nIiwiZ2V0VGltZXN0YW1wIiwiY29uZmlnT2JqIiwiY2FsZW5kYXJWaXNpYmxlIiwicmVxdWlyZSIsInhBeGlzIiwieUF4aXMiLCJncmFwaGljcyIsImRhdGFzZXQiLCJwbG90TWFuYWdlciIsImNhbnZhc0NvbmZpZyIsIm1hcmtlck1hbmFnZXIiLCJyZWFjdGl2ZU1vZGVsIiwiZ2xvYmFsUmVhY3RpdmVNb2RlbCIsInNwYWNlTWFuYWdlckluc3RhbmNlIiwic21hcnRMYWJlbCIsIm1vZGVsIiwidG9vbGJhcnMiLCJtZWFzdXJlbWVudCIsInB1c2giLCJjcmVhdGVUb29sYmFyIiwidG9vbGJhciIsImZyb21EYXRlTGFiZWwiLCJ0b0RhdGVMYWJlbCIsImdyb3VwIiwiZnJvbUZvcm1hdHRlZERhdGUiLCJ0b0Zvcm1hdHRlZERhdGUiLCJzZWxmIiwiZnJvbURhdGUiLCJ0b0RhdGUiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwicGFwZXIiLCJjaGFydENvbnRhaW5lciIsImNvbnRhaW5lciIsInNldENvbmZpZyIsImZpbGwiLCJib3JkZXJUaGlja25lc3MiLCJMYWJlbCIsInRleHQiLCJzdHlsZSIsImZvbnQtc2l6ZSIsImZvbnRGYW1pbHkiLCJJbnB1dFRleHRCb3hTeW1ib2wiLCJ3aWR0aCIsImhlaWdodCIsInN0cm9rZVdpZHRoIiwic3Ryb2tlIiwic3ltYm9sU3Ryb2tlV2lkdGgiLCJidG5UZXh0U3R5bGUiLCJmb250U2l6ZSIsImxhYmVsIiwiYXR0YWNoRXZlbnRIYW5kbGVycyIsImNsaWNrIiwiZm4iLCJlZGl0IiwidGV4dE9uQmx1ciIsImJsdXIiLCJnZXRUZXh0IiwiY29uc29sZSIsImxvZyIsIngiLCJ5IiwicmFkIiwidyIsImgiLCJwYWRYIiwicGFkWSIsIngxIiwieDIiLCJ5MSIsInkyIiwiYWRkU3ltYm9sIiwiYWRkQ29tcG9uZW50IiwiYXZhaWxhYmxlV2lkdGgiLCJhdmFpbGFibGVIZWlnaHQiLCJsb2dpY2FsU3BhY2UiLCJsbiIsImdldExvZ2ljYWxTcGFjZSIsIk1hdGgiLCJtYXgiLCJwYWRkaW5nIiwiYWRkIiwibmFtZSIsInJlZiIsInByaW9yaXR5IiwibGF5b3V0IiwiaW5saW5lIiwib3JpZW50YXRpb24iLCJ0eXBlIiwiaG9yaXpvbnRhbCIsInBvc2l0aW9uIiwidG9wIiwiYWxpZ25tZW50IiwibGVmdCIsImRpbWVuc2lvbnMiLCJwYXJlbnQiLCJnZXRQYXJlbnRDb21wb25lbnRHcm91cCIsImdldFdpZHRoIiwiZ2V0SGVpZ2h0IiwibWVzIiwicGFyZW50R3JvdXAiLCJkcmF3Iiwib25Qcm9wc0NoYW5nZSIsInN0YXJ0IiwiZW5kIiwiZ2V0Iiwic2V0Iiwic3RhcnRUaW1lc3RhbXAiLCJlbmRUaW1lc3RhbXAiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxRQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBcUNBLE9BVEFGLEdBQUFRLEVBQUFULEVBR0FDLEVBQUFTLEVBQUFQLEVBR0FGLEVBQUFVLEVBQUEsR0FHQVYsRUFBQSxLRE1NLFNBQVNJLEVBQVFELEVBQVNILElFNUNoQyxTQUFBSSxHQUFBLFlGZ0RDLElBQUlPLEdBQTRCLGtCQUFYQyxT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QUFtSSxJQUFBLFdBNEIxQixNQUFPL0gsTUFBS0MsU0E1QmMrSCxJQUFBLFNBK0JiL0gsR0FDYixHQUFJZ0ksSUFBa0IsR0FBSTlFLE1BQUtsRCxFQUMzQmdJLElBQWtCakksS0FBS0UsUUFDekJGLEtBQUtDLFFBQVVnSSxFQUNmakksS0FBS2tDLG9CQUFvQkcsTUFBTSw4QkFBZ0NyQyxLQUFLQyxZQW5DNUNMLElBQUEsVUFBQW1JLElBQUEsV0F3QzFCLE1BQU8vSCxNQUFLRSxPQXhDYzhILElBQUEsU0EyQ2Y5SCxHQUNYLEdBQUlnSSxJQUFnQixHQUFJL0UsTUFBS2pELEVBQ3pCZ0ksSUFBZ0JsSSxLQUFLQyxVQUN2QkQsS0FBS0UsTUFBUWdJLEVBQ2JsSSxLQUFLa0Msb0JBQW9CRyxNQUFNLDRCQUE4QnJDLEtBQUtFLFdBL0MxQzFDLElBa1o5QixPQUFPQSIsImZpbGUiOiJmY3RzLWV4dC1kYXRlcmFuZ2UtZXM1Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKG1vZHVsZSkgeyd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblx0XG5cdHZhciBEYXRlUmFuZ2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0d2luZG93LmRyID0gbmV3IERhdGVSYW5nZSgpO1xuXHRcblx0OyhmdW5jdGlvbiAoZW52LCBmYWN0b3J5KSB7XG5cdCAgaWYgKCggZmFsc2UgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YobW9kdWxlKSkgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGVudi5kb2N1bWVudCA/IGZhY3RvcnkoZW52KSA6IGZ1bmN0aW9uICh3aW4pIHtcblx0ICAgICAgaWYgKCF3aW4uZG9jdW1lbnQpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dpbmRvdyB3aXRoIGRvY3VtZW50IG5vdCBwcmVzZW50Jyk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGZhY3Rvcnkod2luLCB0cnVlKTtcblx0ICAgIH07XG5cdCAgfSBlbHNlIHtcblx0ICAgIGVudi5EYXRlUmFuZ2VDaG9vc2VyID0gZmFjdG9yeShlbnYsIHRydWUpO1xuXHQgIH1cblx0fSkodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB1bmRlZmluZWQsIGZ1bmN0aW9uIChfd2luZG93LCB3aW5kb3dFeGlzdHMpIHtcblx0ICB2YXIgRkMgPSBfd2luZG93LkZ1c2lvbkNoYXJ0cztcblx0ICBGQy5yZWdpc3RlcignZXh0ZW5zaW9uJywgWydwcml2YXRlJywgJ0RhdGVSYW5nZUNob29zZXInLCBmdW5jdGlvbiAoKSB7XG5cdCAgICBGQy5yZWdpc3RlckNvbXBvbmVudCgnZXh0ZW5zaW9ucycsICdEYXRlUmFuZ2VDaG9vc2VyJywgRGF0ZVJhbmdlKHsgRnVzaW9uQ2hhcnRzOiBGQyB9KSk7XG5cdCAgfV0pO1xuXHR9KTtcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMSkobW9kdWxlKSkpXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRcdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XG5cdFx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcblx0XHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XG5cdFx0XHRtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0XHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHRcdH1cblx0XHRyZXR1cm4gbW9kdWxlO1xuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0LyoqXG5cdCAqIENsYXNzIHJlcHJlc2VudGluZyB0aGUgRGF0ZVJhbmdlLlxuXHQgKi9cblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZGVwKSB7XG5cdCAgdmFyIERhdGVSYW5nZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIERhdGVSYW5nZSgpIHtcblx0ICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERhdGVSYW5nZSk7XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICovXG5cdFxuXHQgICAgICB0aGlzLnN0YXJ0RHQgPSAwO1xuXHQgICAgICB0aGlzLmVuZER0ID0gMDtcblx0ICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSAwO1xuXHQgICAgICB0aGlzLmVuZERhdGFzZXQgPSAwO1xuXHQgICAgICB0aGlzLnRvb2xib3ggPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuXHQgICAgICB0aGlzLkhvcml6b250YWxUb29sYmFyID0gdGhpcy50b29sYm94Lkhvcml6b250YWxUb29sYmFyO1xuXHQgICAgICB0aGlzLkNvbXBvbmVudEdyb3VwID0gdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwO1xuXHQgICAgICB0aGlzLlN5bWJvbFN0b3JlID0gdGhpcy50b29sYm94LlN5bWJvbFN0b3JlO1xuXHQgICAgICB0aGlzLnN0YXJ0VGV4dCA9IHtcblx0ICAgICAgICBhdHRyOiBmdW5jdGlvbiBhdHRyKCkge31cblx0ICAgICAgfTtcblx0ICAgICAgdGhpcy5lbmRUZXh0ID0ge1xuXHQgICAgICAgIGF0dHI6IGZ1bmN0aW9uIGF0dHIoKSB7fVxuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc3RhcnQgYW5kIGVuZCBkYXRlcy5cblx0ICAgICAqIEB0eXBlIHtEYXRlUmFuZ2UucmFuZ2V9XG5cdCAgICAgKi9cblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKERhdGVSYW5nZSwgW3tcblx0ICAgICAga2V5OiAnc3dhcERhdGVzJyxcblx0XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogU3dhcHMgdGhlIHN0YXJ0IGRhdGUgYW5kIHRoZSBlbmQgZGF0ZSBvZiB0aGUgZGF0ZSByYW5nZVxuXHQgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgKi9cblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN3YXBEYXRlcygpIHtcblx0ICAgICAgICB2YXIgdGVtcCA9IHRoaXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZTtcblx0ICAgICAgICB0aGlzLmRhdGVSYW5nZS5zdGFydERhdGUgPSB0aGlzLmRhdGVSYW5nZS5lbmREYXRlO1xuXHQgICAgICAgIHRoaXMuZGF0ZVJhbmdlLmVuZERhdGUgPSB0ZW1wO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogU3luY3MgdGhlIGRhdGVyYW5nZSBzaG93biBieSB0aGUgRnVzaW9uQ2hhcnRzIHRpbWUgc2VyaWVzIGNoYXJ0IGFuZCB0aGUgRGF0ZSBSYW5nZSBDaG9vc2VyXG5cdCAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnc3luY1JhbmdlJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN5bmNSYW5nZSgpIHt9XG5cdFxuXHQgICAgICAvKipcblx0ICAgICAgICogUmV0dXJucyBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZyBmcm9tIEZ1c2lvbkNoYXJ0cyB3aGVuIGdpdmVuIGEgVU5JWCB0aW1lc3RhbXBcblx0ICAgICAgICogQHBhcmFtICB7bnVtYmVyfSB0aW1lc3RhbXAgLSBBIFVOSVggdGltZXN0YW1wIHRvIGJlIGNvbnZlcnRlZCB0byBhIGRhdGUgc3RyaW5nXG5cdCAgICAgICAqIEByZXR1cm4ge3N0cmluZ30gLSBBIGRhdGUgc3RyaW5nIHdoaWNoIGlzIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIHRpbWVzdGFtcFxuXHQgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2dldEZvcm1hdHRlZERhdGUnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Rm9ybWF0dGVkRGF0ZSh0aW1lc3RhbXApIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5jaGFydC5nZXRGb3JtYXR0ZWREYXRlKHRpbWVzdGFtcCk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBSZXR1cm5zIGEgVU5JWCB0aW1lc3RhbXAgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZ1xuXHQgICAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGRhdGVTdHJpbmcgLSBBIGRhdGUgc3RyaW5nIHRvIGJlIGNvbnZlcnRlZCB0byBhIFVOSVggdGltZXN0YW1wXG5cdCAgICAgICAqIEByZXR1cm4ge251bWJlcn0gQSBVTklYIHRpbWVzdGFtcCB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBkYXRlIHN0cmluZ1xuXHQgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2dldFRpbWVzdGFtcCcsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUaW1lc3RhbXAoZGF0ZVN0cmluZykge1xuXHQgICAgICAgIHJldHVybiB0aGlzLmNoYXJ0LmdldFRpbWVzdGFtcChkYXRlU3RyaW5nKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIFNldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuXHQgICAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnT2JqIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXh0ZW5zaW9uIG9wdGlvbnNcblx0ICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdzZXRDb25maWcnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q29uZmlnKGNvbmZpZ09iaikge31cblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBHZXRzIHRoZSBjb25maWd1cmFibGUgb3B0aW9ucyBvZiB0aGUgZXh0ZW5zaW9uIChlLmcuIGNvc21ldGljcylcblx0ICAgICAgICogQHJldHVybiB7b2JqZWN0fSBjb25maWdPYmogVGhlIGNvbmZpZ3VyYXRpb24gb2JqZWN0IGNvbnRhaW5pbmcgdmFyaW91cyBleHRlbnNpb24gb3B0aW9uc1xuXHQgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2dldENvbmZpZycsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb25maWcoKSB7XG5cdCAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgIGNhbGVuZGFyVmlzaWJsZTogJ2ZhbHNlJ1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBGdXNpb25jaGFydHMgbGlmZSBjeWNsZSBtZXRob2QgZm9yIGV4dGVuc2lvblxuXHQgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2luaXQnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdChyZXF1aXJlKSB7XG5cdCAgICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcblx0ICAgICAgICByZXF1aXJlKFsneEF4aXMnLCAneUF4aXMnLCAnZ3JhcGhpY3MnLCAnY2hhcnQnLCAnZGF0YXNldCcsICdQbG90TWFuYWdlcicsICdjYW52YXNDb25maWcnLCAnTWFya2VyTWFuYWdlcicsICdyZWFjdGl2ZU1vZGVsJywgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLCAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLCAnc21hcnRMYWJlbCcsICdjaGFydEluc3RhbmNlJywgZnVuY3Rpb24gKHhBeGlzLCB5QXhpcywgZ3JhcGhpY3MsIGNoYXJ0LCBkYXRhc2V0LCBwbG90TWFuYWdlciwgY2FudmFzQ29uZmlnLCBtYXJrZXJNYW5hZ2VyLCByZWFjdGl2ZU1vZGVsLCBnbG9iYWxSZWFjdGl2ZU1vZGVsLCBzcGFjZU1hbmFnZXJJbnN0YW5jZSwgc21hcnRMYWJlbCkge1xuXHQgICAgICAgICAgaW5zdGFuY2UueEF4aXMgPSB4QXhpcztcblx0ICAgICAgICAgIGluc3RhbmNlLnlBeGlzID0geUF4aXM7XG5cdCAgICAgICAgICBpbnN0YW5jZS5ncmFwaGljcyA9IGdyYXBoaWNzO1xuXHQgICAgICAgICAgaW5zdGFuY2UuY2hhcnQgPSBjaGFydDtcblx0ICAgICAgICAgIGluc3RhbmNlLmRhdGFzZXQgPSBkYXRhc2V0O1xuXHQgICAgICAgICAgaW5zdGFuY2UucGxvdE1hbmFnZXIgPSBwbG90TWFuYWdlcjtcblx0ICAgICAgICAgIGluc3RhbmNlLm1hcmtlck1hbmFnZXIgPSBtYXJrZXJNYW5hZ2VyO1xuXHQgICAgICAgICAgaW5zdGFuY2UuY2FudmFzQ29uZmlnID0gY2FudmFzQ29uZmlnO1xuXHQgICAgICAgICAgaW5zdGFuY2UucmVhY3RpdmVNb2RlbCA9IHJlYWN0aXZlTW9kZWw7XG5cdCAgICAgICAgICBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsID0gZ2xvYmFsUmVhY3RpdmVNb2RlbDtcblx0ICAgICAgICAgIGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlID0gc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG5cdCAgICAgICAgICBpbnN0YW5jZS5zbWFydExhYmVsID0gc21hcnRMYWJlbDtcblx0ICAgICAgICB9XSk7XG5cdCAgICAgICAgdGhpcy5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlO1xuXHQgICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWw7XG5cdCAgICAgICAgdGhpcy5zdGFydER0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnXTtcblx0ICAgICAgICB0aGlzLmVuZER0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgICAgdGhpcy5zdGFydERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2Utc3RhcnQnXTtcblx0ICAgICAgICB0aGlzLmVuZERhdGFzZXQgPSBpbnN0YW5jZS5nbG9iYWxSZWFjdGl2ZU1vZGVsLm1vZGVsWyd4LWF4aXMtYWJzb2x1dGUtcmFuZ2UtZW5kJ107XG5cdCAgICAgICAgdGhpcy50b29sYmFycyA9IFtdO1xuXHQgICAgICAgIHRoaXMubWVhc3VyZW1lbnQgPSB7fTtcblx0ICAgICAgICB0aGlzLnRvb2xiYXJzLnB1c2godGhpcy5jcmVhdGVUb29sYmFyKCkpO1xuXHQgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcblx0ICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmRhdGVTdGFydCwgdGhpcy5kYXRlRW5kKTtcblx0ICAgICAgICByZXR1cm4gdGhpcztcblx0ICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICBrZXk6ICdjcmVhdGVUb29sYmFyJyxcblx0ICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVRvb2xiYXIoKSB7XG5cdCAgICAgICAgdmFyIHRvb2xiYXIsXG5cdCAgICAgICAgICAgIHNlbGYgPSB0aGlzLFxuXHQgICAgICAgICAgICBmcm9tRGF0ZUxhYmVsLFxuXHQgICAgICAgICAgICB0b0RhdGVMYWJlbCxcblx0ICAgICAgICAgICAgZ3JvdXAsXG5cdCAgICAgICAgICAgIGZyb21Gb3JtYXR0ZWREYXRlLFxuXHQgICAgICAgICAgICB0b0Zvcm1hdHRlZERhdGU7XG5cdFxuXHQgICAgICAgIHNlbGYuZnJvbURhdGUgPSB7fTtcblx0ICAgICAgICBzZWxmLnRvRGF0ZSA9IHt9O1xuXHRcblx0ICAgICAgICBmcm9tRm9ybWF0dGVkRGF0ZSA9IG5ldyBEYXRlKHRoaXMuc3RhcnREdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG5cdFxuXHQgICAgICAgIHRvRm9ybWF0dGVkRGF0ZSA9IG5ldyBEYXRlKHRoaXMuZW5kRHQpLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xuXHRcblx0ICAgICAgICB0b29sYmFyID0gbmV3IHRoaXMuSG9yaXpvbnRhbFRvb2xiYXIoe1xuXHQgICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcblx0ICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICB0b29sYmFyLnNldENvbmZpZyh7XG5cdCAgICAgICAgICBmaWxsOiAnI2ZmZicsXG5cdCAgICAgICAgICBib3JkZXJUaGlja25lc3M6IDBcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgZ3JvdXAgPSBuZXcgdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwKHtcblx0ICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuXHQgICAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG5cdCAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgZ3JvdXAuc2V0Q29uZmlnKHtcblx0ICAgICAgICAgIGZpbGw6ICcjZmZmJyxcblx0ICAgICAgICAgIGJvcmRlclRoaWNrbmVzczogMFxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBmcm9tRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnRnJvbTonLCB7XG5cdCAgICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG5cdCAgICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlclxuXHQgICAgICAgIH0sIHtcblx0ICAgICAgICAgIHRleHQ6IHtcblx0ICAgICAgICAgICAgc3R5bGU6IHtcblx0ICAgICAgICAgICAgICAnZm9udC1zaXplJzogJzE1Jyxcblx0ICAgICAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgc2VsZi5mcm9tRGF0ZSA9IG5ldyB0aGlzLnRvb2xib3guSW5wdXRUZXh0Qm94U3ltYm9sKHtcblx0ICAgICAgICAgIHdpZHRoOiAxMjAsXG5cdCAgICAgICAgICBoZWlnaHQ6IDI1XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcblx0ICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICAgIH0sIHtcblx0ICAgICAgICAgIHN0cm9rZVdpZHRoOiAxLFxuXHQgICAgICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcblx0ICAgICAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAwLFxuXHQgICAgICAgICAgYnRuVGV4dFN0eWxlOiB7XG5cdCAgICAgICAgICAgIGZvbnRTaXplOiAxNFxuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGxhYmVsOiBmcm9tRm9ybWF0dGVkRGF0ZVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICB0b0RhdGVMYWJlbCA9IG5ldyB0aGlzLnRvb2xib3guTGFiZWwoJ1RvOicsIHtcblx0ICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyXG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgdGV4dDoge1xuXHQgICAgICAgICAgICBzdHlsZToge1xuXHQgICAgICAgICAgICAgICdmb250LXNpemUnOiAnMTUnLFxuXHQgICAgICAgICAgICAgICdmb250RmFtaWx5JzogJ015cmlhZFBybydcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBzZWxmLnRvRGF0ZSA9IG5ldyB0aGlzLnRvb2xib3guSW5wdXRUZXh0Qm94U3ltYm9sKHtcblx0ICAgICAgICAgIHdpZHRoOiAxMjAsXG5cdCAgICAgICAgICBoZWlnaHQ6IDI1XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG5cdCAgICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcblx0ICAgICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcblx0ICAgICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuXHQgICAgICAgIH0sIHtcblx0ICAgICAgICAgIHN0cm9rZVdpZHRoOiAxLFxuXHQgICAgICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcblx0ICAgICAgICAgIHN5bWJvbFN0cm9rZVdpZHRoOiAwLFxuXHQgICAgICAgICAgYnRuVGV4dFN0eWxlOiB7XG5cdCAgICAgICAgICAgIGZvbnRTaXplOiAxNFxuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGxhYmVsOiB0b0Zvcm1hdHRlZERhdGVcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgc2VsZi5mcm9tRGF0ZS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcblx0ICAgICAgICAgIGNsaWNrOiB7XG5cdCAgICAgICAgICAgIGZuOiBzZWxmLmZyb21EYXRlLmVkaXRcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICB0ZXh0T25CbHVyOiBmdW5jdGlvbiB0ZXh0T25CbHVyKCkge1xuXHQgICAgICAgICAgICBzZWxmLmZyb21EYXRlLmJsdXIoKTtcblx0ICAgICAgICAgICAgc2VsZi5zdGFydERhdGUgPSBzZWxmLmZyb21EYXRlLmdldFRleHQoKTtcblx0ICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5mcm9tRGF0ZS5nZXRUZXh0KCkpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBzZWxmLnRvRGF0ZS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcblx0ICAgICAgICAgIGNsaWNrOiB7XG5cdCAgICAgICAgICAgIGZuOiBzZWxmLnRvRGF0ZS5lZGl0XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgdGV4dE9uQmx1cjogZnVuY3Rpb24gdGV4dE9uQmx1cigpIHtcblx0ICAgICAgICAgICAgc2VsZi50b0RhdGUuYmx1cigpO1xuXHQgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLnRvRGF0ZS5nZXRUZXh0KCkpO1xuXHQgICAgICAgICAgICBzZWxmLmVuZERhdGUgPSBzZWxmLnRvRGF0ZS5nZXRUZXh0KCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHRoaXMuU3ltYm9sU3RvcmUucmVnaXN0ZXIoJ3RleHRCb3hJY29uJywgZnVuY3Rpb24gKHgsIHksIHJhZCwgdywgaCwgcGFkWCwgcGFkWSkge1xuXHQgICAgICAgICAgdmFyIHgxID0geCAtIHcgLyAyICsgcGFkWCAvIDIsXG5cdCAgICAgICAgICAgICAgeDIgPSB4ICsgdyAvIDIgLSBwYWRYIC8gMixcblx0ICAgICAgICAgICAgICB5MSA9IHkgLSBoIC8gMiArIHBhZFkgLyAyLFxuXHQgICAgICAgICAgICAgIHkyID0geSArIGggLyAyIC0gcGFkWSAvIDI7XG5cdFxuXHQgICAgICAgICAgcmV0dXJuIFsnTScsIHgxLCB5MSwgJ0wnLCB4MiwgeTEsICdMJywgeDIsIHkyLCAnTCcsIHgxLCB5MiwgJ1onXTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgZ3JvdXAuYWRkU3ltYm9sKGZyb21EYXRlTGFiZWwpO1xuXHQgICAgICAgIGdyb3VwLmFkZFN5bWJvbChzZWxmLmZyb21EYXRlKTtcblx0ICAgICAgICBncm91cC5hZGRTeW1ib2wodG9EYXRlTGFiZWwpO1xuXHQgICAgICAgIGdyb3VwLmFkZFN5bWJvbChzZWxmLnRvRGF0ZSk7XG5cdCAgICAgICAgdG9vbGJhci5hZGRDb21wb25lbnQoZ3JvdXApO1xuXHQgICAgICAgIHJldHVybiB0b29sYmFyO1xuXHQgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2dldExvZ2ljYWxTcGFjZScsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMb2dpY2FsU3BhY2UoYXZhaWxhYmxlV2lkdGgsIGF2YWlsYWJsZUhlaWdodCkge1xuXHQgICAgICAgIGF2YWlsYWJsZVdpZHRoIC89IDI7XG5cdCAgICAgICAgdmFyIGxvZ2ljYWxTcGFjZSxcblx0ICAgICAgICAgICAgd2lkdGggPSAwLFxuXHQgICAgICAgICAgICBoZWlnaHQgPSAwLFxuXHQgICAgICAgICAgICBpLFxuXHQgICAgICAgICAgICBsbjtcblx0XG5cdCAgICAgICAgZm9yIChpID0gMCwgbG4gPSB0aGlzLnRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcblx0ICAgICAgICAgIGxvZ2ljYWxTcGFjZSA9IHRoaXMudG9vbGJhcnNbaV0uZ2V0TG9naWNhbFNwYWNlKGF2YWlsYWJsZVdpZHRoLCBhdmFpbGFibGVIZWlnaHQpO1xuXHQgICAgICAgICAgd2lkdGggPSBNYXRoLm1heChsb2dpY2FsU3BhY2Uud2lkdGgsIHdpZHRoKTtcblx0ICAgICAgICAgIGhlaWdodCArPSBsb2dpY2FsU3BhY2UuaGVpZ2h0O1xuXHQgICAgICAgICAgdGhpcy50b29sYmFyc1tpXS53aWR0aCA9IGxvZ2ljYWxTcGFjZS53aWR0aDtcblx0ICAgICAgICAgIHRoaXMudG9vbGJhcnNbaV0uaGVpZ2h0ID0gbG9naWNhbFNwYWNlLmhlaWdodDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaGVpZ2h0ICs9IHRoaXMucGFkZGluZztcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuXHQgICAgICAgICAgaGVpZ2h0OiBoZWlnaHRcblx0ICAgICAgICB9O1xuXHQgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ3BsYWNlSW5DYW52YXMnLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gcGxhY2VJbkNhbnZhcygpIHtcblx0ICAgICAgICB2YXIgX3NlbGYgPSB0aGlzO1xuXHQgICAgICAgIF9zZWxmLnBhZGRpbmcgPSA1O1xuXHQgICAgICAgIF9zZWxmLnNwYWNlTWFuYWdlckluc3RhbmNlLmFkZChbe1xuXHQgICAgICAgICAgbmFtZTogZnVuY3Rpb24gbmFtZSgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuICdUb29sQm94RXh0Jztcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICByZWY6IGZ1bmN0aW9uIHJlZihvYmopIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG9ialsnMCddO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIHNlbGY6IGZ1bmN0aW9uIHNlbGYoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBfc2VsZjtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBwcmlvcml0eTogZnVuY3Rpb24gcHJpb3JpdHkoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiAyO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGxheW91dDogZnVuY3Rpb24gbGF5b3V0KG9iaikge1xuXHQgICAgICAgICAgICByZXR1cm4gb2JqLmlubGluZTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBvcmllbnRhdGlvbjogW3tcblx0ICAgICAgICAgICAgdHlwZTogZnVuY3Rpb24gdHlwZShvYmopIHtcblx0ICAgICAgICAgICAgICByZXR1cm4gb2JqLmhvcml6b250YWw7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIHBvc2l0aW9uOiBbe1xuXHQgICAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIHR5cGUob2JqKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gb2JqLnRvcDtcblx0ICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgIGFsaWdubWVudDogW3tcblx0ICAgICAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIHR5cGUob2JqKSB7XG5cdCAgICAgICAgICAgICAgICAgIHJldHVybiBvYmoubGVmdDtcblx0ICAgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgICBkaW1lbnNpb25zOiBbZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5nZXRQYXJlbnRDb21wb25lbnRHcm91cCgpO1xuXHQgICAgICAgICAgICAgICAgICByZXR1cm4gX3NlbGYuZ2V0TG9naWNhbFNwYWNlKHBhcmVudC5nZXRXaWR0aCgpLCBwYXJlbnQuZ2V0SGVpZ2h0KCkpO1xuXHQgICAgICAgICAgICAgICAgfV1cblx0ICAgICAgICAgICAgICB9XVxuXHQgICAgICAgICAgICB9XVxuXHQgICAgICAgICAgfV1cblx0ICAgICAgICB9XSk7XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnc2V0RHJhd2luZ0NvbmZpZ3VyYXRpb24nLFxuXHQgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RHJhd2luZ0NvbmZpZ3VyYXRpb24oeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcblx0ICAgICAgICB2YXIgbWVzID0gdGhpcy5tZWFzdXJlbWVudDtcblx0ICAgICAgICBtZXMueCA9IHg7XG5cdCAgICAgICAgbWVzLnkgPSB5O1xuXHQgICAgICAgIG1lcy53aWR0aCA9IHdpZHRoO1xuXHQgICAgICAgIG1lcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdFxuXHQgICAgICAgIHRoaXMucGFyZW50R3JvdXAgPSBncm91cDtcblx0XG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnZHJhdycsXG5cdCAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3KHgsIHksIHdpZHRoLCBoZWlnaHQsIGdyb3VwKSB7XG5cdCAgICAgICAgdmFyIG1lYXN1cmVtZW50ID0gdGhpcy5tZWFzdXJlbWVudCxcblx0ICAgICAgICAgICAgdG9vbGJhcnMgPSB0aGlzLnRvb2xiYXJzLFxuXHQgICAgICAgICAgICBsbixcblx0ICAgICAgICAgICAgaSxcblx0ICAgICAgICAgICAgdG9vbGJhcixcblx0ICAgICAgICAgICAgbW9kZWwgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwsXG5cdCAgICAgICAgICAgIHNlbGYgPSB0aGlzO1xuXHQgICAgICAgIGNvbnNvbGUubG9nKG1vZGVsKTtcblx0ICAgICAgICB4ID0geCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQueCA6IHg7XG5cdCAgICAgICAgeSA9IHkgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnkgOiB5O1xuXHQgICAgICAgIHdpZHRoID0gd2lkdGggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LndpZHRoIDogd2lkdGg7XG5cdCAgICAgICAgaGVpZ2h0ID0gaGVpZ2h0ID09PSB1bmRlZmluZWQgPyBtZWFzdXJlbWVudC5oZWlnaHQgOiBoZWlnaHQ7XG5cdCAgICAgICAgZ3JvdXAgPSBncm91cCA9PT0gdW5kZWZpbmVkID8gdGhpcy5wYXJlbnRHcm91cCA6IGdyb3VwO1xuXHQgICAgICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcblx0ICAgICAgICAgIGZvciAoaSA9IDAsIGxuID0gdG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuXHQgICAgICAgICAgICB0b29sYmFyID0gdG9vbGJhcnNbaV07XG5cdCAgICAgICAgICAgIHRvb2xiYXIuZHJhdyh4LCB5LCBncm91cCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBtb2RlbC5vblByb3BzQ2hhbmdlKFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnLCAneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10sIGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG5cdCAgICAgICAgICBzZWxmLmZyb21EYXRlLmJsdXIobmV3IERhdGUoc3RhcnRbMV0pLnRvTG9jYWxlRGF0ZVN0cmluZygpKTtcblx0ICAgICAgICAgIHNlbGYudG9EYXRlLmJsdXIobmV3IERhdGUoZW5kWzFdKS50b0xvY2FsZURhdGVTdHJpbmcoKSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAga2V5OiAnc3RhcnREYXRlJyxcblx0ICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnREdDtcblx0ICAgICAgfSxcblx0ICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoc3RhcnREdCkge1xuXHQgICAgICAgIHZhciBzdGFydFRpbWVzdGFtcCA9ICtuZXcgRGF0ZShzdGFydER0KTtcblx0ICAgICAgICBpZiAoc3RhcnRUaW1lc3RhbXAgPD0gdGhpcy5lbmREdCkge1xuXHQgICAgICAgICAgdGhpcy5zdGFydER0ID0gc3RhcnRUaW1lc3RhbXA7XG5cdCAgICAgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gPSB0aGlzLnN0YXJ0RHQ7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgIGtleTogJ2VuZERhdGUnLFxuXHQgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5lbmREdDtcblx0ICAgICAgfSxcblx0ICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5kRHQpIHtcblx0ICAgICAgICB2YXIgZW5kVGltZXN0YW1wID0gK25ldyBEYXRlKGVuZER0KTtcblx0ICAgICAgICBpZiAoZW5kVGltZXN0YW1wID49IHRoaXMuc3RhcnREdCkge1xuXHQgICAgICAgICAgdGhpcy5lbmREdCA9IGVuZFRpbWVzdGFtcDtcblx0ICAgICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZER0O1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBEYXRlUmFuZ2U7XG5cdCAgfSgpO1xuXHRcblx0ICByZXR1cm4gRGF0ZVJhbmdlO1xuXHR9O1xuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZmN0cy1leHQtZGF0ZXJhbmdlLWVzNS5taW4uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCBhMWIzY2I0OGUyZDYxNWJiNTVjYiIsIid1c2Ugc3RyaWN0JztcbmNvbnN0IERhdGVSYW5nZSA9IHJlcXVpcmUoJy4vZmN0cy1leHQtZGF0ZXJhbmdlJyk7XG5cbndpbmRvdy5kciA9IG5ldyBEYXRlUmFuZ2UoKTtcblxuOyhmdW5jdGlvbiAoZW52LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZW52LmRvY3VtZW50XG4gICAgICAgPyBmYWN0b3J5KGVudikgOiBmdW5jdGlvbiAod2luKSB7XG4gICAgICAgICBpZiAoIXdpbi5kb2N1bWVudCkge1xuICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dpbmRvdyB3aXRoIGRvY3VtZW50IG5vdCBwcmVzZW50Jyk7XG4gICAgICAgICB9XG4gICAgICAgICByZXR1cm4gZmFjdG9yeSh3aW4sIHRydWUpO1xuICAgICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZW52LkRhdGVSYW5nZUNob29zZXIgPSBmYWN0b3J5KGVudiwgdHJ1ZSk7XG4gIH1cbn0pKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24gKF93aW5kb3csIHdpbmRvd0V4aXN0cykge1xuICB2YXIgRkMgPSBfd2luZG93LkZ1c2lvbkNoYXJ0cztcbiAgRkMucmVnaXN0ZXIoJ2V4dGVuc2lvbicsIFsncHJpdmF0ZScsICdEYXRlUmFuZ2VDaG9vc2VyJywgZnVuY3Rpb24gKCkge1xuICAgIEZDLnJlZ2lzdGVyQ29tcG9uZW50KCdleHRlbnNpb25zJywgJ0RhdGVSYW5nZUNob29zZXInLCBEYXRlUmFuZ2Uoe0Z1c2lvbkNoYXJ0czogRkN9KSk7XG4gIH1dKTtcbn0pO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LmpzIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHtcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcblx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcblx0XHRtb2R1bGUucGF0aHMgPSBbXTtcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcblx0XHRtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcblx0fVxuXHRyZXR1cm4gbW9kdWxlO1xufVxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIid1c2Ugc3RyaWN0Jztcbi8qKlxuICogQ2xhc3MgcmVwcmVzZW50aW5nIHRoZSBEYXRlUmFuZ2UuXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZGVwKSB7XG4gIGNsYXNzIERhdGVSYW5nZSB7XG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgLyoqXG4gICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICovXG5cbiAgICAgIHRoaXMuc3RhcnREdCA9IDA7XG4gICAgICB0aGlzLmVuZER0ID0gMDtcbiAgICAgIHRoaXMuc3RhcnREYXRhc2V0ID0gMDtcbiAgICAgIHRoaXMuZW5kRGF0YXNldCA9IDA7XG4gICAgICB0aGlzLnRvb2xib3ggPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuICAgICAgdGhpcy5Ib3Jpem9udGFsVG9vbGJhciA9IHRoaXMudG9vbGJveC5Ib3Jpem9udGFsVG9vbGJhcjtcbiAgICAgIHRoaXMuQ29tcG9uZW50R3JvdXAgPSB0aGlzLnRvb2xib3guQ29tcG9uZW50R3JvdXA7XG4gICAgICB0aGlzLlN5bWJvbFN0b3JlID0gdGhpcy50b29sYm94LlN5bWJvbFN0b3JlO1xuICAgICAgdGhpcy5zdGFydFRleHQgPSB7XG4gICAgICAgIGF0dHI6IGZ1bmN0aW9uICgpIHt9XG4gICAgICB9O1xuICAgICAgdGhpcy5lbmRUZXh0ID0ge1xuICAgICAgICBhdHRyOiBmdW5jdGlvbiAoKSB7fVxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzdGFydCBhbmQgZW5kIGRhdGVzLlxuICAgICAqIEB0eXBlIHtEYXRlUmFuZ2UucmFuZ2V9XG4gICAgICovXG4gICAgZ2V0IHN0YXJ0RGF0ZSAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdGFydER0O1xuICAgIH1cblxuICAgIHNldCBzdGFydERhdGUgKHN0YXJ0RHQpIHtcbiAgICAgIGxldCBzdGFydFRpbWVzdGFtcCA9ICtuZXcgRGF0ZShzdGFydER0KTtcbiAgICAgIGlmIChzdGFydFRpbWVzdGFtcCA8PSB0aGlzLmVuZER0KSB7XG4gICAgICAgIHRoaXMuc3RhcnREdCA9IHN0YXJ0VGltZXN0YW1wO1xuICAgICAgICB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J10gPSB0aGlzLnN0YXJ0RHQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGVuZERhdGUgKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW5kRHQ7XG4gICAgfVxuXG4gICAgc2V0IGVuZERhdGUgKGVuZER0KSB7XG4gICAgICBsZXQgZW5kVGltZXN0YW1wID0gK25ldyBEYXRlKGVuZER0KTtcbiAgICAgIGlmIChlbmRUaW1lc3RhbXAgPj0gdGhpcy5zdGFydER0KSB7XG4gICAgICAgIHRoaXMuZW5kRHQgPSBlbmRUaW1lc3RhbXA7XG4gICAgICAgIHRoaXMuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10gPSB0aGlzLmVuZER0O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN3YXBzIHRoZSBzdGFydCBkYXRlIGFuZCB0aGUgZW5kIGRhdGUgb2YgdGhlIGRhdGUgcmFuZ2VcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN3YXBEYXRlcyAoKSB7XG4gICAgICBsZXQgdGVtcCA9IHRoaXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZTtcbiAgICAgIHRoaXMuZGF0ZVJhbmdlLnN0YXJ0RGF0ZSA9IHRoaXMuZGF0ZVJhbmdlLmVuZERhdGU7XG4gICAgICB0aGlzLmRhdGVSYW5nZS5lbmREYXRlID0gdGVtcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTeW5jcyB0aGUgZGF0ZXJhbmdlIHNob3duIGJ5IHRoZSBGdXNpb25DaGFydHMgdGltZSBzZXJpZXMgY2hhcnQgYW5kIHRoZSBEYXRlIFJhbmdlIENob29zZXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHN5bmNSYW5nZSAoKSB7fVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZyBmcm9tIEZ1c2lvbkNoYXJ0cyB3aGVuIGdpdmVuIGEgVU5JWCB0aW1lc3RhbXBcbiAgICAgKiBAcGFyYW0gIHtudW1iZXJ9IHRpbWVzdGFtcCAtIEEgVU5JWCB0aW1lc3RhbXAgdG8gYmUgY29udmVydGVkIHRvIGEgZGF0ZSBzdHJpbmdcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IC0gQSBkYXRlIHN0cmluZyB3aGljaCBpcyBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiB0aW1lc3RhbXBcbiAgICAgKi9cbiAgICBnZXRGb3JtYXR0ZWREYXRlICh0aW1lc3RhbXApIHtcbiAgICAgIHJldHVybiB0aGlzLmNoYXJ0LmdldEZvcm1hdHRlZERhdGUodGltZXN0YW1wKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgVU5JWCB0aW1lc3RhbXAgZnJvbSBGdXNpb25DaGFydHMgd2hlbiBnaXZlbiBhIGZvcm1hdHRlZCBkYXRlIHN0cmluZ1xuICAgICAqIEBwYXJhbSAge3N0cmluZ30gZGF0ZVN0cmluZyAtIEEgZGF0ZSBzdHJpbmcgdG8gYmUgY29udmVydGVkIHRvIGEgVU5JWCB0aW1lc3RhbXBcbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IEEgVU5JWCB0aW1lc3RhbXAgd2hpY2ggaXMgZXF1aXZhbGVudCB0byB0aGUgZ2l2ZW4gZGF0ZSBzdHJpbmdcbiAgICAgKi9cbiAgICBnZXRUaW1lc3RhbXAgKGRhdGVTdHJpbmcpIHtcbiAgICAgIHJldHVybiB0aGlzLmNoYXJ0LmdldFRpbWVzdGFtcChkYXRlU3RyaW5nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBjb25maWd1cmFibGUgb3B0aW9ucyBvZiB0aGUgZXh0ZW5zaW9uIChlLmcuIGNvc21ldGljcylcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnT2JqIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXh0ZW5zaW9uIG9wdGlvbnNcbiAgICAgKi9cbiAgICBzZXRDb25maWcgKGNvbmZpZ09iaikge31cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGNvbmZpZ3VyYWJsZSBvcHRpb25zIG9mIHRoZSBleHRlbnNpb24gKGUuZy4gY29zbWV0aWNzKVxuICAgICAqIEByZXR1cm4ge29iamVjdH0gY29uZmlnT2JqIFRoZSBjb25maWd1cmF0aW9uIG9iamVjdCBjb250YWluaW5nIHZhcmlvdXMgZXh0ZW5zaW9uIG9wdGlvbnNcbiAgICAgKi9cbiAgICBnZXRDb25maWcgKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY2FsZW5kYXJWaXNpYmxlOiAnZmFsc2UnXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZ1c2lvbmNoYXJ0cyBsaWZlIGN5Y2xlIG1ldGhvZCBmb3IgZXh0ZW5zaW9uXG4gICAgICovXG4gICAgaW5pdCAocmVxdWlyZSkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHJlcXVpcmUoW1xuICAgICAgICAneEF4aXMnLFxuICAgICAgICAneUF4aXMnLFxuICAgICAgICAnZ3JhcGhpY3MnLFxuICAgICAgICAnY2hhcnQnLFxuICAgICAgICAnZGF0YXNldCcsXG4gICAgICAgICdQbG90TWFuYWdlcicsXG4gICAgICAgICdjYW52YXNDb25maWcnLFxuICAgICAgICAnTWFya2VyTWFuYWdlcicsXG4gICAgICAgICdyZWFjdGl2ZU1vZGVsJyxcbiAgICAgICAgJ2dsb2JhbFJlYWN0aXZlTW9kZWwnLFxuICAgICAgICAnc3BhY2VNYW5hZ2VySW5zdGFuY2UnLFxuICAgICAgICAnc21hcnRMYWJlbCcsXG4gICAgICAgICdjaGFydEluc3RhbmNlJyxcbiAgICAgICAgZnVuY3Rpb24gKFxuICAgICAgICAgICAgICB4QXhpcyxcbiAgICAgICAgICAgICAgeUF4aXMsXG4gICAgICAgICAgICAgIGdyYXBoaWNzLFxuICAgICAgICAgICAgICBjaGFydCxcbiAgICAgICAgICAgICAgZGF0YXNldCxcbiAgICAgICAgICAgICAgcGxvdE1hbmFnZXIsXG4gICAgICAgICAgICAgIGNhbnZhc0NvbmZpZyxcbiAgICAgICAgICAgICAgbWFya2VyTWFuYWdlcixcbiAgICAgICAgICAgICAgcmVhY3RpdmVNb2RlbCxcbiAgICAgICAgICAgICAgZ2xvYmFsUmVhY3RpdmVNb2RlbCxcbiAgICAgICAgICAgICAgc3BhY2VNYW5hZ2VySW5zdGFuY2UsXG4gICAgICAgICAgICAgIHNtYXJ0TGFiZWwpIHtcbiAgICAgICAgICBpbnN0YW5jZS54QXhpcyA9IHhBeGlzO1xuICAgICAgICAgIGluc3RhbmNlLnlBeGlzID0geUF4aXM7XG4gICAgICAgICAgaW5zdGFuY2UuZ3JhcGhpY3MgPSBncmFwaGljcztcbiAgICAgICAgICBpbnN0YW5jZS5jaGFydCA9IGNoYXJ0O1xuICAgICAgICAgIGluc3RhbmNlLmRhdGFzZXQgPSBkYXRhc2V0O1xuICAgICAgICAgIGluc3RhbmNlLnBsb3RNYW5hZ2VyID0gcGxvdE1hbmFnZXI7XG4gICAgICAgICAgaW5zdGFuY2UubWFya2VyTWFuYWdlciA9IG1hcmtlck1hbmFnZXI7XG4gICAgICAgICAgaW5zdGFuY2UuY2FudmFzQ29uZmlnID0gY2FudmFzQ29uZmlnO1xuICAgICAgICAgIGluc3RhbmNlLnJlYWN0aXZlTW9kZWwgPSByZWFjdGl2ZU1vZGVsO1xuICAgICAgICAgIGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwgPSBnbG9iYWxSZWFjdGl2ZU1vZGVsO1xuICAgICAgICAgIGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlID0gc3BhY2VNYW5hZ2VySW5zdGFuY2U7XG4gICAgICAgICAgaW5zdGFuY2Uuc21hcnRMYWJlbCA9IHNtYXJ0TGFiZWw7XG4gICAgICAgIH1cbiAgICAgIF0pO1xuICAgICAgdGhpcy5zcGFjZU1hbmFnZXJJbnN0YW5jZSA9IGluc3RhbmNlLnNwYWNlTWFuYWdlckluc3RhbmNlO1xuICAgICAgdGhpcy5nbG9iYWxSZWFjdGl2ZU1vZGVsID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbDtcbiAgICAgIHRoaXMuc3RhcnREdCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy12aXNpYmxlLXJhbmdlLXN0YXJ0J107XG4gICAgICB0aGlzLmVuZER0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ107XG4gICAgICB0aGlzLnN0YXJ0RGF0YXNldCA9IGluc3RhbmNlLmdsb2JhbFJlYWN0aXZlTW9kZWwubW9kZWxbJ3gtYXhpcy1hYnNvbHV0ZS1yYW5nZS1zdGFydCddO1xuICAgICAgdGhpcy5lbmREYXRhc2V0ID0gaW5zdGFuY2UuZ2xvYmFsUmVhY3RpdmVNb2RlbC5tb2RlbFsneC1heGlzLWFic29sdXRlLXJhbmdlLWVuZCddO1xuICAgICAgdGhpcy50b29sYmFycyA9IFtdO1xuICAgICAgdGhpcy5tZWFzdXJlbWVudCA9IHt9O1xuICAgICAgdGhpcy50b29sYmFycy5wdXNoKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuY3JlYXRlVG9vbGJhcigpKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuZGF0ZVN0YXJ0LCB0aGlzLmRhdGVFbmQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIGNyZWF0ZVRvb2xiYXIgKCkge1xuICAgICAgdmFyIHRvb2xiYXIsXG4gICAgICAgIHNlbGYgPSB0aGlzLFxuICAgICAgICBmcm9tRGF0ZUxhYmVsLFxuICAgICAgICB0b0RhdGVMYWJlbCxcbiAgICAgICAgZ3JvdXAsXG4gICAgICAgIGZyb21Gb3JtYXR0ZWREYXRlLFxuICAgICAgICB0b0Zvcm1hdHRlZERhdGU7XG5cbiAgICAgIHNlbGYuZnJvbURhdGUgPSB7fTtcbiAgICAgIHNlbGYudG9EYXRlID0ge307XG5cbiAgICAgIGZyb21Gb3JtYXR0ZWREYXRlID0gbmV3IERhdGUodGhpcy5zdGFydER0KS50b0xvY2FsZURhdGVTdHJpbmcoKTtcblxuICAgICAgdG9Gb3JtYXR0ZWREYXRlID0gbmV3IERhdGUodGhpcy5lbmREdCkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG5cbiAgICAgIHRvb2xiYXIgPSBuZXcgdGhpcy5Ib3Jpem9udGFsVG9vbGJhcih7XG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyLFxuICAgICAgICBjaGFydDogdGhpcy5jaGFydCxcbiAgICAgICAgc21hcnRMYWJlbDogdGhpcy5zbWFydExhYmVsLFxuICAgICAgICBjaGFydENvbnRhaW5lcjogdGhpcy5ncmFwaGljcy5jb250YWluZXJcbiAgICAgIH0pO1xuXG4gICAgICB0b29sYmFyLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcblxuICAgICAgZ3JvdXAgPSBuZXcgdGhpcy50b29sYm94LkNvbXBvbmVudEdyb3VwKHtcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgfSk7XG5cbiAgICAgIGdyb3VwLnNldENvbmZpZyh7XG4gICAgICAgIGZpbGw6ICcjZmZmJyxcbiAgICAgICAgYm9yZGVyVGhpY2tuZXNzOiAwXG4gICAgICB9KTtcblxuICAgICAgZnJvbURhdGVMYWJlbCA9IG5ldyB0aGlzLnRvb2xib3guTGFiZWwoJ0Zyb206Jywge1xuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyXG4gICAgICB9LCB7XG4gICAgICAgIHRleHQ6IHtcbiAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgJ2ZvbnQtc2l6ZSc6ICcxNScsXG4gICAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgc2VsZi5mcm9tRGF0ZSA9IG5ldyB0aGlzLnRvb2xib3guSW5wdXRUZXh0Qm94U3ltYm9sKHtcbiAgICAgICAgd2lkdGg6IDEyMCxcbiAgICAgICAgaGVpZ2h0OiAyNVxuICAgICAgfSwge1xuICAgICAgICBwYXBlcjogdGhpcy5ncmFwaGljcy5wYXBlcixcbiAgICAgICAgY2hhcnQ6IHRoaXMuY2hhcnQsXG4gICAgICAgIHNtYXJ0TGFiZWw6IHRoaXMuc21hcnRMYWJlbCxcbiAgICAgICAgY2hhcnRDb250YWluZXI6IHRoaXMuZ3JhcGhpY3MuY29udGFpbmVyXG4gICAgICB9LCB7XG4gICAgICAgIHN0cm9rZVdpZHRoOiAxLFxuICAgICAgICBzdHJva2U6ICdyZ2JhKDEwMiwxMDIsMTAyLDAuNSknLFxuICAgICAgICBzeW1ib2xTdHJva2VXaWR0aDogMCxcbiAgICAgICAgYnRuVGV4dFN0eWxlOiB7XG4gICAgICAgICAgZm9udFNpemU6IDE0XG4gICAgICAgIH0sXG4gICAgICAgIGxhYmVsOiBmcm9tRm9ybWF0dGVkRGF0ZVxuICAgICAgfSk7XG5cbiAgICAgIHRvRGF0ZUxhYmVsID0gbmV3IHRoaXMudG9vbGJveC5MYWJlbCgnVG86Jywge1xuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIHBhcGVyOiB0aGlzLmdyYXBoaWNzLnBhcGVyXG4gICAgICB9LCB7XG4gICAgICAgIHRleHQ6IHtcbiAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgJ2ZvbnQtc2l6ZSc6ICcxNScsXG4gICAgICAgICAgICAnZm9udEZhbWlseSc6ICdNeXJpYWRQcm8nXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgc2VsZi50b0RhdGUgPSBuZXcgdGhpcy50b29sYm94LklucHV0VGV4dEJveFN5bWJvbCh7XG4gICAgICAgIHdpZHRoOiAxMjAsXG4gICAgICAgIGhlaWdodDogMjVcbiAgICAgIH0sIHtcbiAgICAgICAgcGFwZXI6IHRoaXMuZ3JhcGhpY3MucGFwZXIsXG4gICAgICAgIGNoYXJ0OiB0aGlzLmNoYXJ0LFxuICAgICAgICBzbWFydExhYmVsOiB0aGlzLnNtYXJ0TGFiZWwsXG4gICAgICAgIGNoYXJ0Q29udGFpbmVyOiB0aGlzLmdyYXBoaWNzLmNvbnRhaW5lclxuICAgICAgfSwge1xuICAgICAgICBzdHJva2VXaWR0aDogMSxcbiAgICAgICAgc3Ryb2tlOiAncmdiYSgxMDIsMTAyLDEwMiwwLjUpJyxcbiAgICAgICAgc3ltYm9sU3Ryb2tlV2lkdGg6IDAsXG4gICAgICAgIGJ0blRleHRTdHlsZToge1xuICAgICAgICAgIGZvbnRTaXplOiAxNFxuICAgICAgICB9LFxuICAgICAgICBsYWJlbDogdG9Gb3JtYXR0ZWREYXRlXG4gICAgICB9KTtcblxuICAgICAgc2VsZi5mcm9tRGF0ZS5hdHRhY2hFdmVudEhhbmRsZXJzKHtcbiAgICAgICAgY2xpY2s6IHtcbiAgICAgICAgICBmbjogc2VsZi5mcm9tRGF0ZS5lZGl0XG4gICAgICAgIH0sXG4gICAgICAgIHRleHRPbkJsdXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzZWxmLmZyb21EYXRlLmJsdXIoKTtcbiAgICAgICAgICBzZWxmLnN0YXJ0RGF0ZSA9IHNlbGYuZnJvbURhdGUuZ2V0VGV4dCgpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuZnJvbURhdGUuZ2V0VGV4dCgpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHNlbGYudG9EYXRlLmF0dGFjaEV2ZW50SGFuZGxlcnMoe1xuICAgICAgICBjbGljazoge1xuICAgICAgICAgIGZuOiBzZWxmLnRvRGF0ZS5lZGl0XG4gICAgICAgIH0sXG4gICAgICAgIHRleHRPbkJsdXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzZWxmLnRvRGF0ZS5ibHVyKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coc2VsZi50b0RhdGUuZ2V0VGV4dCgpKTtcbiAgICAgICAgICBzZWxmLmVuZERhdGUgPSBzZWxmLnRvRGF0ZS5nZXRUZXh0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLlN5bWJvbFN0b3JlLnJlZ2lzdGVyKCd0ZXh0Qm94SWNvbicsIGZ1bmN0aW9uICh4LCB5LCByYWQsIHcsIGgsIHBhZFgsIHBhZFkpIHtcbiAgICAgICAgdmFyIHgxID0geCAtIHcgLyAyICsgcGFkWCAvIDIsXG4gICAgICAgICAgeDIgPSB4ICsgdyAvIDIgLSBwYWRYIC8gMixcbiAgICAgICAgICB5MSA9IHkgLSBoIC8gMiArIHBhZFkgLyAyLFxuICAgICAgICAgIHkyID0geSArIGggLyAyIC0gcGFkWSAvIDI7XG5cbiAgICAgICAgcmV0dXJuIFsnTScsIHgxLCB5MSwgJ0wnLCB4MiwgeTEsICdMJywgeDIsIHkyLCAnTCcsIHgxLCB5MiwgJ1onXTtcbiAgICAgIH0pO1xuXG4gICAgICBncm91cC5hZGRTeW1ib2woZnJvbURhdGVMYWJlbCk7XG4gICAgICBncm91cC5hZGRTeW1ib2woc2VsZi5mcm9tRGF0ZSk7XG4gICAgICBncm91cC5hZGRTeW1ib2wodG9EYXRlTGFiZWwpO1xuICAgICAgZ3JvdXAuYWRkU3ltYm9sKHNlbGYudG9EYXRlKTtcbiAgICAgIHRvb2xiYXIuYWRkQ29tcG9uZW50KGdyb3VwKTtcbiAgICAgIHJldHVybiB0b29sYmFyO1xuICAgIH07XG5cbiAgICBnZXRMb2dpY2FsU3BhY2UgKGF2YWlsYWJsZVdpZHRoLCBhdmFpbGFibGVIZWlnaHQpIHtcbiAgICAgIGF2YWlsYWJsZVdpZHRoIC89IDI7XG4gICAgICB2YXIgbG9naWNhbFNwYWNlLFxuICAgICAgICB3aWR0aCA9IDAsXG4gICAgICAgIGhlaWdodCA9IDAsXG4gICAgICAgIGksXG4gICAgICAgIGxuO1xuXG4gICAgICBmb3IgKGkgPSAwLCBsbiA9IHRoaXMudG9vbGJhcnMubGVuZ3RoOyBpIDwgbG47IGkrKykge1xuICAgICAgICBsb2dpY2FsU3BhY2UgPSB0aGlzLnRvb2xiYXJzW2ldLmdldExvZ2ljYWxTcGFjZShhdmFpbGFibGVXaWR0aCwgYXZhaWxhYmxlSGVpZ2h0KTtcbiAgICAgICAgd2lkdGggPSBNYXRoLm1heChsb2dpY2FsU3BhY2Uud2lkdGgsIHdpZHRoKTtcbiAgICAgICAgaGVpZ2h0ICs9IGxvZ2ljYWxTcGFjZS5oZWlnaHQ7XG4gICAgICAgIHRoaXMudG9vbGJhcnNbaV0ud2lkdGggPSBsb2dpY2FsU3BhY2Uud2lkdGg7XG4gICAgICAgIHRoaXMudG9vbGJhcnNbaV0uaGVpZ2h0ID0gbG9naWNhbFNwYWNlLmhlaWdodDtcbiAgICAgIH1cbiAgICAgIGhlaWdodCArPSB0aGlzLnBhZGRpbmc7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgIGhlaWdodDogaGVpZ2h0XG4gICAgICB9O1xuICAgIH07XG5cbiAgICBwbGFjZUluQ2FudmFzICgpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHNlbGYucGFkZGluZyA9IDU7XG4gICAgICBzZWxmLnNwYWNlTWFuYWdlckluc3RhbmNlLmFkZChbe1xuICAgICAgICBuYW1lOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuICdUb29sQm94RXh0JztcbiAgICAgICAgfSxcbiAgICAgICAgcmVmOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgcmV0dXJuIG9ialsnMCddO1xuICAgICAgICB9LFxuICAgICAgICBzZWxmOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHNlbGY7XG4gICAgICAgIH0sXG4gICAgICAgIHByaW9yaXR5OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgIH0sXG4gICAgICAgIGxheW91dDogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgIHJldHVybiBvYmouaW5saW5lO1xuICAgICAgICB9LFxuICAgICAgICBvcmllbnRhdGlvbjogW3tcbiAgICAgICAgICB0eXBlOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqLmhvcml6b250YWw7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBwb3NpdGlvbjogW3tcbiAgICAgICAgICAgIHR5cGU6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG9iai50b3A7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYWxpZ25tZW50OiBbe1xuICAgICAgICAgICAgICB0eXBlOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iai5sZWZ0O1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBkaW1lbnNpb25zOiBbZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLmdldFBhcmVudENvbXBvbmVudEdyb3VwKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0TG9naWNhbFNwYWNlKHBhcmVudC5nZXRXaWR0aCgpLCBwYXJlbnQuZ2V0SGVpZ2h0KCkpO1xuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfV1cbiAgICAgICAgICB9XVxuICAgICAgICB9XVxuICAgICAgfV0pO1xuICAgIH07XG5cbiAgICBzZXREcmF3aW5nQ29uZmlndXJhdGlvbiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ3JvdXApIHtcbiAgICAgIHZhciBtZXMgPSB0aGlzLm1lYXN1cmVtZW50O1xuICAgICAgbWVzLnggPSB4O1xuICAgICAgbWVzLnkgPSB5O1xuICAgICAgbWVzLndpZHRoID0gd2lkdGg7XG4gICAgICBtZXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgICB0aGlzLnBhcmVudEdyb3VwID0gZ3JvdXA7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICBkcmF3ICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBncm91cCkge1xuICAgICAgdmFyIG1lYXN1cmVtZW50ID0gdGhpcy5tZWFzdXJlbWVudCxcbiAgICAgICAgdG9vbGJhcnMgPSB0aGlzLnRvb2xiYXJzLFxuICAgICAgICBsbixcbiAgICAgICAgaSxcbiAgICAgICAgdG9vbGJhcixcbiAgICAgICAgbW9kZWwgPSB0aGlzLmdsb2JhbFJlYWN0aXZlTW9kZWwsXG4gICAgICAgIHNlbGYgPSB0aGlzO1xuICAgICAgY29uc29sZS5sb2cobW9kZWwpO1xuICAgICAgeCA9IHggPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnggOiB4O1xuICAgICAgeSA9IHkgPT09IHVuZGVmaW5lZCA/IG1lYXN1cmVtZW50LnkgOiB5O1xuICAgICAgd2lkdGggPSB3aWR0aCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQud2lkdGggOiB3aWR0aDtcbiAgICAgIGhlaWdodCA9IGhlaWdodCA9PT0gdW5kZWZpbmVkID8gbWVhc3VyZW1lbnQuaGVpZ2h0IDogaGVpZ2h0O1xuICAgICAgZ3JvdXAgPSBncm91cCA9PT0gdW5kZWZpbmVkID8gdGhpcy5wYXJlbnRHcm91cCA6IGdyb3VwO1xuICAgICAgaWYgKHdpZHRoICYmIGhlaWdodCkge1xuICAgICAgICBmb3IgKGkgPSAwLCBsbiA9IHRvb2xiYXJzLmxlbmd0aDsgaSA8IGxuOyBpKyspIHtcbiAgICAgICAgICB0b29sYmFyID0gdG9vbGJhcnNbaV07XG4gICAgICAgICAgdG9vbGJhci5kcmF3KHgsIHksIGdyb3VwKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBtb2RlbC5vblByb3BzQ2hhbmdlKFsneC1heGlzLXZpc2libGUtcmFuZ2Utc3RhcnQnLCAneC1heGlzLXZpc2libGUtcmFuZ2UtZW5kJ10sIGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgICAgIHNlbGYuZnJvbURhdGUuYmx1cihuZXcgRGF0ZShzdGFydFsxXSkudG9Mb2NhbGVEYXRlU3RyaW5nKCkpO1xuICAgICAgICBzZWxmLnRvRGF0ZS5ibHVyKG5ldyBEYXRlKGVuZFsxXSkudG9Mb2NhbGVEYXRlU3RyaW5nKCkpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gRGF0ZVJhbmdlO1xufTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9mY3RzLWV4dC1kYXRlcmFuZ2UuanMiXSwic291cmNlUm9vdCI6IiJ9